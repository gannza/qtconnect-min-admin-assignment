import{k as Xn,r as de,j as H,l as Nt,m as oo,u as ru,n as au,P as Yn,o as iu,p as F0,q as ea,s as Zn,t as nu,D as su,v as fu,X as ou,B as n0,w as cu,x as Tr,y as uu,z as du,c as be,g as co,A as lu,E as hu,L as vu,C as Ps,d as Us,e as Os,i as Vs,h as Ks}from"./index-DsfvxrGO.js";import{f as Di,h as pu,R as xu,g as gu,F as yu,u as Ka,S as Aa,b as Sa,c as Ba,d as _a,e as Ur,a as bu}from"./select-BXknrqC8.js";import{decodeProtobufToUsers as mu}from"./protobuf-mEBa1vr0.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cu=Xn("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eu=Xn("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Au=Xn("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),uo=de.forwardRef(({className:e,...t},a)=>H.jsx("div",{className:"relative w-full overflow-auto",children:H.jsx("table",{ref:a,className:Nt("w-full caption-bottom text-sm",e),...t})}));uo.displayName="Table";const lo=de.forwardRef(({className:e,...t},a)=>H.jsx("thead",{ref:a,className:Nt("[&_tr]:border-b",e),...t}));lo.displayName="TableHeader";const ho=de.forwardRef(({className:e,...t},a)=>H.jsx("tbody",{ref:a,className:Nt("[&_tr:last-child]:border-0",e),...t}));ho.displayName="TableBody";const Su=de.forwardRef(({className:e,...t},a)=>H.jsx("tfoot",{ref:a,className:Nt("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));Su.displayName="TableFooter";const ba=de.forwardRef(({className:e,...t},a)=>H.jsx("tr",{ref:a,className:Nt("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));ba.displayName="TableRow";const m0=de.forwardRef(({className:e,...t},a)=>H.jsx("th",{ref:a,className:Nt("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));m0.displayName="TableHead";const e0=de.forwardRef(({className:e,...t},a)=>H.jsx("td",{ref:a,className:Nt("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));e0.displayName="TableCell";const Bu=de.forwardRef(({className:e,...t},a)=>H.jsx("caption",{ref:a,className:Nt("mt-4 text-sm text-muted-foreground",e),...t}));Bu.displayName="TableCaption";const _u=oo("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function y0({className:e,variant:t,...a}){return H.jsx("div",{className:Nt(_u({variant:t}),e),...a})}var qa="Dialog",[vo]=au(qa),[Iu,sr]=vo(qa),po=e=>{const{__scopeDialog:t,children:a,open:r,defaultOpen:i,onOpenChange:n,modal:s=!0}=e,f=de.useRef(null),u=de.useRef(null),[o,c]=ru({prop:r,defaultProp:i??!1,onChange:n,caller:qa});return H.jsx(Iu,{scope:t,triggerRef:f,contentRef:u,contentId:Di(),titleId:Di(),descriptionId:Di(),open:o,onOpenChange:c,onOpenToggle:de.useCallback(()=>c(l=>!l),[c]),modal:s,children:a})};po.displayName=qa;var xo="DialogTrigger",Tu=de.forwardRef((e,t)=>{const{__scopeDialog:a,...r}=e,i=sr(xo,a),n=Zn(t,i.triggerRef);return H.jsx(F0.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":ts(i.open),...r,ref:n,onClick:ea(e.onClick,i.onOpenToggle)})});Tu.displayName=xo;var Jn="DialogPortal",[wu,go]=vo(Jn,{forceMount:void 0}),yo=e=>{const{__scopeDialog:t,forceMount:a,children:r,container:i}=e,n=sr(Jn,t);return H.jsx(wu,{scope:t,forceMount:a,children:de.Children.map(r,s=>H.jsx(Yn,{present:a||n.open,children:H.jsx(iu,{asChild:!0,container:i,children:s})}))})};yo.displayName=Jn;var Ia="DialogOverlay",bo=de.forwardRef((e,t)=>{const a=go(Ia,e.__scopeDialog),{forceMount:r=a.forceMount,...i}=e,n=sr(Ia,e.__scopeDialog);return n.modal?H.jsx(Yn,{present:r||n.open,children:H.jsx(Nu,{...i,ref:t})}):null});bo.displayName=Ia;var Du=nu("DialogOverlay.RemoveScroll"),Nu=de.forwardRef((e,t)=>{const{__scopeDialog:a,...r}=e,i=sr(Ia,a);return H.jsx(xu,{as:Du,allowPinchZoom:!0,shards:[i.contentRef],children:H.jsx(F0.div,{"data-state":ts(i.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),u0="DialogContent",mo=de.forwardRef((e,t)=>{const a=go(u0,e.__scopeDialog),{forceMount:r=a.forceMount,...i}=e,n=sr(u0,e.__scopeDialog);return H.jsx(Yn,{present:r||n.open,children:n.modal?H.jsx(Ru,{...i,ref:t}):H.jsx(Fu,{...i,ref:t})})});mo.displayName=u0;var Ru=de.forwardRef((e,t)=>{const a=sr(u0,e.__scopeDialog),r=de.useRef(null),i=Zn(t,a.contentRef,r);return de.useEffect(()=>{const n=r.current;if(n)return pu(n)},[]),H.jsx(Co,{...e,ref:i,trapFocus:a.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ea(e.onCloseAutoFocus,n=>{var s;n.preventDefault(),(s=a.triggerRef.current)==null||s.focus()}),onPointerDownOutside:ea(e.onPointerDownOutside,n=>{const s=n.detail.originalEvent,f=s.button===0&&s.ctrlKey===!0;(s.button===2||f)&&n.preventDefault()}),onFocusOutside:ea(e.onFocusOutside,n=>n.preventDefault())})}),Fu=de.forwardRef((e,t)=>{const a=sr(u0,e.__scopeDialog),r=de.useRef(!1),i=de.useRef(!1);return H.jsx(Co,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:n=>{var s,f;(s=e.onCloseAutoFocus)==null||s.call(e,n),n.defaultPrevented||(r.current||(f=a.triggerRef.current)==null||f.focus(),n.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:n=>{var u,o;(u=e.onInteractOutside)==null||u.call(e,n),n.defaultPrevented||(r.current=!0,n.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const s=n.target;((o=a.triggerRef.current)==null?void 0:o.contains(s))&&n.preventDefault(),n.detail.originalEvent.type==="focusin"&&i.current&&n.preventDefault()}})}),Co=de.forwardRef((e,t)=>{const{__scopeDialog:a,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:n,...s}=e,f=sr(u0,a),u=de.useRef(null),o=Zn(t,u);return gu(),H.jsxs(H.Fragment,{children:[H.jsx(yu,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:n,children:H.jsx(su,{role:"dialog",id:f.contentId,"aria-describedby":f.descriptionId,"aria-labelledby":f.titleId,"data-state":ts(f.open),...s,ref:o,onDismiss:()=>f.onOpenChange(!1)})}),H.jsxs(H.Fragment,{children:[H.jsx(ku,{titleId:f.titleId}),H.jsx(Lu,{contentRef:u,descriptionId:f.descriptionId})]})]})}),es="DialogTitle",Eo=de.forwardRef((e,t)=>{const{__scopeDialog:a,...r}=e,i=sr(es,a);return H.jsx(F0.h2,{id:i.titleId,...r,ref:t})});Eo.displayName=es;var Ao="DialogDescription",So=de.forwardRef((e,t)=>{const{__scopeDialog:a,...r}=e,i=sr(Ao,a);return H.jsx(F0.p,{id:i.descriptionId,...r,ref:t})});So.displayName=Ao;var Bo="DialogClose",_o=de.forwardRef((e,t)=>{const{__scopeDialog:a,...r}=e,i=sr(Bo,a);return H.jsx(F0.button,{type:"button",...r,ref:t,onClick:ea(e.onClick,()=>i.onOpenChange(!1))})});_o.displayName=Bo;function ts(e){return e?"open":"closed"}var Io="DialogTitleWarning",[m2,To]=fu(Io,{contentName:u0,titleName:es,docsSlug:"dialog"}),ku=({titleId:e})=>{const t=To(Io),a=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return de.useEffect(()=>{e&&(document.getElementById(e)||console.error(a))},[a,e]),null},Mu="DialogDescriptionWarning",Lu=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${To(Mu).contentName}}.`;return de.useEffect(()=>{var n;const i=(n=e.current)==null?void 0:n.getAttribute("aria-describedby");t&&i&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},Pu=po,Uu=yo,wo=bo,Do=mo,No=Eo,Ro=So,Ou=_o;const Fo=Pu,Vu=Uu,ko=de.forwardRef(({className:e,...t},a)=>H.jsx(wo,{ref:a,className:Nt("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));ko.displayName=wo.displayName;const rs=de.forwardRef(({className:e,children:t,...a},r)=>H.jsxs(Vu,{children:[H.jsx(ko,{}),H.jsxs(Do,{ref:r,className:Nt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...a,children:[t,H.jsxs(Ou,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[H.jsx(ou,{className:"h-4 w-4"}),H.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));rs.displayName=Do.displayName;const as=({className:e,...t})=>H.jsx("div",{className:Nt("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});as.displayName="DialogHeader";const is=({className:e,...t})=>H.jsx("div",{className:Nt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});is.displayName="DialogFooter";const ns=de.forwardRef(({className:e,...t},a)=>H.jsx(No,{ref:a,className:Nt("text-lg font-semibold leading-none tracking-tight",e),...t}));ns.displayName=No.displayName;const ss=de.forwardRef(({className:e,...t},a)=>H.jsx(Ro,{ref:a,className:Nt("text-sm text-muted-foreground",e),...t}));ss.displayName=Ro.displayName;const Ku=({users:e,onUserUpdated:t,setEditingUser:a})=>{const r=Ka(),[i,n]=de.useState(!1),[s,f]=de.useState(null),[u,o]=de.useState(e),c=async y=>{f(y),n(!0)};de.useEffect(()=>{o(e)},[e]);const l=async()=>{s&&(await r(cu(s.id)),n(!1),f(null),t&&t(),Tr({title:"User deleted successfully",description:"User deleted successfully",variant:"success"}))},h=y=>y==="active"?H.jsx(y0,{variant:"default",className:"bg-green-100 text-green-800",children:"Active"}):H.jsx(y0,{variant:"secondary",className:"bg-gray-100 text-gray-800",children:"Inactive"}),g=y=>y==="admin"?H.jsx(y0,{variant:"destructive",children:"Admin"}):H.jsx(y0,{variant:"outline",children:"User"}),v=y=>y?H.jsx(y0,{className:"bg-green-100 text-green-800",children:"Verified"}):H.jsx(y0,{variant:"destructive",children:"Invalid"});return H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"rounded-md border",children:H.jsxs(uo,{children:[H.jsx(lo,{children:H.jsxs(ba,{children:[H.jsx(m0,{children:"Email"}),H.jsx(m0,{children:"Role"}),H.jsx(m0,{children:"Status"}),H.jsx(m0,{children:"Created"}),H.jsx(m0,{className:"text-right",children:"Actions"})]})}),H.jsx(ho,{children:u.length===0?H.jsx(ba,{children:H.jsx(e0,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No users found"})}):u.map(y=>H.jsxs(ba,{children:[H.jsxs(e0,{className:"font-medium pr-1",children:[H.jsx("span",{className:"mr-2",children:y.email})," ",v(y.isValid||!1)]}),H.jsx(e0,{children:g(y.role)}),H.jsx(e0,{children:h(y.status)}),H.jsx(e0,{children:new Date(y.createdAt).toLocaleDateString()}),H.jsx(e0,{className:"text-right",children:H.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[H.jsx(n0,{variant:"ghost",size:"sm",onClick:()=>a&&a(y),children:H.jsx(Cu,{className:"h-4 w-4"})}),H.jsx(n0,{variant:"ghost",size:"sm",onClick:()=>c(y),className:"text-destructive hover:text-destructive",children:H.jsx(Au,{className:"h-4 w-4"})})]})})]},y.id))})]})}),H.jsx(Fo,{open:i,onOpenChange:n,children:H.jsxs(rs,{children:[H.jsxs(as,{children:[H.jsx(ns,{children:"Delete User"}),H.jsxs(ss,{children:['Are you sure you want to delete user "',s==null?void 0:s.email,'"? This action cannot be undone.']})]}),H.jsxs(is,{children:[H.jsx(n0,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),H.jsx(n0,{variant:"destructive",onClick:l,children:"Delete"})]})]})})]})},fs=de.forwardRef(({className:e,type:t,...a},r)=>H.jsx("input",{type:t,className:Nt("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...a}));fs.displayName="Input";var qu="Label",Mo=de.forwardRef((e,t)=>H.jsx(F0.label,{...e,ref:t,onMouseDown:a=>{var i;a.target.closest("button, input, select, textarea")||((i=e.onMouseDown)==null||i.call(e,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));Mo.displayName=qu;var Lo=Mo;const Hu=oo("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),f0=de.forwardRef(({className:e,...t},a)=>H.jsx(Lo,{ref:a,className:Nt(Hu(),e),...t}));f0.displayName=Lo.displayName;const zu=({onRefreshChange:e})=>{const t=Ka(),[a,r]=de.useState({email:"",role:"user",status:"active"}),[i,n]=de.useState(!1),[s,f]=de.useState({}),u=async c=>{c.preventDefault(),n(!0),f({});try{const l=await t(uu(a));l.type.endsWith("/fulfilled")&&l.payload?(r({email:"",role:"user",status:"active"}),Tr({title:"User created successfully",description:"User created successfully",variant:"success"}),e(!0)):l.type.endsWith("/rejected")&&(f({email:"Email already exists"}),Tr({title:"Create user failed",description:"Email already exists",variant:"destructive"}))}catch{Tr({title:"Creation failed",description:"An unexpected error occurred",variant:"destructive"})}finally{n(!1)}},o=(c,l)=>{r(h=>({...h,[c]:l})),s[c]&&f(h=>({...h,[c]:""}))};return H.jsxs("form",{onSubmit:u,className:"space-y-4",children:[s.general&&H.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:H.jsx("p",{className:"text-sm text-red-600",children:s.general})}),H.jsxs("div",{className:"space-y-2",children:[H.jsx(f0,{htmlFor:"email",children:"Email"}),H.jsx(fs,{id:"email",type:"email",value:a.email,onChange:c=>o("email",c.target.value),placeholder:"user@example.com",required:!0,className:s.email?"border-red-500":""}),s.email&&H.jsx("p",{className:"text-sm text-red-500",children:s.email})]}),H.jsxs("div",{className:"space-y-2",children:[H.jsx(f0,{htmlFor:"role",children:"Role"}),H.jsxs(Aa,{value:a.role,onValueChange:c=>o("role",c),children:[H.jsx(Sa,{children:H.jsx(Ba,{placeholder:"Select role"})}),H.jsxs(_a,{children:[H.jsx(Ur,{value:"user",children:"User"}),H.jsx(Ur,{value:"admin",children:"Admin"})]})]})]}),H.jsxs("div",{className:"space-y-2",children:[H.jsx(f0,{htmlFor:"status",children:"Status"}),H.jsxs(Aa,{value:a.status,onValueChange:c=>o("status",c),children:[H.jsx(Sa,{children:H.jsx(Ba,{placeholder:"Select status"})}),H.jsxs(_a,{children:[H.jsx(Ur,{value:"active",children:"Active"}),H.jsx(Ur,{value:"inactive",children:"Inactive"})]})]})]}),H.jsx(n0,{type:"submit",className:"w-full",disabled:i,children:i?"Creating...":"Create User"})]})};var Gu={};const ju="6.6.1",$u={version:ju};var zt={},os={exports:{}};const Wu={},Qu=Object.freeze(Object.defineProperty({__proto__:null,default:Wu},Symbol.toStringTag,{value:"Module"})),k0=du(Qu);os.exports;(function(e){(function(t,a){function r(C,d){if(!C)throw new Error(d||"Assertion failed")}function i(C,d){C.super_=d;var x=function(){};x.prototype=d.prototype,C.prototype=new x,C.prototype.constructor=C}function n(C,d,x){if(n.isBN(C))return C;this.negative=0,this.words=null,this.length=0,this.red=null,C!==null&&((d==="le"||d==="be")&&(x=d,d=10),this._init(C||0,d||10,x||"be"))}typeof t=="object"?t.exports=n:a.BN=n,n.BN=n,n.wordSize=26;var s;try{typeof window<"u"&&typeof window.Buffer<"u"?s=window.Buffer:s=k0.Buffer}catch{}n.isBN=function(d){return d instanceof n?!0:d!==null&&typeof d=="object"&&d.constructor.wordSize===n.wordSize&&Array.isArray(d.words)},n.max=function(d,x){return d.cmp(x)>0?d:x},n.min=function(d,x){return d.cmp(x)<0?d:x},n.prototype._init=function(d,x,m){if(typeof d=="number")return this._initNumber(d,x,m);if(typeof d=="object")return this._initArray(d,x,m);x==="hex"&&(x=16),r(x===(x|0)&&x>=2&&x<=36),d=d.toString().replace(/\s+/g,"");var S=0;d[0]==="-"&&(S++,this.negative=1),S<d.length&&(x===16?this._parseHex(d,S,m):(this._parseBase(d,x,S),m==="le"&&this._initArray(this.toArray(),x,m)))},n.prototype._initNumber=function(d,x,m){d<0&&(this.negative=1,d=-d),d<67108864?(this.words=[d&67108863],this.length=1):d<4503599627370496?(this.words=[d&67108863,d/67108864&67108863],this.length=2):(r(d<9007199254740992),this.words=[d&67108863,d/67108864&67108863,1],this.length=3),m==="le"&&this._initArray(this.toArray(),x,m)},n.prototype._initArray=function(d,x,m){if(r(typeof d.length=="number"),d.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(d.length/3),this.words=new Array(this.length);for(var S=0;S<this.length;S++)this.words[S]=0;var D,F,P=0;if(m==="be")for(S=d.length-1,D=0;S>=0;S-=3)F=d[S]|d[S-1]<<8|d[S-2]<<16,this.words[D]|=F<<P&67108863,this.words[D+1]=F>>>26-P&67108863,P+=24,P>=26&&(P-=26,D++);else if(m==="le")for(S=0,D=0;S<d.length;S+=3)F=d[S]|d[S+1]<<8|d[S+2]<<16,this.words[D]|=F<<P&67108863,this.words[D+1]=F>>>26-P&67108863,P+=24,P>=26&&(P-=26,D++);return this.strip()};function f(C,d){var x=C.charCodeAt(d);return x>=65&&x<=70?x-55:x>=97&&x<=102?x-87:x-48&15}function u(C,d,x){var m=f(C,x);return x-1>=d&&(m|=f(C,x-1)<<4),m}n.prototype._parseHex=function(d,x,m){this.length=Math.ceil((d.length-x)/6),this.words=new Array(this.length);for(var S=0;S<this.length;S++)this.words[S]=0;var D=0,F=0,P;if(m==="be")for(S=d.length-1;S>=x;S-=2)P=u(d,x,S)<<D,this.words[F]|=P&67108863,D>=18?(D-=18,F+=1,this.words[F]|=P>>>26):D+=8;else{var R=d.length-x;for(S=R%2===0?x+1:x;S<d.length;S+=2)P=u(d,x,S)<<D,this.words[F]|=P&67108863,D>=18?(D-=18,F+=1,this.words[F]|=P>>>26):D+=8}this.strip()};function o(C,d,x,m){for(var S=0,D=Math.min(C.length,x),F=d;F<D;F++){var P=C.charCodeAt(F)-48;S*=m,P>=49?S+=P-49+10:P>=17?S+=P-17+10:S+=P}return S}n.prototype._parseBase=function(d,x,m){this.words=[0],this.length=1;for(var S=0,D=1;D<=67108863;D*=x)S++;S--,D=D/x|0;for(var F=d.length-m,P=F%S,R=Math.min(F,F-P)+m,p=0,E=m;E<R;E+=S)p=o(d,E,E+S,x),this.imuln(D),this.words[0]+p<67108864?this.words[0]+=p:this._iaddn(p);if(P!==0){var q=1;for(p=o(d,E,d.length,x),E=0;E<P;E++)q*=x;this.imuln(q),this.words[0]+p<67108864?this.words[0]+=p:this._iaddn(p)}this.strip()},n.prototype.copy=function(d){d.words=new Array(this.length);for(var x=0;x<this.length;x++)d.words[x]=this.words[x];d.length=this.length,d.negative=this.negative,d.red=this.red},n.prototype.clone=function(){var d=new n(null);return this.copy(d),d},n.prototype._expand=function(d){for(;this.length<d;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var c=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(d,x){d=d||10,x=x|0||1;var m;if(d===16||d==="hex"){m="";for(var S=0,D=0,F=0;F<this.length;F++){var P=this.words[F],R=((P<<S|D)&16777215).toString(16);D=P>>>24-S&16777215,S+=2,S>=26&&(S-=26,F--),D!==0||F!==this.length-1?m=c[6-R.length]+R+m:m=R+m}for(D!==0&&(m=D.toString(16)+m);m.length%x!==0;)m="0"+m;return this.negative!==0&&(m="-"+m),m}if(d===(d|0)&&d>=2&&d<=36){var p=l[d],E=h[d];m="";var q=this.clone();for(q.negative=0;!q.isZero();){var j=q.modn(E).toString(d);q=q.idivn(E),q.isZero()?m=j+m:m=c[p-j.length]+j+m}for(this.isZero()&&(m="0"+m);m.length%x!==0;)m="0"+m;return this.negative!==0&&(m="-"+m),m}r(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var d=this.words[0];return this.length===2?d+=this.words[1]*67108864:this.length===3&&this.words[2]===1?d+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-d:d},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(d,x){return r(typeof s<"u"),this.toArrayLike(s,d,x)},n.prototype.toArray=function(d,x){return this.toArrayLike(Array,d,x)},n.prototype.toArrayLike=function(d,x,m){var S=this.byteLength(),D=m||Math.max(1,S);r(S<=D,"byte array longer than desired length"),r(D>0,"Requested array length <= 0"),this.strip();var F=x==="le",P=new d(D),R,p,E=this.clone();if(F){for(p=0;!E.isZero();p++)R=E.andln(255),E.iushrn(8),P[p]=R;for(;p<D;p++)P[p]=0}else{for(p=0;p<D-S;p++)P[p]=0;for(p=0;!E.isZero();p++)R=E.andln(255),E.iushrn(8),P[D-p-1]=R}return P},Math.clz32?n.prototype._countBits=function(d){return 32-Math.clz32(d)}:n.prototype._countBits=function(d){var x=d,m=0;return x>=4096&&(m+=13,x>>>=13),x>=64&&(m+=7,x>>>=7),x>=8&&(m+=4,x>>>=4),x>=2&&(m+=2,x>>>=2),m+x},n.prototype._zeroBits=function(d){if(d===0)return 26;var x=d,m=0;return x&8191||(m+=13,x>>>=13),x&127||(m+=7,x>>>=7),x&15||(m+=4,x>>>=4),x&3||(m+=2,x>>>=2),x&1||m++,m},n.prototype.bitLength=function(){var d=this.words[this.length-1],x=this._countBits(d);return(this.length-1)*26+x};function g(C){for(var d=new Array(C.bitLength()),x=0;x<d.length;x++){var m=x/26|0,S=x%26;d[x]=(C.words[m]&1<<S)>>>S}return d}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var d=0,x=0;x<this.length;x++){var m=this._zeroBits(this.words[x]);if(d+=m,m!==26)break}return d},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(d){return this.negative!==0?this.abs().inotn(d).iaddn(1):this.clone()},n.prototype.fromTwos=function(d){return this.testn(d-1)?this.notn(d).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(d){for(;this.length<d.length;)this.words[this.length++]=0;for(var x=0;x<d.length;x++)this.words[x]=this.words[x]|d.words[x];return this.strip()},n.prototype.ior=function(d){return r((this.negative|d.negative)===0),this.iuor(d)},n.prototype.or=function(d){return this.length>d.length?this.clone().ior(d):d.clone().ior(this)},n.prototype.uor=function(d){return this.length>d.length?this.clone().iuor(d):d.clone().iuor(this)},n.prototype.iuand=function(d){var x;this.length>d.length?x=d:x=this;for(var m=0;m<x.length;m++)this.words[m]=this.words[m]&d.words[m];return this.length=x.length,this.strip()},n.prototype.iand=function(d){return r((this.negative|d.negative)===0),this.iuand(d)},n.prototype.and=function(d){return this.length>d.length?this.clone().iand(d):d.clone().iand(this)},n.prototype.uand=function(d){return this.length>d.length?this.clone().iuand(d):d.clone().iuand(this)},n.prototype.iuxor=function(d){var x,m;this.length>d.length?(x=this,m=d):(x=d,m=this);for(var S=0;S<m.length;S++)this.words[S]=x.words[S]^m.words[S];if(this!==x)for(;S<x.length;S++)this.words[S]=x.words[S];return this.length=x.length,this.strip()},n.prototype.ixor=function(d){return r((this.negative|d.negative)===0),this.iuxor(d)},n.prototype.xor=function(d){return this.length>d.length?this.clone().ixor(d):d.clone().ixor(this)},n.prototype.uxor=function(d){return this.length>d.length?this.clone().iuxor(d):d.clone().iuxor(this)},n.prototype.inotn=function(d){r(typeof d=="number"&&d>=0);var x=Math.ceil(d/26)|0,m=d%26;this._expand(x),m>0&&x--;for(var S=0;S<x;S++)this.words[S]=~this.words[S]&67108863;return m>0&&(this.words[S]=~this.words[S]&67108863>>26-m),this.strip()},n.prototype.notn=function(d){return this.clone().inotn(d)},n.prototype.setn=function(d,x){r(typeof d=="number"&&d>=0);var m=d/26|0,S=d%26;return this._expand(m+1),x?this.words[m]=this.words[m]|1<<S:this.words[m]=this.words[m]&~(1<<S),this.strip()},n.prototype.iadd=function(d){var x;if(this.negative!==0&&d.negative===0)return this.negative=0,x=this.isub(d),this.negative^=1,this._normSign();if(this.negative===0&&d.negative!==0)return d.negative=0,x=this.isub(d),d.negative=1,x._normSign();var m,S;this.length>d.length?(m=this,S=d):(m=d,S=this);for(var D=0,F=0;F<S.length;F++)x=(m.words[F]|0)+(S.words[F]|0)+D,this.words[F]=x&67108863,D=x>>>26;for(;D!==0&&F<m.length;F++)x=(m.words[F]|0)+D,this.words[F]=x&67108863,D=x>>>26;if(this.length=m.length,D!==0)this.words[this.length]=D,this.length++;else if(m!==this)for(;F<m.length;F++)this.words[F]=m.words[F];return this},n.prototype.add=function(d){var x;return d.negative!==0&&this.negative===0?(d.negative=0,x=this.sub(d),d.negative^=1,x):d.negative===0&&this.negative!==0?(this.negative=0,x=d.sub(this),this.negative=1,x):this.length>d.length?this.clone().iadd(d):d.clone().iadd(this)},n.prototype.isub=function(d){if(d.negative!==0){d.negative=0;var x=this.iadd(d);return d.negative=1,x._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(d),this.negative=1,this._normSign();var m=this.cmp(d);if(m===0)return this.negative=0,this.length=1,this.words[0]=0,this;var S,D;m>0?(S=this,D=d):(S=d,D=this);for(var F=0,P=0;P<D.length;P++)x=(S.words[P]|0)-(D.words[P]|0)+F,F=x>>26,this.words[P]=x&67108863;for(;F!==0&&P<S.length;P++)x=(S.words[P]|0)+F,F=x>>26,this.words[P]=x&67108863;if(F===0&&P<S.length&&S!==this)for(;P<S.length;P++)this.words[P]=S.words[P];return this.length=Math.max(this.length,P),S!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(d){return this.clone().isub(d)};function v(C,d,x){x.negative=d.negative^C.negative;var m=C.length+d.length|0;x.length=m,m=m-1|0;var S=C.words[0]|0,D=d.words[0]|0,F=S*D,P=F&67108863,R=F/67108864|0;x.words[0]=P;for(var p=1;p<m;p++){for(var E=R>>>26,q=R&67108863,j=Math.min(p,d.length-1),G=Math.max(0,p-C.length+1);G<=j;G++){var ee=p-G|0;S=C.words[ee]|0,D=d.words[G]|0,F=S*D+q,E+=F/67108864|0,q=F&67108863}x.words[p]=q|0,R=E|0}return R!==0?x.words[p]=R|0:x.length--,x.strip()}var y=function(d,x,m){var S=d.words,D=x.words,F=m.words,P=0,R,p,E,q=S[0]|0,j=q&8191,G=q>>>13,ee=S[1]|0,re=ee&8191,fe=ee>>>13,se=S[2]|0,le=se&8191,ve=se>>>13,We=S[3]|0,pe=We&8191,he=We>>>13,we=S[4]|0,ge=we&8191,Pe=we>>>13,Yr=S[5]|0,Ue=Yr&8191,je=Yr>>>13,Fr=S[6]|0,Fe=Fr&8191,De=Fr>>>13,Jt=S[7]|0,He=Jt&8191,Qe=Jt>>>13,Ar=S[8]|0,Oe=Ar&8191,it=Ar>>>13,G0=S[9]|0,Xe=G0&8191,Me=G0>>>13,kr=D[0]|0,nt=kr&8191,Ye=kr>>>13,j0=D[1]|0,st=j0&8191,ft=j0>>>13,$0=D[2]|0,ot=$0&8191,Ze=$0>>>13,ua=D[3]|0,Je=ua&8191,ct=ua>>>13,da=D[4]|0,ut=da&8191,et=da>>>13,la=D[5]|0,dt=la&8191,tt=la>>>13,ha=D[6]|0,rt=ha&8191,Ie=ha>>>13,er=D[7]|0,at=er&8191,lt=er>>>13,Ms=D[8]|0,pt=Ms&8191,xt=Ms>>>13,Ls=D[9]|0,gt=Ls&8191,yt=Ls>>>13;m.negative=d.negative^x.negative,m.length=19,R=Math.imul(j,nt),p=Math.imul(j,Ye),p=p+Math.imul(G,nt)|0,E=Math.imul(G,Ye);var di=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(di>>>26)|0,di&=67108863,R=Math.imul(re,nt),p=Math.imul(re,Ye),p=p+Math.imul(fe,nt)|0,E=Math.imul(fe,Ye),R=R+Math.imul(j,st)|0,p=p+Math.imul(j,ft)|0,p=p+Math.imul(G,st)|0,E=E+Math.imul(G,ft)|0;var li=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(li>>>26)|0,li&=67108863,R=Math.imul(le,nt),p=Math.imul(le,Ye),p=p+Math.imul(ve,nt)|0,E=Math.imul(ve,Ye),R=R+Math.imul(re,st)|0,p=p+Math.imul(re,ft)|0,p=p+Math.imul(fe,st)|0,E=E+Math.imul(fe,ft)|0,R=R+Math.imul(j,ot)|0,p=p+Math.imul(j,Ze)|0,p=p+Math.imul(G,ot)|0,E=E+Math.imul(G,Ze)|0;var hi=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(hi>>>26)|0,hi&=67108863,R=Math.imul(pe,nt),p=Math.imul(pe,Ye),p=p+Math.imul(he,nt)|0,E=Math.imul(he,Ye),R=R+Math.imul(le,st)|0,p=p+Math.imul(le,ft)|0,p=p+Math.imul(ve,st)|0,E=E+Math.imul(ve,ft)|0,R=R+Math.imul(re,ot)|0,p=p+Math.imul(re,Ze)|0,p=p+Math.imul(fe,ot)|0,E=E+Math.imul(fe,Ze)|0,R=R+Math.imul(j,Je)|0,p=p+Math.imul(j,ct)|0,p=p+Math.imul(G,Je)|0,E=E+Math.imul(G,ct)|0;var vi=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(vi>>>26)|0,vi&=67108863,R=Math.imul(ge,nt),p=Math.imul(ge,Ye),p=p+Math.imul(Pe,nt)|0,E=Math.imul(Pe,Ye),R=R+Math.imul(pe,st)|0,p=p+Math.imul(pe,ft)|0,p=p+Math.imul(he,st)|0,E=E+Math.imul(he,ft)|0,R=R+Math.imul(le,ot)|0,p=p+Math.imul(le,Ze)|0,p=p+Math.imul(ve,ot)|0,E=E+Math.imul(ve,Ze)|0,R=R+Math.imul(re,Je)|0,p=p+Math.imul(re,ct)|0,p=p+Math.imul(fe,Je)|0,E=E+Math.imul(fe,ct)|0,R=R+Math.imul(j,ut)|0,p=p+Math.imul(j,et)|0,p=p+Math.imul(G,ut)|0,E=E+Math.imul(G,et)|0;var pi=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(pi>>>26)|0,pi&=67108863,R=Math.imul(Ue,nt),p=Math.imul(Ue,Ye),p=p+Math.imul(je,nt)|0,E=Math.imul(je,Ye),R=R+Math.imul(ge,st)|0,p=p+Math.imul(ge,ft)|0,p=p+Math.imul(Pe,st)|0,E=E+Math.imul(Pe,ft)|0,R=R+Math.imul(pe,ot)|0,p=p+Math.imul(pe,Ze)|0,p=p+Math.imul(he,ot)|0,E=E+Math.imul(he,Ze)|0,R=R+Math.imul(le,Je)|0,p=p+Math.imul(le,ct)|0,p=p+Math.imul(ve,Je)|0,E=E+Math.imul(ve,ct)|0,R=R+Math.imul(re,ut)|0,p=p+Math.imul(re,et)|0,p=p+Math.imul(fe,ut)|0,E=E+Math.imul(fe,et)|0,R=R+Math.imul(j,dt)|0,p=p+Math.imul(j,tt)|0,p=p+Math.imul(G,dt)|0,E=E+Math.imul(G,tt)|0;var xi=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(xi>>>26)|0,xi&=67108863,R=Math.imul(Fe,nt),p=Math.imul(Fe,Ye),p=p+Math.imul(De,nt)|0,E=Math.imul(De,Ye),R=R+Math.imul(Ue,st)|0,p=p+Math.imul(Ue,ft)|0,p=p+Math.imul(je,st)|0,E=E+Math.imul(je,ft)|0,R=R+Math.imul(ge,ot)|0,p=p+Math.imul(ge,Ze)|0,p=p+Math.imul(Pe,ot)|0,E=E+Math.imul(Pe,Ze)|0,R=R+Math.imul(pe,Je)|0,p=p+Math.imul(pe,ct)|0,p=p+Math.imul(he,Je)|0,E=E+Math.imul(he,ct)|0,R=R+Math.imul(le,ut)|0,p=p+Math.imul(le,et)|0,p=p+Math.imul(ve,ut)|0,E=E+Math.imul(ve,et)|0,R=R+Math.imul(re,dt)|0,p=p+Math.imul(re,tt)|0,p=p+Math.imul(fe,dt)|0,E=E+Math.imul(fe,tt)|0,R=R+Math.imul(j,rt)|0,p=p+Math.imul(j,Ie)|0,p=p+Math.imul(G,rt)|0,E=E+Math.imul(G,Ie)|0;var gi=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(gi>>>26)|0,gi&=67108863,R=Math.imul(He,nt),p=Math.imul(He,Ye),p=p+Math.imul(Qe,nt)|0,E=Math.imul(Qe,Ye),R=R+Math.imul(Fe,st)|0,p=p+Math.imul(Fe,ft)|0,p=p+Math.imul(De,st)|0,E=E+Math.imul(De,ft)|0,R=R+Math.imul(Ue,ot)|0,p=p+Math.imul(Ue,Ze)|0,p=p+Math.imul(je,ot)|0,E=E+Math.imul(je,Ze)|0,R=R+Math.imul(ge,Je)|0,p=p+Math.imul(ge,ct)|0,p=p+Math.imul(Pe,Je)|0,E=E+Math.imul(Pe,ct)|0,R=R+Math.imul(pe,ut)|0,p=p+Math.imul(pe,et)|0,p=p+Math.imul(he,ut)|0,E=E+Math.imul(he,et)|0,R=R+Math.imul(le,dt)|0,p=p+Math.imul(le,tt)|0,p=p+Math.imul(ve,dt)|0,E=E+Math.imul(ve,tt)|0,R=R+Math.imul(re,rt)|0,p=p+Math.imul(re,Ie)|0,p=p+Math.imul(fe,rt)|0,E=E+Math.imul(fe,Ie)|0,R=R+Math.imul(j,at)|0,p=p+Math.imul(j,lt)|0,p=p+Math.imul(G,at)|0,E=E+Math.imul(G,lt)|0;var yi=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(yi>>>26)|0,yi&=67108863,R=Math.imul(Oe,nt),p=Math.imul(Oe,Ye),p=p+Math.imul(it,nt)|0,E=Math.imul(it,Ye),R=R+Math.imul(He,st)|0,p=p+Math.imul(He,ft)|0,p=p+Math.imul(Qe,st)|0,E=E+Math.imul(Qe,ft)|0,R=R+Math.imul(Fe,ot)|0,p=p+Math.imul(Fe,Ze)|0,p=p+Math.imul(De,ot)|0,E=E+Math.imul(De,Ze)|0,R=R+Math.imul(Ue,Je)|0,p=p+Math.imul(Ue,ct)|0,p=p+Math.imul(je,Je)|0,E=E+Math.imul(je,ct)|0,R=R+Math.imul(ge,ut)|0,p=p+Math.imul(ge,et)|0,p=p+Math.imul(Pe,ut)|0,E=E+Math.imul(Pe,et)|0,R=R+Math.imul(pe,dt)|0,p=p+Math.imul(pe,tt)|0,p=p+Math.imul(he,dt)|0,E=E+Math.imul(he,tt)|0,R=R+Math.imul(le,rt)|0,p=p+Math.imul(le,Ie)|0,p=p+Math.imul(ve,rt)|0,E=E+Math.imul(ve,Ie)|0,R=R+Math.imul(re,at)|0,p=p+Math.imul(re,lt)|0,p=p+Math.imul(fe,at)|0,E=E+Math.imul(fe,lt)|0,R=R+Math.imul(j,pt)|0,p=p+Math.imul(j,xt)|0,p=p+Math.imul(G,pt)|0,E=E+Math.imul(G,xt)|0;var bi=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(bi>>>26)|0,bi&=67108863,R=Math.imul(Xe,nt),p=Math.imul(Xe,Ye),p=p+Math.imul(Me,nt)|0,E=Math.imul(Me,Ye),R=R+Math.imul(Oe,st)|0,p=p+Math.imul(Oe,ft)|0,p=p+Math.imul(it,st)|0,E=E+Math.imul(it,ft)|0,R=R+Math.imul(He,ot)|0,p=p+Math.imul(He,Ze)|0,p=p+Math.imul(Qe,ot)|0,E=E+Math.imul(Qe,Ze)|0,R=R+Math.imul(Fe,Je)|0,p=p+Math.imul(Fe,ct)|0,p=p+Math.imul(De,Je)|0,E=E+Math.imul(De,ct)|0,R=R+Math.imul(Ue,ut)|0,p=p+Math.imul(Ue,et)|0,p=p+Math.imul(je,ut)|0,E=E+Math.imul(je,et)|0,R=R+Math.imul(ge,dt)|0,p=p+Math.imul(ge,tt)|0,p=p+Math.imul(Pe,dt)|0,E=E+Math.imul(Pe,tt)|0,R=R+Math.imul(pe,rt)|0,p=p+Math.imul(pe,Ie)|0,p=p+Math.imul(he,rt)|0,E=E+Math.imul(he,Ie)|0,R=R+Math.imul(le,at)|0,p=p+Math.imul(le,lt)|0,p=p+Math.imul(ve,at)|0,E=E+Math.imul(ve,lt)|0,R=R+Math.imul(re,pt)|0,p=p+Math.imul(re,xt)|0,p=p+Math.imul(fe,pt)|0,E=E+Math.imul(fe,xt)|0,R=R+Math.imul(j,gt)|0,p=p+Math.imul(j,yt)|0,p=p+Math.imul(G,gt)|0,E=E+Math.imul(G,yt)|0;var mi=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(mi>>>26)|0,mi&=67108863,R=Math.imul(Xe,st),p=Math.imul(Xe,ft),p=p+Math.imul(Me,st)|0,E=Math.imul(Me,ft),R=R+Math.imul(Oe,ot)|0,p=p+Math.imul(Oe,Ze)|0,p=p+Math.imul(it,ot)|0,E=E+Math.imul(it,Ze)|0,R=R+Math.imul(He,Je)|0,p=p+Math.imul(He,ct)|0,p=p+Math.imul(Qe,Je)|0,E=E+Math.imul(Qe,ct)|0,R=R+Math.imul(Fe,ut)|0,p=p+Math.imul(Fe,et)|0,p=p+Math.imul(De,ut)|0,E=E+Math.imul(De,et)|0,R=R+Math.imul(Ue,dt)|0,p=p+Math.imul(Ue,tt)|0,p=p+Math.imul(je,dt)|0,E=E+Math.imul(je,tt)|0,R=R+Math.imul(ge,rt)|0,p=p+Math.imul(ge,Ie)|0,p=p+Math.imul(Pe,rt)|0,E=E+Math.imul(Pe,Ie)|0,R=R+Math.imul(pe,at)|0,p=p+Math.imul(pe,lt)|0,p=p+Math.imul(he,at)|0,E=E+Math.imul(he,lt)|0,R=R+Math.imul(le,pt)|0,p=p+Math.imul(le,xt)|0,p=p+Math.imul(ve,pt)|0,E=E+Math.imul(ve,xt)|0,R=R+Math.imul(re,gt)|0,p=p+Math.imul(re,yt)|0,p=p+Math.imul(fe,gt)|0,E=E+Math.imul(fe,yt)|0;var Ci=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(Ci>>>26)|0,Ci&=67108863,R=Math.imul(Xe,ot),p=Math.imul(Xe,Ze),p=p+Math.imul(Me,ot)|0,E=Math.imul(Me,Ze),R=R+Math.imul(Oe,Je)|0,p=p+Math.imul(Oe,ct)|0,p=p+Math.imul(it,Je)|0,E=E+Math.imul(it,ct)|0,R=R+Math.imul(He,ut)|0,p=p+Math.imul(He,et)|0,p=p+Math.imul(Qe,ut)|0,E=E+Math.imul(Qe,et)|0,R=R+Math.imul(Fe,dt)|0,p=p+Math.imul(Fe,tt)|0,p=p+Math.imul(De,dt)|0,E=E+Math.imul(De,tt)|0,R=R+Math.imul(Ue,rt)|0,p=p+Math.imul(Ue,Ie)|0,p=p+Math.imul(je,rt)|0,E=E+Math.imul(je,Ie)|0,R=R+Math.imul(ge,at)|0,p=p+Math.imul(ge,lt)|0,p=p+Math.imul(Pe,at)|0,E=E+Math.imul(Pe,lt)|0,R=R+Math.imul(pe,pt)|0,p=p+Math.imul(pe,xt)|0,p=p+Math.imul(he,pt)|0,E=E+Math.imul(he,xt)|0,R=R+Math.imul(le,gt)|0,p=p+Math.imul(le,yt)|0,p=p+Math.imul(ve,gt)|0,E=E+Math.imul(ve,yt)|0;var Ei=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(Ei>>>26)|0,Ei&=67108863,R=Math.imul(Xe,Je),p=Math.imul(Xe,ct),p=p+Math.imul(Me,Je)|0,E=Math.imul(Me,ct),R=R+Math.imul(Oe,ut)|0,p=p+Math.imul(Oe,et)|0,p=p+Math.imul(it,ut)|0,E=E+Math.imul(it,et)|0,R=R+Math.imul(He,dt)|0,p=p+Math.imul(He,tt)|0,p=p+Math.imul(Qe,dt)|0,E=E+Math.imul(Qe,tt)|0,R=R+Math.imul(Fe,rt)|0,p=p+Math.imul(Fe,Ie)|0,p=p+Math.imul(De,rt)|0,E=E+Math.imul(De,Ie)|0,R=R+Math.imul(Ue,at)|0,p=p+Math.imul(Ue,lt)|0,p=p+Math.imul(je,at)|0,E=E+Math.imul(je,lt)|0,R=R+Math.imul(ge,pt)|0,p=p+Math.imul(ge,xt)|0,p=p+Math.imul(Pe,pt)|0,E=E+Math.imul(Pe,xt)|0,R=R+Math.imul(pe,gt)|0,p=p+Math.imul(pe,yt)|0,p=p+Math.imul(he,gt)|0,E=E+Math.imul(he,yt)|0;var Ai=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(Ai>>>26)|0,Ai&=67108863,R=Math.imul(Xe,ut),p=Math.imul(Xe,et),p=p+Math.imul(Me,ut)|0,E=Math.imul(Me,et),R=R+Math.imul(Oe,dt)|0,p=p+Math.imul(Oe,tt)|0,p=p+Math.imul(it,dt)|0,E=E+Math.imul(it,tt)|0,R=R+Math.imul(He,rt)|0,p=p+Math.imul(He,Ie)|0,p=p+Math.imul(Qe,rt)|0,E=E+Math.imul(Qe,Ie)|0,R=R+Math.imul(Fe,at)|0,p=p+Math.imul(Fe,lt)|0,p=p+Math.imul(De,at)|0,E=E+Math.imul(De,lt)|0,R=R+Math.imul(Ue,pt)|0,p=p+Math.imul(Ue,xt)|0,p=p+Math.imul(je,pt)|0,E=E+Math.imul(je,xt)|0,R=R+Math.imul(ge,gt)|0,p=p+Math.imul(ge,yt)|0,p=p+Math.imul(Pe,gt)|0,E=E+Math.imul(Pe,yt)|0;var Si=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(Si>>>26)|0,Si&=67108863,R=Math.imul(Xe,dt),p=Math.imul(Xe,tt),p=p+Math.imul(Me,dt)|0,E=Math.imul(Me,tt),R=R+Math.imul(Oe,rt)|0,p=p+Math.imul(Oe,Ie)|0,p=p+Math.imul(it,rt)|0,E=E+Math.imul(it,Ie)|0,R=R+Math.imul(He,at)|0,p=p+Math.imul(He,lt)|0,p=p+Math.imul(Qe,at)|0,E=E+Math.imul(Qe,lt)|0,R=R+Math.imul(Fe,pt)|0,p=p+Math.imul(Fe,xt)|0,p=p+Math.imul(De,pt)|0,E=E+Math.imul(De,xt)|0,R=R+Math.imul(Ue,gt)|0,p=p+Math.imul(Ue,yt)|0,p=p+Math.imul(je,gt)|0,E=E+Math.imul(je,yt)|0;var Bi=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(Bi>>>26)|0,Bi&=67108863,R=Math.imul(Xe,rt),p=Math.imul(Xe,Ie),p=p+Math.imul(Me,rt)|0,E=Math.imul(Me,Ie),R=R+Math.imul(Oe,at)|0,p=p+Math.imul(Oe,lt)|0,p=p+Math.imul(it,at)|0,E=E+Math.imul(it,lt)|0,R=R+Math.imul(He,pt)|0,p=p+Math.imul(He,xt)|0,p=p+Math.imul(Qe,pt)|0,E=E+Math.imul(Qe,xt)|0,R=R+Math.imul(Fe,gt)|0,p=p+Math.imul(Fe,yt)|0,p=p+Math.imul(De,gt)|0,E=E+Math.imul(De,yt)|0;var _i=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(_i>>>26)|0,_i&=67108863,R=Math.imul(Xe,at),p=Math.imul(Xe,lt),p=p+Math.imul(Me,at)|0,E=Math.imul(Me,lt),R=R+Math.imul(Oe,pt)|0,p=p+Math.imul(Oe,xt)|0,p=p+Math.imul(it,pt)|0,E=E+Math.imul(it,xt)|0,R=R+Math.imul(He,gt)|0,p=p+Math.imul(He,yt)|0,p=p+Math.imul(Qe,gt)|0,E=E+Math.imul(Qe,yt)|0;var Ii=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(Ii>>>26)|0,Ii&=67108863,R=Math.imul(Xe,pt),p=Math.imul(Xe,xt),p=p+Math.imul(Me,pt)|0,E=Math.imul(Me,xt),R=R+Math.imul(Oe,gt)|0,p=p+Math.imul(Oe,yt)|0,p=p+Math.imul(it,gt)|0,E=E+Math.imul(it,yt)|0;var Ti=(P+R|0)+((p&8191)<<13)|0;P=(E+(p>>>13)|0)+(Ti>>>26)|0,Ti&=67108863,R=Math.imul(Xe,gt),p=Math.imul(Xe,yt),p=p+Math.imul(Me,gt)|0,E=Math.imul(Me,yt);var wi=(P+R|0)+((p&8191)<<13)|0;return P=(E+(p>>>13)|0)+(wi>>>26)|0,wi&=67108863,F[0]=di,F[1]=li,F[2]=hi,F[3]=vi,F[4]=pi,F[5]=xi,F[6]=gi,F[7]=yi,F[8]=bi,F[9]=mi,F[10]=Ci,F[11]=Ei,F[12]=Ai,F[13]=Si,F[14]=Bi,F[15]=_i,F[16]=Ii,F[17]=Ti,F[18]=wi,P!==0&&(F[19]=P,m.length++),m};Math.imul||(y=v);function b(C,d,x){x.negative=d.negative^C.negative,x.length=C.length+d.length;for(var m=0,S=0,D=0;D<x.length-1;D++){var F=S;S=0;for(var P=m&67108863,R=Math.min(D,d.length-1),p=Math.max(0,D-C.length+1);p<=R;p++){var E=D-p,q=C.words[E]|0,j=d.words[p]|0,G=q*j,ee=G&67108863;F=F+(G/67108864|0)|0,ee=ee+P|0,P=ee&67108863,F=F+(ee>>>26)|0,S+=F>>>26,F&=67108863}x.words[D]=P,m=F,F=S}return m!==0?x.words[D]=m:x.length--,x.strip()}function I(C,d,x){var m=new A;return m.mulp(C,d,x)}n.prototype.mulTo=function(d,x){var m,S=this.length+d.length;return this.length===10&&d.length===10?m=y(this,d,x):S<63?m=v(this,d,x):S<1024?m=b(this,d,x):m=I(this,d,x),m};function A(C,d){this.x=C,this.y=d}A.prototype.makeRBT=function(d){for(var x=new Array(d),m=n.prototype._countBits(d)-1,S=0;S<d;S++)x[S]=this.revBin(S,m,d);return x},A.prototype.revBin=function(d,x,m){if(d===0||d===m-1)return d;for(var S=0,D=0;D<x;D++)S|=(d&1)<<x-D-1,d>>=1;return S},A.prototype.permute=function(d,x,m,S,D,F){for(var P=0;P<F;P++)S[P]=x[d[P]],D[P]=m[d[P]]},A.prototype.transform=function(d,x,m,S,D,F){this.permute(F,d,x,m,S,D);for(var P=1;P<D;P<<=1)for(var R=P<<1,p=Math.cos(2*Math.PI/R),E=Math.sin(2*Math.PI/R),q=0;q<D;q+=R)for(var j=p,G=E,ee=0;ee<P;ee++){var re=m[q+ee],fe=S[q+ee],se=m[q+ee+P],le=S[q+ee+P],ve=j*se-G*le;le=j*le+G*se,se=ve,m[q+ee]=re+se,S[q+ee]=fe+le,m[q+ee+P]=re-se,S[q+ee+P]=fe-le,ee!==R&&(ve=p*j-E*G,G=p*G+E*j,j=ve)}},A.prototype.guessLen13b=function(d,x){var m=Math.max(x,d)|1,S=m&1,D=0;for(m=m/2|0;m;m=m>>>1)D++;return 1<<D+1+S},A.prototype.conjugate=function(d,x,m){if(!(m<=1))for(var S=0;S<m/2;S++){var D=d[S];d[S]=d[m-S-1],d[m-S-1]=D,D=x[S],x[S]=-x[m-S-1],x[m-S-1]=-D}},A.prototype.normalize13b=function(d,x){for(var m=0,S=0;S<x/2;S++){var D=Math.round(d[2*S+1]/x)*8192+Math.round(d[2*S]/x)+m;d[S]=D&67108863,D<67108864?m=0:m=D/67108864|0}return d},A.prototype.convert13b=function(d,x,m,S){for(var D=0,F=0;F<x;F++)D=D+(d[F]|0),m[2*F]=D&8191,D=D>>>13,m[2*F+1]=D&8191,D=D>>>13;for(F=2*x;F<S;++F)m[F]=0;r(D===0),r((D&-8192)===0)},A.prototype.stub=function(d){for(var x=new Array(d),m=0;m<d;m++)x[m]=0;return x},A.prototype.mulp=function(d,x,m){var S=2*this.guessLen13b(d.length,x.length),D=this.makeRBT(S),F=this.stub(S),P=new Array(S),R=new Array(S),p=new Array(S),E=new Array(S),q=new Array(S),j=new Array(S),G=m.words;G.length=S,this.convert13b(d.words,d.length,P,S),this.convert13b(x.words,x.length,E,S),this.transform(P,F,R,p,S,D),this.transform(E,F,q,j,S,D);for(var ee=0;ee<S;ee++){var re=R[ee]*q[ee]-p[ee]*j[ee];p[ee]=R[ee]*j[ee]+p[ee]*q[ee],R[ee]=re}return this.conjugate(R,p,S),this.transform(R,p,G,F,S,D),this.conjugate(G,F,S),this.normalize13b(G,S),m.negative=d.negative^x.negative,m.length=d.length+x.length,m.strip()},n.prototype.mul=function(d){var x=new n(null);return x.words=new Array(this.length+d.length),this.mulTo(d,x)},n.prototype.mulf=function(d){var x=new n(null);return x.words=new Array(this.length+d.length),I(this,d,x)},n.prototype.imul=function(d){return this.clone().mulTo(d,this)},n.prototype.imuln=function(d){r(typeof d=="number"),r(d<67108864);for(var x=0,m=0;m<this.length;m++){var S=(this.words[m]|0)*d,D=(S&67108863)+(x&67108863);x>>=26,x+=S/67108864|0,x+=D>>>26,this.words[m]=D&67108863}return x!==0&&(this.words[m]=x,this.length++),this.length=d===0?1:this.length,this},n.prototype.muln=function(d){return this.clone().imuln(d)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(d){var x=g(d);if(x.length===0)return new n(1);for(var m=this,S=0;S<x.length&&x[S]===0;S++,m=m.sqr());if(++S<x.length)for(var D=m.sqr();S<x.length;S++,D=D.sqr())x[S]!==0&&(m=m.mul(D));return m},n.prototype.iushln=function(d){r(typeof d=="number"&&d>=0);var x=d%26,m=(d-x)/26,S=67108863>>>26-x<<26-x,D;if(x!==0){var F=0;for(D=0;D<this.length;D++){var P=this.words[D]&S,R=(this.words[D]|0)-P<<x;this.words[D]=R|F,F=P>>>26-x}F&&(this.words[D]=F,this.length++)}if(m!==0){for(D=this.length-1;D>=0;D--)this.words[D+m]=this.words[D];for(D=0;D<m;D++)this.words[D]=0;this.length+=m}return this.strip()},n.prototype.ishln=function(d){return r(this.negative===0),this.iushln(d)},n.prototype.iushrn=function(d,x,m){r(typeof d=="number"&&d>=0);var S;x?S=(x-x%26)/26:S=0;var D=d%26,F=Math.min((d-D)/26,this.length),P=67108863^67108863>>>D<<D,R=m;if(S-=F,S=Math.max(0,S),R){for(var p=0;p<F;p++)R.words[p]=this.words[p];R.length=F}if(F!==0)if(this.length>F)for(this.length-=F,p=0;p<this.length;p++)this.words[p]=this.words[p+F];else this.words[0]=0,this.length=1;var E=0;for(p=this.length-1;p>=0&&(E!==0||p>=S);p--){var q=this.words[p]|0;this.words[p]=E<<26-D|q>>>D,E=q&P}return R&&E!==0&&(R.words[R.length++]=E),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(d,x,m){return r(this.negative===0),this.iushrn(d,x,m)},n.prototype.shln=function(d){return this.clone().ishln(d)},n.prototype.ushln=function(d){return this.clone().iushln(d)},n.prototype.shrn=function(d){return this.clone().ishrn(d)},n.prototype.ushrn=function(d){return this.clone().iushrn(d)},n.prototype.testn=function(d){r(typeof d=="number"&&d>=0);var x=d%26,m=(d-x)/26,S=1<<x;if(this.length<=m)return!1;var D=this.words[m];return!!(D&S)},n.prototype.imaskn=function(d){r(typeof d=="number"&&d>=0);var x=d%26,m=(d-x)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=m)return this;if(x!==0&&m++,this.length=Math.min(m,this.length),x!==0){var S=67108863^67108863>>>x<<x;this.words[this.length-1]&=S}return this.strip()},n.prototype.maskn=function(d){return this.clone().imaskn(d)},n.prototype.iaddn=function(d){return r(typeof d=="number"),r(d<67108864),d<0?this.isubn(-d):this.negative!==0?this.length===1&&(this.words[0]|0)<d?(this.words[0]=d-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(d),this.negative=1,this):this._iaddn(d)},n.prototype._iaddn=function(d){this.words[0]+=d;for(var x=0;x<this.length&&this.words[x]>=67108864;x++)this.words[x]-=67108864,x===this.length-1?this.words[x+1]=1:this.words[x+1]++;return this.length=Math.max(this.length,x+1),this},n.prototype.isubn=function(d){if(r(typeof d=="number"),r(d<67108864),d<0)return this.iaddn(-d);if(this.negative!==0)return this.negative=0,this.iaddn(d),this.negative=1,this;if(this.words[0]-=d,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var x=0;x<this.length&&this.words[x]<0;x++)this.words[x]+=67108864,this.words[x+1]-=1;return this.strip()},n.prototype.addn=function(d){return this.clone().iaddn(d)},n.prototype.subn=function(d){return this.clone().isubn(d)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(d,x,m){var S=d.length+m,D;this._expand(S);var F,P=0;for(D=0;D<d.length;D++){F=(this.words[D+m]|0)+P;var R=(d.words[D]|0)*x;F-=R&67108863,P=(F>>26)-(R/67108864|0),this.words[D+m]=F&67108863}for(;D<this.length-m;D++)F=(this.words[D+m]|0)+P,P=F>>26,this.words[D+m]=F&67108863;if(P===0)return this.strip();for(r(P===-1),P=0,D=0;D<this.length;D++)F=-(this.words[D]|0)+P,P=F>>26,this.words[D]=F&67108863;return this.negative=1,this.strip()},n.prototype._wordDiv=function(d,x){var m=this.length-d.length,S=this.clone(),D=d,F=D.words[D.length-1]|0,P=this._countBits(F);m=26-P,m!==0&&(D=D.ushln(m),S.iushln(m),F=D.words[D.length-1]|0);var R=S.length-D.length,p;if(x!=="mod"){p=new n(null),p.length=R+1,p.words=new Array(p.length);for(var E=0;E<p.length;E++)p.words[E]=0}var q=S.clone()._ishlnsubmul(D,1,R);q.negative===0&&(S=q,p&&(p.words[R]=1));for(var j=R-1;j>=0;j--){var G=(S.words[D.length+j]|0)*67108864+(S.words[D.length+j-1]|0);for(G=Math.min(G/F|0,67108863),S._ishlnsubmul(D,G,j);S.negative!==0;)G--,S.negative=0,S._ishlnsubmul(D,1,j),S.isZero()||(S.negative^=1);p&&(p.words[j]=G)}return p&&p.strip(),S.strip(),x!=="div"&&m!==0&&S.iushrn(m),{div:p||null,mod:S}},n.prototype.divmod=function(d,x,m){if(r(!d.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var S,D,F;return this.negative!==0&&d.negative===0?(F=this.neg().divmod(d,x),x!=="mod"&&(S=F.div.neg()),x!=="div"&&(D=F.mod.neg(),m&&D.negative!==0&&D.iadd(d)),{div:S,mod:D}):this.negative===0&&d.negative!==0?(F=this.divmod(d.neg(),x),x!=="mod"&&(S=F.div.neg()),{div:S,mod:F.mod}):this.negative&d.negative?(F=this.neg().divmod(d.neg(),x),x!=="div"&&(D=F.mod.neg(),m&&D.negative!==0&&D.isub(d)),{div:F.div,mod:D}):d.length>this.length||this.cmp(d)<0?{div:new n(0),mod:this}:d.length===1?x==="div"?{div:this.divn(d.words[0]),mod:null}:x==="mod"?{div:null,mod:new n(this.modn(d.words[0]))}:{div:this.divn(d.words[0]),mod:new n(this.modn(d.words[0]))}:this._wordDiv(d,x)},n.prototype.div=function(d){return this.divmod(d,"div",!1).div},n.prototype.mod=function(d){return this.divmod(d,"mod",!1).mod},n.prototype.umod=function(d){return this.divmod(d,"mod",!0).mod},n.prototype.divRound=function(d){var x=this.divmod(d);if(x.mod.isZero())return x.div;var m=x.div.negative!==0?x.mod.isub(d):x.mod,S=d.ushrn(1),D=d.andln(1),F=m.cmp(S);return F<0||D===1&&F===0?x.div:x.div.negative!==0?x.div.isubn(1):x.div.iaddn(1)},n.prototype.modn=function(d){r(d<=67108863);for(var x=(1<<26)%d,m=0,S=this.length-1;S>=0;S--)m=(x*m+(this.words[S]|0))%d;return m},n.prototype.idivn=function(d){r(d<=67108863);for(var x=0,m=this.length-1;m>=0;m--){var S=(this.words[m]|0)+x*67108864;this.words[m]=S/d|0,x=S%d}return this.strip()},n.prototype.divn=function(d){return this.clone().idivn(d)},n.prototype.egcd=function(d){r(d.negative===0),r(!d.isZero());var x=this,m=d.clone();x.negative!==0?x=x.umod(d):x=x.clone();for(var S=new n(1),D=new n(0),F=new n(0),P=new n(1),R=0;x.isEven()&&m.isEven();)x.iushrn(1),m.iushrn(1),++R;for(var p=m.clone(),E=x.clone();!x.isZero();){for(var q=0,j=1;!(x.words[0]&j)&&q<26;++q,j<<=1);if(q>0)for(x.iushrn(q);q-- >0;)(S.isOdd()||D.isOdd())&&(S.iadd(p),D.isub(E)),S.iushrn(1),D.iushrn(1);for(var G=0,ee=1;!(m.words[0]&ee)&&G<26;++G,ee<<=1);if(G>0)for(m.iushrn(G);G-- >0;)(F.isOdd()||P.isOdd())&&(F.iadd(p),P.isub(E)),F.iushrn(1),P.iushrn(1);x.cmp(m)>=0?(x.isub(m),S.isub(F),D.isub(P)):(m.isub(x),F.isub(S),P.isub(D))}return{a:F,b:P,gcd:m.iushln(R)}},n.prototype._invmp=function(d){r(d.negative===0),r(!d.isZero());var x=this,m=d.clone();x.negative!==0?x=x.umod(d):x=x.clone();for(var S=new n(1),D=new n(0),F=m.clone();x.cmpn(1)>0&&m.cmpn(1)>0;){for(var P=0,R=1;!(x.words[0]&R)&&P<26;++P,R<<=1);if(P>0)for(x.iushrn(P);P-- >0;)S.isOdd()&&S.iadd(F),S.iushrn(1);for(var p=0,E=1;!(m.words[0]&E)&&p<26;++p,E<<=1);if(p>0)for(m.iushrn(p);p-- >0;)D.isOdd()&&D.iadd(F),D.iushrn(1);x.cmp(m)>=0?(x.isub(m),S.isub(D)):(m.isub(x),D.isub(S))}var q;return x.cmpn(1)===0?q=S:q=D,q.cmpn(0)<0&&q.iadd(d),q},n.prototype.gcd=function(d){if(this.isZero())return d.abs();if(d.isZero())return this.abs();var x=this.clone(),m=d.clone();x.negative=0,m.negative=0;for(var S=0;x.isEven()&&m.isEven();S++)x.iushrn(1),m.iushrn(1);do{for(;x.isEven();)x.iushrn(1);for(;m.isEven();)m.iushrn(1);var D=x.cmp(m);if(D<0){var F=x;x=m,m=F}else if(D===0||m.cmpn(1)===0)break;x.isub(m)}while(!0);return m.iushln(S)},n.prototype.invm=function(d){return this.egcd(d).a.umod(d)},n.prototype.isEven=function(){return(this.words[0]&1)===0},n.prototype.isOdd=function(){return(this.words[0]&1)===1},n.prototype.andln=function(d){return this.words[0]&d},n.prototype.bincn=function(d){r(typeof d=="number");var x=d%26,m=(d-x)/26,S=1<<x;if(this.length<=m)return this._expand(m+1),this.words[m]|=S,this;for(var D=S,F=m;D!==0&&F<this.length;F++){var P=this.words[F]|0;P+=D,D=P>>>26,P&=67108863,this.words[F]=P}return D!==0&&(this.words[F]=D,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(d){var x=d<0;if(this.negative!==0&&!x)return-1;if(this.negative===0&&x)return 1;this.strip();var m;if(this.length>1)m=1;else{x&&(d=-d),r(d<=67108863,"Number is too big");var S=this.words[0]|0;m=S===d?0:S<d?-1:1}return this.negative!==0?-m|0:m},n.prototype.cmp=function(d){if(this.negative!==0&&d.negative===0)return-1;if(this.negative===0&&d.negative!==0)return 1;var x=this.ucmp(d);return this.negative!==0?-x|0:x},n.prototype.ucmp=function(d){if(this.length>d.length)return 1;if(this.length<d.length)return-1;for(var x=0,m=this.length-1;m>=0;m--){var S=this.words[m]|0,D=d.words[m]|0;if(S!==D){S<D?x=-1:S>D&&(x=1);break}}return x},n.prototype.gtn=function(d){return this.cmpn(d)===1},n.prototype.gt=function(d){return this.cmp(d)===1},n.prototype.gten=function(d){return this.cmpn(d)>=0},n.prototype.gte=function(d){return this.cmp(d)>=0},n.prototype.ltn=function(d){return this.cmpn(d)===-1},n.prototype.lt=function(d){return this.cmp(d)===-1},n.prototype.lten=function(d){return this.cmpn(d)<=0},n.prototype.lte=function(d){return this.cmp(d)<=0},n.prototype.eqn=function(d){return this.cmpn(d)===0},n.prototype.eq=function(d){return this.cmp(d)===0},n.red=function(d){return new W(d)},n.prototype.toRed=function(d){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),d.convertTo(this)._forceRed(d)},n.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(d){return this.red=d,this},n.prototype.forceRed=function(d){return r(!this.red,"Already a number in reduction context"),this._forceRed(d)},n.prototype.redAdd=function(d){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,d)},n.prototype.redIAdd=function(d){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,d)},n.prototype.redSub=function(d){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,d)},n.prototype.redISub=function(d){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,d)},n.prototype.redShl=function(d){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,d)},n.prototype.redMul=function(d){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,d),this.red.mul(this,d)},n.prototype.redIMul=function(d){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,d),this.red.imul(this,d)},n.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(d){return r(this.red&&!d.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,d)};var w={k256:null,p224:null,p192:null,p25519:null};function N(C,d){this.name=C,this.p=new n(d,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}N.prototype._tmp=function(){var d=new n(null);return d.words=new Array(Math.ceil(this.n/13)),d},N.prototype.ireduce=function(d){var x=d,m;do this.split(x,this.tmp),x=this.imulK(x),x=x.iadd(this.tmp),m=x.bitLength();while(m>this.n);var S=m<this.n?-1:x.ucmp(this.p);return S===0?(x.words[0]=0,x.length=1):S>0?x.isub(this.p):x.strip!==void 0?x.strip():x._strip(),x},N.prototype.split=function(d,x){d.iushrn(this.n,0,x)},N.prototype.imulK=function(d){return d.imul(this.k)};function k(){N.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(k,N),k.prototype.split=function(d,x){for(var m=4194303,S=Math.min(d.length,9),D=0;D<S;D++)x.words[D]=d.words[D];if(x.length=S,d.length<=9){d.words[0]=0,d.length=1;return}var F=d.words[9];for(x.words[x.length++]=F&m,D=10;D<d.length;D++){var P=d.words[D]|0;d.words[D-10]=(P&m)<<4|F>>>22,F=P}F>>>=22,d.words[D-10]=F,F===0&&d.length>10?d.length-=10:d.length-=9},k.prototype.imulK=function(d){d.words[d.length]=0,d.words[d.length+1]=0,d.length+=2;for(var x=0,m=0;m<d.length;m++){var S=d.words[m]|0;x+=S*977,d.words[m]=x&67108863,x=S*64+(x/67108864|0)}return d.words[d.length-1]===0&&(d.length--,d.words[d.length-1]===0&&d.length--),d};function M(){N.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(M,N);function V(){N.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(V,N);function z(){N.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i(z,N),z.prototype.imulK=function(d){for(var x=0,m=0;m<d.length;m++){var S=(d.words[m]|0)*19+x,D=S&67108863;S>>>=26,d.words[m]=D,x=S}return x!==0&&(d.words[d.length++]=x),d},n._prime=function(d){if(w[d])return w[d];var x;if(d==="k256")x=new k;else if(d==="p224")x=new M;else if(d==="p192")x=new V;else if(d==="p25519")x=new z;else throw new Error("Unknown prime "+d);return w[d]=x,x};function W(C){if(typeof C=="string"){var d=n._prime(C);this.m=d.p,this.prime=d}else r(C.gtn(1),"modulus must be greater than 1"),this.m=C,this.prime=null}W.prototype._verify1=function(d){r(d.negative===0,"red works only with positives"),r(d.red,"red works only with red numbers")},W.prototype._verify2=function(d,x){r((d.negative|x.negative)===0,"red works only with positives"),r(d.red&&d.red===x.red,"red works only with red numbers")},W.prototype.imod=function(d){return this.prime?this.prime.ireduce(d)._forceRed(this):d.umod(this.m)._forceRed(this)},W.prototype.neg=function(d){return d.isZero()?d.clone():this.m.sub(d)._forceRed(this)},W.prototype.add=function(d,x){this._verify2(d,x);var m=d.add(x);return m.cmp(this.m)>=0&&m.isub(this.m),m._forceRed(this)},W.prototype.iadd=function(d,x){this._verify2(d,x);var m=d.iadd(x);return m.cmp(this.m)>=0&&m.isub(this.m),m},W.prototype.sub=function(d,x){this._verify2(d,x);var m=d.sub(x);return m.cmpn(0)<0&&m.iadd(this.m),m._forceRed(this)},W.prototype.isub=function(d,x){this._verify2(d,x);var m=d.isub(x);return m.cmpn(0)<0&&m.iadd(this.m),m},W.prototype.shl=function(d,x){return this._verify1(d),this.imod(d.ushln(x))},W.prototype.imul=function(d,x){return this._verify2(d,x),this.imod(d.imul(x))},W.prototype.mul=function(d,x){return this._verify2(d,x),this.imod(d.mul(x))},W.prototype.isqr=function(d){return this.imul(d,d.clone())},W.prototype.sqr=function(d){return this.mul(d,d)},W.prototype.sqrt=function(d){if(d.isZero())return d.clone();var x=this.m.andln(3);if(r(x%2===1),x===3){var m=this.m.add(new n(1)).iushrn(2);return this.pow(d,m)}for(var S=this.m.subn(1),D=0;!S.isZero()&&S.andln(1)===0;)D++,S.iushrn(1);r(!S.isZero());var F=new n(1).toRed(this),P=F.redNeg(),R=this.m.subn(1).iushrn(1),p=this.m.bitLength();for(p=new n(2*p*p).toRed(this);this.pow(p,R).cmp(P)!==0;)p.redIAdd(P);for(var E=this.pow(p,S),q=this.pow(d,S.addn(1).iushrn(1)),j=this.pow(d,S),G=D;j.cmp(F)!==0;){for(var ee=j,re=0;ee.cmp(F)!==0;re++)ee=ee.redSqr();r(re<G);var fe=this.pow(E,new n(1).iushln(G-re-1));q=q.redMul(fe),E=fe.redSqr(),j=j.redMul(E),G=re}return q},W.prototype.invm=function(d){var x=d._invmp(this.m);return x.negative!==0?(x.negative=0,this.imod(x).redNeg()):this.imod(x)},W.prototype.pow=function(d,x){if(x.isZero())return new n(1).toRed(this);if(x.cmpn(1)===0)return d.clone();var m=4,S=new Array(1<<m);S[0]=new n(1).toRed(this),S[1]=d;for(var D=2;D<S.length;D++)S[D]=this.mul(S[D-1],d);var F=S[0],P=0,R=0,p=x.bitLength()%26;for(p===0&&(p=26),D=x.length-1;D>=0;D--){for(var E=x.words[D],q=p-1;q>=0;q--){var j=E>>q&1;if(F!==S[0]&&(F=this.sqr(F)),j===0&&P===0){R=0;continue}P<<=1,P|=j,R++,!(R!==m&&(D!==0||q!==0))&&(F=this.mul(F,S[P]),R=0,P=0)}p=26}return F},W.prototype.convertTo=function(d){var x=d.umod(this.m);return x===d?x.clone():x},W.prototype.convertFrom=function(d){var x=d.clone();return x.red=null,x},n.mont=function(d){return new U(d)};function U(C){W.call(this,C),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}i(U,W),U.prototype.convertTo=function(d){return this.imod(d.ushln(this.shift))},U.prototype.convertFrom=function(d){var x=this.imod(d.mul(this.rinv));return x.red=null,x},U.prototype.imul=function(d,x){if(d.isZero()||x.isZero())return d.words[0]=0,d.length=1,d;var m=d.imul(x),S=m.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),D=m.isub(S).iushrn(this.shift),F=D;return D.cmp(this.m)>=0?F=D.isub(this.m):D.cmpn(0)<0&&(F=D.iadd(this.m)),F._forceRed(this)},U.prototype.mul=function(d,x){if(d.isZero()||x.isZero())return new n(0)._forceRed(this);var m=d.mul(x),S=m.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),D=m.isub(S).iushrn(this.shift),F=D;return D.cmp(this.m)>=0?F=D.isub(this.m):D.cmpn(0)<0&&(F=D.iadd(this.m)),F._forceRed(this)},U.prototype.invm=function(d){var x=this.imod(d._invmp(this.m).mul(this.r2));return x._forceRed(this)}})(e,be)})(os);var Rr=os.exports,l0=Po;function Po(e,t){if(!e)throw new Error(t||"Assertion failed")}Po.equal=function(t,a,r){if(t!=a)throw new Error(r||"Assertion failed: "+t+" != "+a)};var cs={};(function(e){var t=e;function a(n,s){if(Array.isArray(n))return n.slice();if(!n)return[];var f=[];if(typeof n!="string"){for(var u=0;u<n.length;u++)f[u]=n[u]|0;return f}if(s==="hex"){n=n.replace(/[^a-z0-9]+/ig,""),n.length%2!==0&&(n="0"+n);for(var u=0;u<n.length;u+=2)f.push(parseInt(n[u]+n[u+1],16))}else for(var u=0;u<n.length;u++){var o=n.charCodeAt(u),c=o>>8,l=o&255;c?f.push(c,l):f.push(l)}return f}t.toArray=a;function r(n){return n.length===1?"0"+n:n}t.zero2=r;function i(n){for(var s="",f=0;f<n.length;f++)s+=r(n[f].toString(16));return s}t.toHex=i,t.encode=function(s,f){return f==="hex"?i(s):s}})(cs);(function(e){var t=e,a=Rr,r=l0,i=cs;t.assert=r,t.toArray=i.toArray,t.zero2=i.zero2,t.toHex=i.toHex,t.encode=i.encode;function n(c,l,h){var g=new Array(Math.max(c.bitLength(),h)+1),v;for(v=0;v<g.length;v+=1)g[v]=0;var y=1<<l+1,b=c.clone();for(v=0;v<g.length;v++){var I,A=b.andln(y-1);b.isOdd()?(A>(y>>1)-1?I=(y>>1)-A:I=A,b.isubn(I)):I=0,g[v]=I,b.iushrn(1)}return g}t.getNAF=n;function s(c,l){var h=[[],[]];c=c.clone(),l=l.clone();for(var g=0,v=0,y;c.cmpn(-g)>0||l.cmpn(-v)>0;){var b=c.andln(3)+g&3,I=l.andln(3)+v&3;b===3&&(b=-1),I===3&&(I=-1);var A;b&1?(y=c.andln(7)+g&7,(y===3||y===5)&&I===2?A=-b:A=b):A=0,h[0].push(A);var w;I&1?(y=l.andln(7)+v&7,(y===3||y===5)&&b===2?w=-I:w=I):w=0,h[1].push(w),2*g===A+1&&(g=1-g),2*v===w+1&&(v=1-v),c.iushrn(1),l.iushrn(1)}return h}t.getJSF=s;function f(c,l,h){var g="_"+l;c.prototype[l]=function(){return this[g]!==void 0?this[g]:this[g]=h.call(this)}}t.cachedProperty=f;function u(c){return typeof c=="string"?t.toArray(c,"hex"):c}t.parseBytes=u;function o(c){return new a(c,"hex","le")}t.intFromLE=o})(zt);var us={exports:{}},Ni;us.exports=function(t){return Ni||(Ni=new Or(null)),Ni.generate(t)};function Or(e){this.rand=e}us.exports.Rand=Or;Or.prototype.generate=function(t){return this._rand(t)};Or.prototype._rand=function(t){if(this.rand.getBytes)return this.rand.getBytes(t);for(var a=new Uint8Array(t),r=0;r<a.length;r++)a[r]=this.rand.getByte();return a};if(typeof self=="object")self.crypto&&self.crypto.getRandomValues?Or.prototype._rand=function(t){var a=new Uint8Array(t);return self.crypto.getRandomValues(a),a}:self.msCrypto&&self.msCrypto.getRandomValues?Or.prototype._rand=function(t){var a=new Uint8Array(t);return self.msCrypto.getRandomValues(a),a}:typeof window=="object"&&(Or.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var qs=k0;if(typeof qs.randomBytes!="function")throw new Error("Not supported");Or.prototype._rand=function(t){return qs.randomBytes(t)}}catch{}var Uo=us.exports,ds={},Zr=Rr,na=zt,Ta=na.getNAF,Xu=na.getJSF,wa=na.assert;function Qr(e,t){this.type=e,this.p=new Zr(t.p,16),this.red=t.prime?Zr.red(t.prime):Zr.mont(this.p),this.zero=new Zr(0).toRed(this.red),this.one=new Zr(1).toRed(this.red),this.two=new Zr(2).toRed(this.red),this.n=t.n&&new Zr(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var a=this.n&&this.p.div(this.n);!a||a.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var Ha=Qr;Qr.prototype.point=function(){throw new Error("Not implemented")};Qr.prototype.validate=function(){throw new Error("Not implemented")};Qr.prototype._fixedNafMul=function(t,a){wa(t.precomputed);var r=t._getDoubles(),i=Ta(a,1,this._bitLength),n=(1<<r.step+1)-(r.step%2===0?2:1);n/=3;var s=[],f,u;for(f=0;f<i.length;f+=r.step){u=0;for(var o=f+r.step-1;o>=f;o--)u=(u<<1)+i[o];s.push(u)}for(var c=this.jpoint(null,null,null),l=this.jpoint(null,null,null),h=n;h>0;h--){for(f=0;f<s.length;f++)u=s[f],u===h?l=l.mixedAdd(r.points[f]):u===-h&&(l=l.mixedAdd(r.points[f].neg()));c=c.add(l)}return c.toP()};Qr.prototype._wnafMul=function(t,a){var r=4,i=t._getNAFPoints(r);r=i.wnd;for(var n=i.points,s=Ta(a,r,this._bitLength),f=this.jpoint(null,null,null),u=s.length-1;u>=0;u--){for(var o=0;u>=0&&s[u]===0;u--)o++;if(u>=0&&o++,f=f.dblp(o),u<0)break;var c=s[u];wa(c!==0),t.type==="affine"?c>0?f=f.mixedAdd(n[c-1>>1]):f=f.mixedAdd(n[-c-1>>1].neg()):c>0?f=f.add(n[c-1>>1]):f=f.add(n[-c-1>>1].neg())}return t.type==="affine"?f.toP():f};Qr.prototype._wnafMulAdd=function(t,a,r,i,n){var s=this._wnafT1,f=this._wnafT2,u=this._wnafT3,o=0,c,l,h;for(c=0;c<i;c++){h=a[c];var g=h._getNAFPoints(t);s[c]=g.wnd,f[c]=g.points}for(c=i-1;c>=1;c-=2){var v=c-1,y=c;if(s[v]!==1||s[y]!==1){u[v]=Ta(r[v],s[v],this._bitLength),u[y]=Ta(r[y],s[y],this._bitLength),o=Math.max(u[v].length,o),o=Math.max(u[y].length,o);continue}var b=[a[v],null,null,a[y]];a[v].y.cmp(a[y].y)===0?(b[1]=a[v].add(a[y]),b[2]=a[v].toJ().mixedAdd(a[y].neg())):a[v].y.cmp(a[y].y.redNeg())===0?(b[1]=a[v].toJ().mixedAdd(a[y]),b[2]=a[v].add(a[y].neg())):(b[1]=a[v].toJ().mixedAdd(a[y]),b[2]=a[v].toJ().mixedAdd(a[y].neg()));var I=[-3,-1,-5,-7,0,7,5,1,3],A=Xu(r[v],r[y]);for(o=Math.max(A[0].length,o),u[v]=new Array(o),u[y]=new Array(o),l=0;l<o;l++){var w=A[0][l]|0,N=A[1][l]|0;u[v][l]=I[(w+1)*3+(N+1)],u[y][l]=0,f[v]=b}}var k=this.jpoint(null,null,null),M=this._wnafT4;for(c=o;c>=0;c--){for(var V=0;c>=0;){var z=!0;for(l=0;l<i;l++)M[l]=u[l][c]|0,M[l]!==0&&(z=!1);if(!z)break;V++,c--}if(c>=0&&V++,k=k.dblp(V),c<0)break;for(l=0;l<i;l++){var W=M[l];W!==0&&(W>0?h=f[l][W-1>>1]:W<0&&(h=f[l][-W-1>>1].neg()),h.type==="affine"?k=k.mixedAdd(h):k=k.add(h))}}for(c=0;c<i;c++)f[c]=null;return n?k:k.toP()};function Yt(e,t){this.curve=e,this.type=t,this.precomputed=null}Qr.BasePoint=Yt;Yt.prototype.eq=function(){throw new Error("Not implemented")};Yt.prototype.validate=function(){return this.curve.validate(this)};Qr.prototype.decodePoint=function(t,a){t=na.toArray(t,a);var r=this.p.byteLength();if((t[0]===4||t[0]===6||t[0]===7)&&t.length-1===2*r){t[0]===6?wa(t[t.length-1]%2===0):t[0]===7&&wa(t[t.length-1]%2===1);var i=this.point(t.slice(1,1+r),t.slice(1+r,1+2*r));return i}else if((t[0]===2||t[0]===3)&&t.length-1===r)return this.pointFromX(t.slice(1,1+r),t[0]===3);throw new Error("Unknown point format")};Yt.prototype.encodeCompressed=function(t){return this.encode(t,!0)};Yt.prototype._encode=function(t){var a=this.curve.p.byteLength(),r=this.getX().toArray("be",a);return t?[this.getY().isEven()?2:3].concat(r):[4].concat(r,this.getY().toArray("be",a))};Yt.prototype.encode=function(t,a){return na.encode(this._encode(a),t)};Yt.prototype.precompute=function(t){if(this.precomputed)return this;var a={doubles:null,naf:null,beta:null};return a.naf=this._getNAFPoints(8),a.doubles=this._getDoubles(4,t),a.beta=this._getBeta(),this.precomputed=a,this};Yt.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var a=this.precomputed.doubles;return a?a.points.length>=Math.ceil((t.bitLength()+1)/a.step):!1};Yt.prototype._getDoubles=function(t,a){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var r=[this],i=this,n=0;n<a;n+=t){for(var s=0;s<t;s++)i=i.dbl();r.push(i)}return{step:t,points:r}};Yt.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var a=[this],r=(1<<t)-1,i=r===1?null:this.dbl(),n=1;n<r;n++)a[n]=a[n-1].add(i);return{wnd:t,points:a}};Yt.prototype._getBeta=function(){return null};Yt.prototype.dblp=function(t){for(var a=this,r=0;r<t;r++)a=a.dbl();return a};var Tn={exports:{}};typeof Object.create=="function"?Tn.exports=function(t,a){a&&(t.super_=a,t.prototype=Object.create(a.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Tn.exports=function(t,a){if(a){t.super_=a;var r=function(){};r.prototype=a.prototype,t.prototype=new r,t.prototype.constructor=t}};var za=Tn.exports,Yu=zt,ht=Rr,ls=za,M0=Ha,Zu=Yu.assert;function Zt(e){M0.call(this,"short",e),this.a=new ht(e.a,16).toRed(this.red),this.b=new ht(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}ls(Zt,M0);var Ju=Zt;Zt.prototype._getEndomorphism=function(t){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var a,r;if(t.beta)a=new ht(t.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);a=i[0].cmp(i[1])<0?i[0]:i[1],a=a.toRed(this.red)}if(t.lambda)r=new ht(t.lambda,16);else{var n=this._getEndoRoots(this.n);this.g.mul(n[0]).x.cmp(this.g.x.redMul(a))===0?r=n[0]:(r=n[1],Zu(this.g.mul(r).x.cmp(this.g.x.redMul(a))===0))}var s;return t.basis?s=t.basis.map(function(f){return{a:new ht(f.a,16),b:new ht(f.b,16)}}):s=this._getEndoBasis(r),{beta:a,lambda:r,basis:s}}};Zt.prototype._getEndoRoots=function(t){var a=t===this.p?this.red:ht.mont(t),r=new ht(2).toRed(a).redInvm(),i=r.redNeg(),n=new ht(3).toRed(a).redNeg().redSqrt().redMul(r),s=i.redAdd(n).fromRed(),f=i.redSub(n).fromRed();return[s,f]};Zt.prototype._getEndoBasis=function(t){for(var a=this.n.ushrn(Math.floor(this.n.bitLength()/2)),r=t,i=this.n.clone(),n=new ht(1),s=new ht(0),f=new ht(0),u=new ht(1),o,c,l,h,g,v,y,b=0,I,A;r.cmpn(0)!==0;){var w=i.div(r);I=i.sub(w.mul(r)),A=f.sub(w.mul(n));var N=u.sub(w.mul(s));if(!l&&I.cmp(a)<0)o=y.neg(),c=n,l=I.neg(),h=A;else if(l&&++b===2)break;y=I,i=r,r=I,f=n,n=A,u=s,s=N}g=I.neg(),v=A;var k=l.sqr().add(h.sqr()),M=g.sqr().add(v.sqr());return M.cmp(k)>=0&&(g=o,v=c),l.negative&&(l=l.neg(),h=h.neg()),g.negative&&(g=g.neg(),v=v.neg()),[{a:l,b:h},{a:g,b:v}]};Zt.prototype._endoSplit=function(t){var a=this.endo.basis,r=a[0],i=a[1],n=i.b.mul(t).divRound(this.n),s=r.b.neg().mul(t).divRound(this.n),f=n.mul(r.a),u=s.mul(i.a),o=n.mul(r.b),c=s.mul(i.b),l=t.sub(f).sub(u),h=o.add(c).neg();return{k1:l,k2:h}};Zt.prototype.pointFromX=function(t,a){t=new ht(t,16),t.red||(t=t.toRed(this.red));var r=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b),i=r.redSqrt();if(i.redSqr().redSub(r).cmp(this.zero)!==0)throw new Error("invalid point");var n=i.fromRed().isOdd();return(a&&!n||!a&&n)&&(i=i.redNeg()),this.point(t,i)};Zt.prototype.validate=function(t){if(t.inf)return!0;var a=t.x,r=t.y,i=this.a.redMul(a),n=a.redSqr().redMul(a).redIAdd(i).redIAdd(this.b);return r.redSqr().redISub(n).cmpn(0)===0};Zt.prototype._endoWnafMulAdd=function(t,a,r){for(var i=this._endoWnafT1,n=this._endoWnafT2,s=0;s<t.length;s++){var f=this._endoSplit(a[s]),u=t[s],o=u._getBeta();f.k1.negative&&(f.k1.ineg(),u=u.neg(!0)),f.k2.negative&&(f.k2.ineg(),o=o.neg(!0)),i[s*2]=u,i[s*2+1]=o,n[s*2]=f.k1,n[s*2+1]=f.k2}for(var c=this._wnafMulAdd(1,i,n,s*2,r),l=0;l<s*2;l++)i[l]=null,n[l]=null;return c};function _t(e,t,a,r){M0.BasePoint.call(this,e,"affine"),t===null&&a===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new ht(t,16),this.y=new ht(a,16),r&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}ls(_t,M0.BasePoint);Zt.prototype.point=function(t,a,r){return new _t(this,t,a,r)};Zt.prototype.pointFromJSON=function(t,a){return _t.fromJSON(this,t,a)};_t.prototype._getBeta=function(){if(this.curve.endo){var t=this.precomputed;if(t&&t.beta)return t.beta;var a=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){var r=this.curve,i=function(n){return r.point(n.x.redMul(r.endo.beta),n.y)};t.beta=a,a.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(i)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(i)}}}return a}};_t.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};_t.fromJSON=function(t,a,r){typeof a=="string"&&(a=JSON.parse(a));var i=t.point(a[0],a[1],r);if(!a[2])return i;function n(f){return t.point(f[0],f[1],r)}var s=a[2];return i.precomputed={beta:null,doubles:s.doubles&&{step:s.doubles.step,points:[i].concat(s.doubles.points.map(n))},naf:s.naf&&{wnd:s.naf.wnd,points:[i].concat(s.naf.points.map(n))}},i};_t.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};_t.prototype.isInfinity=function(){return this.inf};_t.prototype.add=function(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(this.x.cmp(t.x)===0)return this.curve.point(null,null);var a=this.y.redSub(t.y);a.cmpn(0)!==0&&(a=a.redMul(this.x.redSub(t.x).redInvm()));var r=a.redSqr().redISub(this.x).redISub(t.x),i=a.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,i)};_t.prototype.dbl=function(){if(this.inf)return this;var t=this.y.redAdd(this.y);if(t.cmpn(0)===0)return this.curve.point(null,null);var a=this.curve.a,r=this.x.redSqr(),i=t.redInvm(),n=r.redAdd(r).redIAdd(r).redIAdd(a).redMul(i),s=n.redSqr().redISub(this.x.redAdd(this.x)),f=n.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,f)};_t.prototype.getX=function(){return this.x.fromRed()};_t.prototype.getY=function(){return this.y.fromRed()};_t.prototype.mul=function(t){return t=new ht(t,16),this.isInfinity()?this:this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(this,t)};_t.prototype.mulAdd=function(t,a,r){var i=[this,a],n=[t,r];return this.curve.endo?this.curve._endoWnafMulAdd(i,n):this.curve._wnafMulAdd(1,i,n,2)};_t.prototype.jmulAdd=function(t,a,r){var i=[this,a],n=[t,r];return this.curve.endo?this.curve._endoWnafMulAdd(i,n,!0):this.curve._wnafMulAdd(1,i,n,2,!0)};_t.prototype.eq=function(t){return this===t||this.inf===t.inf&&(this.inf||this.x.cmp(t.x)===0&&this.y.cmp(t.y)===0)};_t.prototype.neg=function(t){if(this.inf)return this;var a=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){var r=this.precomputed,i=function(n){return n.neg()};a.precomputed={naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(i)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(i)}}}return a};_t.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var t=this.curve.jpoint(this.x,this.y,this.curve.one);return t};function Rt(e,t,a,r){M0.BasePoint.call(this,e,"jacobian"),t===null&&a===null&&r===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new ht(0)):(this.x=new ht(t,16),this.y=new ht(a,16),this.z=new ht(r,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}ls(Rt,M0.BasePoint);Zt.prototype.jpoint=function(t,a,r){return new Rt(this,t,a,r)};Rt.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var t=this.z.redInvm(),a=t.redSqr(),r=this.x.redMul(a),i=this.y.redMul(a).redMul(t);return this.curve.point(r,i)};Rt.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Rt.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var a=t.z.redSqr(),r=this.z.redSqr(),i=this.x.redMul(a),n=t.x.redMul(r),s=this.y.redMul(a.redMul(t.z)),f=t.y.redMul(r.redMul(this.z)),u=i.redSub(n),o=s.redSub(f);if(u.cmpn(0)===0)return o.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var c=u.redSqr(),l=c.redMul(u),h=i.redMul(c),g=o.redSqr().redIAdd(l).redISub(h).redISub(h),v=o.redMul(h.redISub(g)).redISub(s.redMul(l)),y=this.z.redMul(t.z).redMul(u);return this.curve.jpoint(g,v,y)};Rt.prototype.mixedAdd=function(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;var a=this.z.redSqr(),r=this.x,i=t.x.redMul(a),n=this.y,s=t.y.redMul(a).redMul(this.z),f=r.redSub(i),u=n.redSub(s);if(f.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var o=f.redSqr(),c=o.redMul(f),l=r.redMul(o),h=u.redSqr().redIAdd(c).redISub(l).redISub(l),g=u.redMul(l.redISub(h)).redISub(n.redMul(c)),v=this.z.redMul(f);return this.curve.jpoint(h,g,v)};Rt.prototype.dblp=function(t){if(t===0)return this;if(this.isInfinity())return this;if(!t)return this.dbl();var a;if(this.curve.zeroA||this.curve.threeA){var r=this;for(a=0;a<t;a++)r=r.dbl();return r}var i=this.curve.a,n=this.curve.tinv,s=this.x,f=this.y,u=this.z,o=u.redSqr().redSqr(),c=f.redAdd(f);for(a=0;a<t;a++){var l=s.redSqr(),h=c.redSqr(),g=h.redSqr(),v=l.redAdd(l).redIAdd(l).redIAdd(i.redMul(o)),y=s.redMul(h),b=v.redSqr().redISub(y.redAdd(y)),I=y.redISub(b),A=v.redMul(I);A=A.redIAdd(A).redISub(g);var w=c.redMul(u);a+1<t&&(o=o.redMul(g)),s=b,u=w,c=A}return this.curve.jpoint(s,c.redMul(n),u)};Rt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Rt.prototype._zeroDbl=function(){var t,a,r;if(this.zOne){var i=this.x.redSqr(),n=this.y.redSqr(),s=n.redSqr(),f=this.x.redAdd(n).redSqr().redISub(i).redISub(s);f=f.redIAdd(f);var u=i.redAdd(i).redIAdd(i),o=u.redSqr().redISub(f).redISub(f),c=s.redIAdd(s);c=c.redIAdd(c),c=c.redIAdd(c),t=o,a=u.redMul(f.redISub(o)).redISub(c),r=this.y.redAdd(this.y)}else{var l=this.x.redSqr(),h=this.y.redSqr(),g=h.redSqr(),v=this.x.redAdd(h).redSqr().redISub(l).redISub(g);v=v.redIAdd(v);var y=l.redAdd(l).redIAdd(l),b=y.redSqr(),I=g.redIAdd(g);I=I.redIAdd(I),I=I.redIAdd(I),t=b.redISub(v).redISub(v),a=y.redMul(v.redISub(t)).redISub(I),r=this.y.redMul(this.z),r=r.redIAdd(r)}return this.curve.jpoint(t,a,r)};Rt.prototype._threeDbl=function(){var t,a,r;if(this.zOne){var i=this.x.redSqr(),n=this.y.redSqr(),s=n.redSqr(),f=this.x.redAdd(n).redSqr().redISub(i).redISub(s);f=f.redIAdd(f);var u=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),o=u.redSqr().redISub(f).redISub(f);t=o;var c=s.redIAdd(s);c=c.redIAdd(c),c=c.redIAdd(c),a=u.redMul(f.redISub(o)).redISub(c),r=this.y.redAdd(this.y)}else{var l=this.z.redSqr(),h=this.y.redSqr(),g=this.x.redMul(h),v=this.x.redSub(l).redMul(this.x.redAdd(l));v=v.redAdd(v).redIAdd(v);var y=g.redIAdd(g);y=y.redIAdd(y);var b=y.redAdd(y);t=v.redSqr().redISub(b),r=this.y.redAdd(this.z).redSqr().redISub(h).redISub(l);var I=h.redSqr();I=I.redIAdd(I),I=I.redIAdd(I),I=I.redIAdd(I),a=v.redMul(y.redISub(t)).redISub(I)}return this.curve.jpoint(t,a,r)};Rt.prototype._dbl=function(){var t=this.curve.a,a=this.x,r=this.y,i=this.z,n=i.redSqr().redSqr(),s=a.redSqr(),f=r.redSqr(),u=s.redAdd(s).redIAdd(s).redIAdd(t.redMul(n)),o=a.redAdd(a);o=o.redIAdd(o);var c=o.redMul(f),l=u.redSqr().redISub(c.redAdd(c)),h=c.redISub(l),g=f.redSqr();g=g.redIAdd(g),g=g.redIAdd(g),g=g.redIAdd(g);var v=u.redMul(h).redISub(g),y=r.redAdd(r).redMul(i);return this.curve.jpoint(l,v,y)};Rt.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var t=this.x.redSqr(),a=this.y.redSqr(),r=this.z.redSqr(),i=a.redSqr(),n=t.redAdd(t).redIAdd(t),s=n.redSqr(),f=this.x.redAdd(a).redSqr().redISub(t).redISub(i);f=f.redIAdd(f),f=f.redAdd(f).redIAdd(f),f=f.redISub(s);var u=f.redSqr(),o=i.redIAdd(i);o=o.redIAdd(o),o=o.redIAdd(o),o=o.redIAdd(o);var c=n.redIAdd(f).redSqr().redISub(s).redISub(u).redISub(o),l=a.redMul(c);l=l.redIAdd(l),l=l.redIAdd(l);var h=this.x.redMul(u).redISub(l);h=h.redIAdd(h),h=h.redIAdd(h);var g=this.y.redMul(c.redMul(o.redISub(c)).redISub(f.redMul(u)));g=g.redIAdd(g),g=g.redIAdd(g),g=g.redIAdd(g);var v=this.z.redAdd(f).redSqr().redISub(r).redISub(u);return this.curve.jpoint(h,g,v)};Rt.prototype.mul=function(t,a){return t=new ht(t,a),this.curve._wnafMul(this,t)};Rt.prototype.eq=function(t){if(t.type==="affine")return this.eq(t.toJ());if(this===t)return!0;var a=this.z.redSqr(),r=t.z.redSqr();if(this.x.redMul(r).redISub(t.x.redMul(a)).cmpn(0)!==0)return!1;var i=a.redMul(this.z),n=r.redMul(t.z);return this.y.redMul(n).redISub(t.y.redMul(i)).cmpn(0)===0};Rt.prototype.eqXToP=function(t){var a=this.z.redSqr(),r=t.toRed(this.curve.red).redMul(a);if(this.x.cmp(r)===0)return!0;for(var i=t.clone(),n=this.curve.redN.redMul(a);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(n),this.x.cmp(r)===0)return!0}};Rt.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Rt.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var E0=Rr,Oo=za,Ga=Ha,ed=zt;function L0(e){Ga.call(this,"mont",e),this.a=new E0(e.a,16).toRed(this.red),this.b=new E0(e.b,16).toRed(this.red),this.i4=new E0(4).toRed(this.red).redInvm(),this.two=new E0(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}Oo(L0,Ga);var td=L0;L0.prototype.validate=function(t){var a=t.normalize().x,r=a.redSqr(),i=r.redMul(a).redAdd(r.redMul(this.a)).redAdd(a),n=i.redSqrt();return n.redSqr().cmp(i)===0};function Bt(e,t,a){Ga.BasePoint.call(this,e,"projective"),t===null&&a===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new E0(t,16),this.z=new E0(a,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}Oo(Bt,Ga.BasePoint);L0.prototype.decodePoint=function(t,a){return this.point(ed.toArray(t,a),1)};L0.prototype.point=function(t,a){return new Bt(this,t,a)};L0.prototype.pointFromJSON=function(t){return Bt.fromJSON(this,t)};Bt.prototype.precompute=function(){};Bt.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};Bt.fromJSON=function(t,a){return new Bt(t,a[0],a[1]||t.one)};Bt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Bt.prototype.isInfinity=function(){return this.z.cmpn(0)===0};Bt.prototype.dbl=function(){var t=this.x.redAdd(this.z),a=t.redSqr(),r=this.x.redSub(this.z),i=r.redSqr(),n=a.redSub(i),s=a.redMul(i),f=n.redMul(i.redAdd(this.curve.a24.redMul(n)));return this.curve.point(s,f)};Bt.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};Bt.prototype.diffAdd=function(t,a){var r=this.x.redAdd(this.z),i=this.x.redSub(this.z),n=t.x.redAdd(t.z),s=t.x.redSub(t.z),f=s.redMul(r),u=n.redMul(i),o=a.z.redMul(f.redAdd(u).redSqr()),c=a.x.redMul(f.redISub(u).redSqr());return this.curve.point(o,c)};Bt.prototype.mul=function(t){for(var a=t.clone(),r=this,i=this.curve.point(null,null),n=this,s=[];a.cmpn(0)!==0;a.iushrn(1))s.push(a.andln(1));for(var f=s.length-1;f>=0;f--)s[f]===0?(r=r.diffAdd(i,n),i=i.dbl()):(i=r.diffAdd(i,n),r=r.dbl());return i};Bt.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};Bt.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};Bt.prototype.eq=function(t){return this.getX().cmp(t.getX())===0};Bt.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};Bt.prototype.getX=function(){return this.normalize(),this.x.fromRed()};var rd=zt,_r=Rr,Vo=za,ja=Ha,ad=rd.assert;function mr(e){this.twisted=(e.a|0)!==1,this.mOneA=this.twisted&&(e.a|0)===-1,this.extended=this.mOneA,ja.call(this,"edwards",e),this.a=new _r(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new _r(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new _r(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),ad(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(e.c|0)===1}Vo(mr,ja);var id=mr;mr.prototype._mulA=function(t){return this.mOneA?t.redNeg():this.a.redMul(t)};mr.prototype._mulC=function(t){return this.oneC?t:this.c.redMul(t)};mr.prototype.jpoint=function(t,a,r,i){return this.point(t,a,r,i)};mr.prototype.pointFromX=function(t,a){t=new _r(t,16),t.red||(t=t.toRed(this.red));var r=t.redSqr(),i=this.c2.redSub(this.a.redMul(r)),n=this.one.redSub(this.c2.redMul(this.d).redMul(r)),s=i.redMul(n.redInvm()),f=s.redSqrt();if(f.redSqr().redSub(s).cmp(this.zero)!==0)throw new Error("invalid point");var u=f.fromRed().isOdd();return(a&&!u||!a&&u)&&(f=f.redNeg()),this.point(t,f)};mr.prototype.pointFromY=function(t,a){t=new _r(t,16),t.red||(t=t.toRed(this.red));var r=t.redSqr(),i=r.redSub(this.c2),n=r.redMul(this.d).redMul(this.c2).redSub(this.a),s=i.redMul(n.redInvm());if(s.cmp(this.zero)===0){if(a)throw new Error("invalid point");return this.point(this.zero,t)}var f=s.redSqrt();if(f.redSqr().redSub(s).cmp(this.zero)!==0)throw new Error("invalid point");return f.fromRed().isOdd()!==a&&(f=f.redNeg()),this.point(f,t)};mr.prototype.validate=function(t){if(t.isInfinity())return!0;t.normalize();var a=t.x.redSqr(),r=t.y.redSqr(),i=a.redMul(this.a).redAdd(r),n=this.c2.redMul(this.one.redAdd(this.d.redMul(a).redMul(r)));return i.cmp(n)===0};function qe(e,t,a,r,i){ja.BasePoint.call(this,e,"projective"),t===null&&a===null&&r===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new _r(t,16),this.y=new _r(a,16),this.z=r?new _r(r,16):this.curve.one,this.t=i&&new _r(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}Vo(qe,ja.BasePoint);mr.prototype.pointFromJSON=function(t){return qe.fromJSON(this,t)};mr.prototype.point=function(t,a,r,i){return new qe(this,t,a,r,i)};qe.fromJSON=function(t,a){return new qe(t,a[0],a[1],a[2])};qe.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};qe.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};qe.prototype._extDbl=function(){var t=this.x.redSqr(),a=this.y.redSqr(),r=this.z.redSqr();r=r.redIAdd(r);var i=this.curve._mulA(t),n=this.x.redAdd(this.y).redSqr().redISub(t).redISub(a),s=i.redAdd(a),f=s.redSub(r),u=i.redSub(a),o=n.redMul(f),c=s.redMul(u),l=n.redMul(u),h=f.redMul(s);return this.curve.point(o,c,h,l)};qe.prototype._projDbl=function(){var t=this.x.redAdd(this.y).redSqr(),a=this.x.redSqr(),r=this.y.redSqr(),i,n,s,f,u,o;if(this.curve.twisted){f=this.curve._mulA(a);var c=f.redAdd(r);this.zOne?(i=t.redSub(a).redSub(r).redMul(c.redSub(this.curve.two)),n=c.redMul(f.redSub(r)),s=c.redSqr().redSub(c).redSub(c)):(u=this.z.redSqr(),o=c.redSub(u).redISub(u),i=t.redSub(a).redISub(r).redMul(o),n=c.redMul(f.redSub(r)),s=c.redMul(o))}else f=a.redAdd(r),u=this.curve._mulC(this.z).redSqr(),o=f.redSub(u).redSub(u),i=this.curve._mulC(t.redISub(f)).redMul(o),n=this.curve._mulC(f).redMul(a.redISub(r)),s=f.redMul(o);return this.curve.point(i,n,s)};qe.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};qe.prototype._extAdd=function(t){var a=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),r=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),i=this.t.redMul(this.curve.dd).redMul(t.t),n=this.z.redMul(t.z.redAdd(t.z)),s=r.redSub(a),f=n.redSub(i),u=n.redAdd(i),o=r.redAdd(a),c=s.redMul(f),l=u.redMul(o),h=s.redMul(o),g=f.redMul(u);return this.curve.point(c,l,g,h)};qe.prototype._projAdd=function(t){var a=this.z.redMul(t.z),r=a.redSqr(),i=this.x.redMul(t.x),n=this.y.redMul(t.y),s=this.curve.d.redMul(i).redMul(n),f=r.redSub(s),u=r.redAdd(s),o=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(i).redISub(n),c=a.redMul(f).redMul(o),l,h;return this.curve.twisted?(l=a.redMul(u).redMul(n.redSub(this.curve._mulA(i))),h=f.redMul(u)):(l=a.redMul(u).redMul(n.redSub(i)),h=this.curve._mulC(f).redMul(u)),this.curve.point(c,l,h)};qe.prototype.add=function(t){return this.isInfinity()?t:t.isInfinity()?this:this.curve.extended?this._extAdd(t):this._projAdd(t)};qe.prototype.mul=function(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve._wnafMul(this,t)};qe.prototype.mulAdd=function(t,a,r){return this.curve._wnafMulAdd(1,[this,a],[t,r],2,!1)};qe.prototype.jmulAdd=function(t,a,r){return this.curve._wnafMulAdd(1,[this,a],[t,r],2,!0)};qe.prototype.normalize=function(){if(this.zOne)return this;var t=this.z.redInvm();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t&&(this.t=this.t.redMul(t)),this.z=this.curve.one,this.zOne=!0,this};qe.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};qe.prototype.getX=function(){return this.normalize(),this.x.fromRed()};qe.prototype.getY=function(){return this.normalize(),this.y.fromRed()};qe.prototype.eq=function(t){return this===t||this.getX().cmp(t.getX())===0&&this.getY().cmp(t.getY())===0};qe.prototype.eqXToP=function(t){var a=t.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(a)===0)return!0;for(var r=t.clone(),i=this.curve.redN.redMul(this.z);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(a.redIAdd(i),this.x.cmp(a)===0)return!0}};qe.prototype.toP=qe.prototype.normalize;qe.prototype.mixedAdd=qe.prototype.add;(function(e){var t=e;t.base=Ha,t.short=Ju,t.mont=td,t.edwards=id})(ds);var $a={},Wa={},Be={},nd=l0,sd=za;Be.inherits=sd;function fd(e,t){return(e.charCodeAt(t)&64512)!==55296||t<0||t+1>=e.length?!1:(e.charCodeAt(t+1)&64512)===56320}function od(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var a=[];if(typeof e=="string")if(t){if(t==="hex")for(e=e.replace(/[^a-z0-9]+/ig,""),e.length%2!==0&&(e="0"+e),i=0;i<e.length;i+=2)a.push(parseInt(e[i]+e[i+1],16))}else for(var r=0,i=0;i<e.length;i++){var n=e.charCodeAt(i);n<128?a[r++]=n:n<2048?(a[r++]=n>>6|192,a[r++]=n&63|128):fd(e,i)?(n=65536+((n&1023)<<10)+(e.charCodeAt(++i)&1023),a[r++]=n>>18|240,a[r++]=n>>12&63|128,a[r++]=n>>6&63|128,a[r++]=n&63|128):(a[r++]=n>>12|224,a[r++]=n>>6&63|128,a[r++]=n&63|128)}else for(i=0;i<e.length;i++)a[i]=e[i]|0;return a}Be.toArray=od;function cd(e){for(var t="",a=0;a<e.length;a++)t+=qo(e[a].toString(16));return t}Be.toHex=cd;function Ko(e){var t=e>>>24|e>>>8&65280|e<<8&16711680|(e&255)<<24;return t>>>0}Be.htonl=Ko;function ud(e,t){for(var a="",r=0;r<e.length;r++){var i=e[r];t==="little"&&(i=Ko(i)),a+=Ho(i.toString(16))}return a}Be.toHex32=ud;function qo(e){return e.length===1?"0"+e:e}Be.zero2=qo;function Ho(e){return e.length===7?"0"+e:e.length===6?"00"+e:e.length===5?"000"+e:e.length===4?"0000"+e:e.length===3?"00000"+e:e.length===2?"000000"+e:e.length===1?"0000000"+e:e}Be.zero8=Ho;function dd(e,t,a,r){var i=a-t;nd(i%4===0);for(var n=new Array(i/4),s=0,f=t;s<n.length;s++,f+=4){var u;r==="big"?u=e[f]<<24|e[f+1]<<16|e[f+2]<<8|e[f+3]:u=e[f+3]<<24|e[f+2]<<16|e[f+1]<<8|e[f],n[s]=u>>>0}return n}Be.join32=dd;function ld(e,t){for(var a=new Array(e.length*4),r=0,i=0;r<e.length;r++,i+=4){var n=e[r];t==="big"?(a[i]=n>>>24,a[i+1]=n>>>16&255,a[i+2]=n>>>8&255,a[i+3]=n&255):(a[i+3]=n>>>24,a[i+2]=n>>>16&255,a[i+1]=n>>>8&255,a[i]=n&255)}return a}Be.split32=ld;function hd(e,t){return e>>>t|e<<32-t}Be.rotr32=hd;function vd(e,t){return e<<t|e>>>32-t}Be.rotl32=vd;function pd(e,t){return e+t>>>0}Be.sum32=pd;function xd(e,t,a){return e+t+a>>>0}Be.sum32_3=xd;function gd(e,t,a,r){return e+t+a+r>>>0}Be.sum32_4=gd;function yd(e,t,a,r,i){return e+t+a+r+i>>>0}Be.sum32_5=yd;function bd(e,t,a,r){var i=e[t],n=e[t+1],s=r+n>>>0,f=(s<r?1:0)+a+i;e[t]=f>>>0,e[t+1]=s}Be.sum64=bd;function md(e,t,a,r){var i=t+r>>>0,n=(i<t?1:0)+e+a;return n>>>0}Be.sum64_hi=md;function Cd(e,t,a,r){var i=t+r;return i>>>0}Be.sum64_lo=Cd;function Ed(e,t,a,r,i,n,s,f){var u=0,o=t;o=o+r>>>0,u+=o<t?1:0,o=o+n>>>0,u+=o<n?1:0,o=o+f>>>0,u+=o<f?1:0;var c=e+a+i+s+u;return c>>>0}Be.sum64_4_hi=Ed;function Ad(e,t,a,r,i,n,s,f){var u=t+r+n+f;return u>>>0}Be.sum64_4_lo=Ad;function Sd(e,t,a,r,i,n,s,f,u,o){var c=0,l=t;l=l+r>>>0,c+=l<t?1:0,l=l+n>>>0,c+=l<n?1:0,l=l+f>>>0,c+=l<f?1:0,l=l+o>>>0,c+=l<o?1:0;var h=e+a+i+s+u+c;return h>>>0}Be.sum64_5_hi=Sd;function Bd(e,t,a,r,i,n,s,f,u,o){var c=t+r+n+f+o;return c>>>0}Be.sum64_5_lo=Bd;function _d(e,t,a){var r=t<<32-a|e>>>a;return r>>>0}Be.rotr64_hi=_d;function Id(e,t,a){var r=e<<32-a|t>>>a;return r>>>0}Be.rotr64_lo=Id;function Td(e,t,a){return e>>>a}Be.shr64_hi=Td;function wd(e,t,a){var r=e<<32-a|t>>>a;return r>>>0}Be.shr64_lo=wd;var P0={},Hs=Be,Dd=l0;function Qa(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}P0.BlockHash=Qa;Qa.prototype.update=function(t,a){if(t=Hs.toArray(t,a),this.pending?this.pending=this.pending.concat(t):this.pending=t,this.pendingTotal+=t.length,this.pending.length>=this._delta8){t=this.pending;var r=t.length%this._delta8;this.pending=t.slice(t.length-r,t.length),this.pending.length===0&&(this.pending=null),t=Hs.join32(t,0,t.length-r,this.endian);for(var i=0;i<t.length;i+=this._delta32)this._update(t,i,i+this._delta32)}return this};Qa.prototype.digest=function(t){return this.update(this._pad()),Dd(this.pending===null),this._digest(t)};Qa.prototype._pad=function(){var t=this.pendingTotal,a=this._delta8,r=a-(t+this.padLength)%a,i=new Array(r+this.padLength);i[0]=128;for(var n=1;n<r;n++)i[n]=0;if(t<<=3,this.endian==="big"){for(var s=8;s<this.padLength;s++)i[n++]=0;i[n++]=0,i[n++]=0,i[n++]=0,i[n++]=0,i[n++]=t>>>24&255,i[n++]=t>>>16&255,i[n++]=t>>>8&255,i[n++]=t&255}else for(i[n++]=t&255,i[n++]=t>>>8&255,i[n++]=t>>>16&255,i[n++]=t>>>24&255,i[n++]=0,i[n++]=0,i[n++]=0,i[n++]=0,s=8;s<this.padLength;s++)i[n++]=0;return i};var U0={},Cr={},Nd=Be,vr=Nd.rotr32;function Rd(e,t,a,r){if(e===0)return zo(t,a,r);if(e===1||e===3)return jo(t,a,r);if(e===2)return Go(t,a,r)}Cr.ft_1=Rd;function zo(e,t,a){return e&t^~e&a}Cr.ch32=zo;function Go(e,t,a){return e&t^e&a^t&a}Cr.maj32=Go;function jo(e,t,a){return e^t^a}Cr.p32=jo;function Fd(e){return vr(e,2)^vr(e,13)^vr(e,22)}Cr.s0_256=Fd;function kd(e){return vr(e,6)^vr(e,11)^vr(e,25)}Cr.s1_256=kd;function Md(e){return vr(e,7)^vr(e,18)^e>>>3}Cr.g0_256=Md;function Ld(e){return vr(e,17)^vr(e,19)^e>>>10}Cr.g1_256=Ld;var _0=Be,Pd=P0,Ud=Cr,Ri=_0.rotl32,W0=_0.sum32,Od=_0.sum32_5,Vd=Ud.ft_1,$o=Pd.BlockHash,Kd=[1518500249,1859775393,2400959708,3395469782];function gr(){if(!(this instanceof gr))return new gr;$o.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}_0.inherits(gr,$o);var qd=gr;gr.blockSize=512;gr.outSize=160;gr.hmacStrength=80;gr.padLength=64;gr.prototype._update=function(t,a){for(var r=this.W,i=0;i<16;i++)r[i]=t[a+i];for(;i<r.length;i++)r[i]=Ri(r[i-3]^r[i-8]^r[i-14]^r[i-16],1);var n=this.h[0],s=this.h[1],f=this.h[2],u=this.h[3],o=this.h[4];for(i=0;i<r.length;i++){var c=~~(i/20),l=Od(Ri(n,5),Vd(c,s,f,u),o,r[i],Kd[c]);o=u,u=f,f=Ri(s,30),s=n,n=l}this.h[0]=W0(this.h[0],n),this.h[1]=W0(this.h[1],s),this.h[2]=W0(this.h[2],f),this.h[3]=W0(this.h[3],u),this.h[4]=W0(this.h[4],o)};gr.prototype._digest=function(t){return t==="hex"?_0.toHex32(this.h,"big"):_0.split32(this.h,"big")};var I0=Be,Hd=P0,O0=Cr,zd=l0,tr=I0.sum32,Gd=I0.sum32_4,jd=I0.sum32_5,$d=O0.ch32,Wd=O0.maj32,Qd=O0.s0_256,Xd=O0.s1_256,Yd=O0.g0_256,Zd=O0.g1_256,Wo=Hd.BlockHash,Jd=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function yr(){if(!(this instanceof yr))return new yr;Wo.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=Jd,this.W=new Array(64)}I0.inherits(yr,Wo);var Qo=yr;yr.blockSize=512;yr.outSize=256;yr.hmacStrength=192;yr.padLength=64;yr.prototype._update=function(t,a){for(var r=this.W,i=0;i<16;i++)r[i]=t[a+i];for(;i<r.length;i++)r[i]=Gd(Zd(r[i-2]),r[i-7],Yd(r[i-15]),r[i-16]);var n=this.h[0],s=this.h[1],f=this.h[2],u=this.h[3],o=this.h[4],c=this.h[5],l=this.h[6],h=this.h[7];for(zd(this.k.length===r.length),i=0;i<r.length;i++){var g=jd(h,Xd(o),$d(o,c,l),this.k[i],r[i]),v=tr(Qd(n),Wd(n,s,f));h=l,l=c,c=o,o=tr(u,g),u=f,f=s,s=n,n=tr(g,v)}this.h[0]=tr(this.h[0],n),this.h[1]=tr(this.h[1],s),this.h[2]=tr(this.h[2],f),this.h[3]=tr(this.h[3],u),this.h[4]=tr(this.h[4],o),this.h[5]=tr(this.h[5],c),this.h[6]=tr(this.h[6],l),this.h[7]=tr(this.h[7],h)};yr.prototype._digest=function(t){return t==="hex"?I0.toHex32(this.h,"big"):I0.split32(this.h,"big")};var wn=Be,Xo=Qo;function Dr(){if(!(this instanceof Dr))return new Dr;Xo.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}wn.inherits(Dr,Xo);var el=Dr;Dr.blockSize=512;Dr.outSize=224;Dr.hmacStrength=192;Dr.padLength=64;Dr.prototype._digest=function(t){return t==="hex"?wn.toHex32(this.h.slice(0,7),"big"):wn.split32(this.h.slice(0,7),"big")};var Ot=Be,tl=P0,rl=l0,pr=Ot.rotr64_hi,xr=Ot.rotr64_lo,Yo=Ot.shr64_hi,Zo=Ot.shr64_lo,Mr=Ot.sum64,Fi=Ot.sum64_hi,ki=Ot.sum64_lo,al=Ot.sum64_4_hi,il=Ot.sum64_4_lo,nl=Ot.sum64_5_hi,sl=Ot.sum64_5_lo,Jo=tl.BlockHash,fl=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function nr(){if(!(this instanceof nr))return new nr;Jo.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=fl,this.W=new Array(160)}Ot.inherits(nr,Jo);var ec=nr;nr.blockSize=1024;nr.outSize=512;nr.hmacStrength=192;nr.padLength=128;nr.prototype._prepareBlock=function(t,a){for(var r=this.W,i=0;i<32;i++)r[i]=t[a+i];for(;i<r.length;i+=2){var n=yl(r[i-4],r[i-3]),s=bl(r[i-4],r[i-3]),f=r[i-14],u=r[i-13],o=xl(r[i-30],r[i-29]),c=gl(r[i-30],r[i-29]),l=r[i-32],h=r[i-31];r[i]=al(n,s,f,u,o,c,l,h),r[i+1]=il(n,s,f,u,o,c,l,h)}};nr.prototype._update=function(t,a){this._prepareBlock(t,a);var r=this.W,i=this.h[0],n=this.h[1],s=this.h[2],f=this.h[3],u=this.h[4],o=this.h[5],c=this.h[6],l=this.h[7],h=this.h[8],g=this.h[9],v=this.h[10],y=this.h[11],b=this.h[12],I=this.h[13],A=this.h[14],w=this.h[15];rl(this.k.length===r.length);for(var N=0;N<r.length;N+=2){var k=A,M=w,V=vl(h,g),z=pl(h,g),W=ol(h,g,v,y,b),U=cl(h,g,v,y,b,I),C=this.k[N],d=this.k[N+1],x=r[N],m=r[N+1],S=nl(k,M,V,z,W,U,C,d,x,m),D=sl(k,M,V,z,W,U,C,d,x,m);k=ll(i,n),M=hl(i,n),V=ul(i,n,s,f,u),z=dl(i,n,s,f,u,o);var F=Fi(k,M,V,z),P=ki(k,M,V,z);A=b,w=I,b=v,I=y,v=h,y=g,h=Fi(c,l,S,D),g=ki(l,l,S,D),c=u,l=o,u=s,o=f,s=i,f=n,i=Fi(S,D,F,P),n=ki(S,D,F,P)}Mr(this.h,0,i,n),Mr(this.h,2,s,f),Mr(this.h,4,u,o),Mr(this.h,6,c,l),Mr(this.h,8,h,g),Mr(this.h,10,v,y),Mr(this.h,12,b,I),Mr(this.h,14,A,w)};nr.prototype._digest=function(t){return t==="hex"?Ot.toHex32(this.h,"big"):Ot.split32(this.h,"big")};function ol(e,t,a,r,i){var n=e&a^~e&i;return n<0&&(n+=4294967296),n}function cl(e,t,a,r,i,n){var s=t&r^~t&n;return s<0&&(s+=4294967296),s}function ul(e,t,a,r,i){var n=e&a^e&i^a&i;return n<0&&(n+=4294967296),n}function dl(e,t,a,r,i,n){var s=t&r^t&n^r&n;return s<0&&(s+=4294967296),s}function ll(e,t){var a=pr(e,t,28),r=pr(t,e,2),i=pr(t,e,7),n=a^r^i;return n<0&&(n+=4294967296),n}function hl(e,t){var a=xr(e,t,28),r=xr(t,e,2),i=xr(t,e,7),n=a^r^i;return n<0&&(n+=4294967296),n}function vl(e,t){var a=pr(e,t,14),r=pr(e,t,18),i=pr(t,e,9),n=a^r^i;return n<0&&(n+=4294967296),n}function pl(e,t){var a=xr(e,t,14),r=xr(e,t,18),i=xr(t,e,9),n=a^r^i;return n<0&&(n+=4294967296),n}function xl(e,t){var a=pr(e,t,1),r=pr(e,t,8),i=Yo(e,t,7),n=a^r^i;return n<0&&(n+=4294967296),n}function gl(e,t){var a=xr(e,t,1),r=xr(e,t,8),i=Zo(e,t,7),n=a^r^i;return n<0&&(n+=4294967296),n}function yl(e,t){var a=pr(e,t,19),r=pr(t,e,29),i=Yo(e,t,6),n=a^r^i;return n<0&&(n+=4294967296),n}function bl(e,t){var a=xr(e,t,19),r=xr(t,e,29),i=Zo(e,t,6),n=a^r^i;return n<0&&(n+=4294967296),n}var Dn=Be,tc=ec;function Nr(){if(!(this instanceof Nr))return new Nr;tc.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}Dn.inherits(Nr,tc);var ml=Nr;Nr.blockSize=1024;Nr.outSize=384;Nr.hmacStrength=192;Nr.padLength=128;Nr.prototype._digest=function(t){return t==="hex"?Dn.toHex32(this.h.slice(0,12),"big"):Dn.split32(this.h.slice(0,12),"big")};U0.sha1=qd;U0.sha224=el;U0.sha256=Qo;U0.sha384=ml;U0.sha512=ec;var rc={},d0=Be,Cl=P0,va=d0.rotl32,zs=d0.sum32,Q0=d0.sum32_3,Gs=d0.sum32_4,ac=Cl.BlockHash;function br(){if(!(this instanceof br))return new br;ac.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}d0.inherits(br,ac);rc.ripemd160=br;br.blockSize=512;br.outSize=160;br.hmacStrength=192;br.padLength=64;br.prototype._update=function(t,a){for(var r=this.h[0],i=this.h[1],n=this.h[2],s=this.h[3],f=this.h[4],u=r,o=i,c=n,l=s,h=f,g=0;g<80;g++){var v=zs(va(Gs(r,js(g,i,n,s),t[Sl[g]+a],El(g)),_l[g]),f);r=f,f=s,s=va(n,10),n=i,i=v,v=zs(va(Gs(u,js(79-g,o,c,l),t[Bl[g]+a],Al(g)),Il[g]),h),u=h,h=l,l=va(c,10),c=o,o=v}v=Q0(this.h[1],n,l),this.h[1]=Q0(this.h[2],s,h),this.h[2]=Q0(this.h[3],f,u),this.h[3]=Q0(this.h[4],r,o),this.h[4]=Q0(this.h[0],i,c),this.h[0]=v};br.prototype._digest=function(t){return t==="hex"?d0.toHex32(this.h,"little"):d0.split32(this.h,"little")};function js(e,t,a,r){return e<=15?t^a^r:e<=31?t&a|~t&r:e<=47?(t|~a)^r:e<=63?t&r|a&~r:t^(a|~r)}function El(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function Al(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}var Sl=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],Bl=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],_l=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],Il=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],Tl=Be,wl=l0;function T0(e,t,a){if(!(this instanceof T0))return new T0(e,t,a);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(Tl.toArray(t,a))}var Dl=T0;T0.prototype._init=function(t){t.length>this.blockSize&&(t=new this.Hash().update(t).digest()),wl(t.length<=this.blockSize);for(var a=t.length;a<this.blockSize;a++)t.push(0);for(a=0;a<t.length;a++)t[a]^=54;for(this.inner=new this.Hash().update(t),a=0;a<t.length;a++)t[a]^=106;this.outer=new this.Hash().update(t)};T0.prototype.update=function(t,a){return this.inner.update(t,a),this};T0.prototype.digest=function(t){return this.outer.update(this.inner.digest()),this.outer.digest(t)};(function(e){var t=e;t.utils=Be,t.common=P0,t.sha=U0,t.ripemd=rc,t.hmac=Dl,t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160})(Wa);var Mi,$s;function Nl(){return $s||($s=1,Mi={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),Mi}(function(e){var t=e,a=Wa,r=ds,i=zt,n=i.assert;function s(o){o.type==="short"?this.curve=new r.short(o):o.type==="edwards"?this.curve=new r.edwards(o):this.curve=new r.mont(o),this.g=this.curve.g,this.n=this.curve.n,this.hash=o.hash,n(this.g.validate(),"Invalid curve"),n(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}t.PresetCurve=s;function f(o,c){Object.defineProperty(t,o,{configurable:!0,enumerable:!0,get:function(){var l=new s(c);return Object.defineProperty(t,o,{configurable:!0,enumerable:!0,value:l}),l}})}f("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:a.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),f("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:a.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),f("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:a.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),f("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:a.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),f("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:a.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),f("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:a.sha256,gRed:!1,g:["9"]}),f("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:a.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var u;try{u=Nl()}catch{u=void 0}f("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:a.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",u]})})($a);var Rl=Wa,o0=cs,ic=l0;function jr(e){if(!(this instanceof jr))return new jr(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=o0.toArray(e.entropy,e.entropyEnc||"hex"),a=o0.toArray(e.nonce,e.nonceEnc||"hex"),r=o0.toArray(e.pers,e.persEnc||"hex");ic(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,a,r)}var Fl=jr;jr.prototype._init=function(t,a,r){var i=t.concat(a).concat(r);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var n=0;n<this.V.length;n++)this.K[n]=0,this.V[n]=1;this._update(i),this._reseed=1,this.reseedInterval=281474976710656};jr.prototype._hmac=function(){return new Rl.hmac(this.hash,this.K)};jr.prototype._update=function(t){var a=this._hmac().update(this.V).update([0]);t&&(a=a.update(t)),this.K=a.digest(),this.V=this._hmac().update(this.V).digest(),t&&(this.K=this._hmac().update(this.V).update([1]).update(t).digest(),this.V=this._hmac().update(this.V).digest())};jr.prototype.reseed=function(t,a,r,i){typeof a!="string"&&(i=r,r=a,a=null),t=o0.toArray(t,a),r=o0.toArray(r,i),ic(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(t.concat(r||[])),this._reseed=1};jr.prototype.generate=function(t,a,r,i){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof a!="string"&&(i=r,r=a,a=null),r&&(r=o0.toArray(r,i||"hex"),this._update(r));for(var n=[];n.length<t;)this.V=this._hmac().update(this.V).digest(),n=n.concat(this.V);var s=n.slice(0,t);return this._update(r),this._reseed++,o0.encode(s,a)};var kl=Rr,Ml=zt,Nn=Ml.assert;function Ft(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}var Ll=Ft;Ft.fromPublic=function(t,a,r){return a instanceof Ft?a:new Ft(t,{pub:a,pubEnc:r})};Ft.fromPrivate=function(t,a,r){return a instanceof Ft?a:new Ft(t,{priv:a,privEnc:r})};Ft.prototype.validate=function(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};Ft.prototype.getPublic=function(t,a){return typeof t=="string"&&(a=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),a?this.pub.encode(a,t):this.pub};Ft.prototype.getPrivate=function(t){return t==="hex"?this.priv.toString(16,2):this.priv};Ft.prototype._importPrivate=function(t,a){this.priv=new kl(t,a||16),this.priv=this.priv.umod(this.ec.curve.n)};Ft.prototype._importPublic=function(t,a){if(t.x||t.y){this.ec.curve.type==="mont"?Nn(t.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&Nn(t.x&&t.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(t.x,t.y);return}this.pub=this.ec.curve.decodePoint(t,a)};Ft.prototype.derive=function(t){return t.validate()||Nn(t.validate(),"public point not validated"),t.mul(this.priv).getX()};Ft.prototype.sign=function(t,a,r){return this.ec.sign(t,this,a,r)};Ft.prototype.verify=function(t,a,r){return this.ec.verify(t,a,this,void 0,r)};Ft.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var Da=Rr,hs=zt,Pl=hs.assert;function Xa(e,t){if(e instanceof Xa)return e;this._importDER(e,t)||(Pl(e.r&&e.s,"Signature without r or s"),this.r=new Da(e.r,16),this.s=new Da(e.s,16),e.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}var Ul=Xa;function Ol(){this.place=0}function Li(e,t){var a=e[t.place++];if(!(a&128))return a;var r=a&15;if(r===0||r>4||e[t.place]===0)return!1;for(var i=0,n=0,s=t.place;n<r;n++,s++)i<<=8,i|=e[s],i>>>=0;return i<=127?!1:(t.place=s,i)}function Ws(e){for(var t=0,a=e.length-1;!e[t]&&!(e[t+1]&128)&&t<a;)t++;return t===0?e:e.slice(t)}Xa.prototype._importDER=function(t,a){t=hs.toArray(t,a);var r=new Ol;if(t[r.place++]!==48)return!1;var i=Li(t,r);if(i===!1||i+r.place!==t.length||t[r.place++]!==2)return!1;var n=Li(t,r);if(n===!1||t[r.place]&128)return!1;var s=t.slice(r.place,n+r.place);if(r.place+=n,t[r.place++]!==2)return!1;var f=Li(t,r);if(f===!1||t.length!==f+r.place||t[r.place]&128)return!1;var u=t.slice(r.place,f+r.place);if(s[0]===0)if(s[1]&128)s=s.slice(1);else return!1;if(u[0]===0)if(u[1]&128)u=u.slice(1);else return!1;return this.r=new Da(s),this.s=new Da(u),this.recoveryParam=null,!0};function Pi(e,t){if(t<128){e.push(t);return}var a=1+(Math.log(t)/Math.LN2>>>3);for(e.push(a|128);--a;)e.push(t>>>(a<<3)&255);e.push(t)}Xa.prototype.toDER=function(t){var a=this.r.toArray(),r=this.s.toArray();for(a[0]&128&&(a=[0].concat(a)),r[0]&128&&(r=[0].concat(r)),a=Ws(a),r=Ws(r);!r[0]&&!(r[1]&128);)r=r.slice(1);var i=[2];Pi(i,a.length),i=i.concat(a),i.push(2),Pi(i,r.length);var n=i.concat(r),s=[48];return Pi(s,n.length),s=s.concat(n),hs.encode(s,t)};var ar=Rr,nc=Fl,Vl=zt,Ui=$a,Kl=Uo,t0=Vl.assert,vs=Ll,Ya=Ul;function Xt(e){if(!(this instanceof Xt))return new Xt(e);typeof e=="string"&&(t0(Object.prototype.hasOwnProperty.call(Ui,e),"Unknown curve "+e),e=Ui[e]),e instanceof Ui.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}var ql=Xt;Xt.prototype.keyPair=function(t){return new vs(this,t)};Xt.prototype.keyFromPrivate=function(t,a){return vs.fromPrivate(this,t,a)};Xt.prototype.keyFromPublic=function(t,a){return vs.fromPublic(this,t,a)};Xt.prototype.genKeyPair=function(t){t||(t={});for(var a=new nc({hash:this.hash,pers:t.pers,persEnc:t.persEnc||"utf8",entropy:t.entropy||Kl(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||"utf8",nonce:this.n.toArray()}),r=this.n.byteLength(),i=this.n.sub(new ar(2));;){var n=new ar(a.generate(r));if(!(n.cmp(i)>0))return n.iaddn(1),this.keyFromPrivate(n)}};Xt.prototype._truncateToN=function(t,a,r){var i;if(ar.isBN(t)||typeof t=="number")t=new ar(t,16),i=t.byteLength();else if(typeof t=="object")i=t.length,t=new ar(t,16);else{var n=t.toString();i=n.length+1>>>1,t=new ar(n,16)}typeof r!="number"&&(r=i*8);var s=r-this.n.bitLength();return s>0&&(t=t.ushrn(s)),!a&&t.cmp(this.n)>=0?t.sub(this.n):t};Xt.prototype.sign=function(t,a,r,i){if(typeof r=="object"&&(i=r,r=null),i||(i={}),typeof t!="string"&&typeof t!="number"&&!ar.isBN(t)){t0(typeof t=="object"&&t&&typeof t.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),t0(t.length>>>0===t.length);for(var n=0;n<t.length;n++)t0((t[n]&255)===t[n])}a=this.keyFromPrivate(a,r),t=this._truncateToN(t,!1,i.msgBitLength),t0(!t.isNeg(),"Can not sign a negative message");var s=this.n.byteLength(),f=a.getPrivate().toArray("be",s),u=t.toArray("be",s);t0(new ar(u).eq(t),"Can not sign message");for(var o=new nc({hash:this.hash,entropy:f,nonce:u,pers:i.pers,persEnc:i.persEnc||"utf8"}),c=this.n.sub(new ar(1)),l=0;;l++){var h=i.k?i.k(l):new ar(o.generate(this.n.byteLength()));if(h=this._truncateToN(h,!0),!(h.cmpn(1)<=0||h.cmp(c)>=0)){var g=this.g.mul(h);if(!g.isInfinity()){var v=g.getX(),y=v.umod(this.n);if(y.cmpn(0)!==0){var b=h.invm(this.n).mul(y.mul(a.getPrivate()).iadd(t));if(b=b.umod(this.n),b.cmpn(0)!==0){var I=(g.getY().isOdd()?1:0)|(v.cmp(y)!==0?2:0);return i.canonical&&b.cmp(this.nh)>0&&(b=this.n.sub(b),I^=1),new Ya({r:y,s:b,recoveryParam:I})}}}}}};Xt.prototype.verify=function(t,a,r,i,n){n||(n={}),t=this._truncateToN(t,!1,n.msgBitLength),r=this.keyFromPublic(r,i),a=new Ya(a,"hex");var s=a.r,f=a.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||f.cmpn(1)<0||f.cmp(this.n)>=0)return!1;var u=f.invm(this.n),o=u.mul(t).umod(this.n),c=u.mul(s).umod(this.n),l;return this.curve._maxwellTrick?(l=this.g.jmulAdd(o,r.getPublic(),c),l.isInfinity()?!1:l.eqXToP(s)):(l=this.g.mulAdd(o,r.getPublic(),c),l.isInfinity()?!1:l.getX().umod(this.n).cmp(s)===0)};Xt.prototype.recoverPubKey=function(e,t,a,r){t0((3&a)===a,"The recovery param is more than two bits"),t=new Ya(t,r);var i=this.n,n=new ar(e),s=t.r,f=t.s,u=a&1,o=a>>1;if(s.cmp(this.curve.p.umod(this.curve.n))>=0&&o)throw new Error("Unable to find sencond key candinate");o?s=this.curve.pointFromX(s.add(this.curve.n),u):s=this.curve.pointFromX(s,u);var c=t.r.invm(i),l=i.sub(n).mul(c).umod(i),h=f.mul(c).umod(i);return this.g.mulAdd(l,s,h)};Xt.prototype.getKeyRecoveryParam=function(e,t,a,r){if(t=new Ya(t,r),t.recoveryParam!==null)return t.recoveryParam;for(var i=0;i<4;i++){var n;try{n=this.recoverPubKey(e,t,i)}catch{continue}if(n.eq(a))return i}throw new Error("Unable to find valid recovery factor")};var sa=zt,sc=sa.assert,Qs=sa.parseBytes,V0=sa.cachedProperty;function At(e,t){this.eddsa=e,this._secret=Qs(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=Qs(t.pub)}At.fromPublic=function(t,a){return a instanceof At?a:new At(t,{pub:a})};At.fromSecret=function(t,a){return a instanceof At?a:new At(t,{secret:a})};At.prototype.secret=function(){return this._secret};V0(At,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});V0(At,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});V0(At,"privBytes",function(){var t=this.eddsa,a=this.hash(),r=t.encodingLength-1,i=a.slice(0,t.encodingLength);return i[0]&=248,i[r]&=127,i[r]|=64,i});V0(At,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});V0(At,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});V0(At,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});At.prototype.sign=function(t){return sc(this._secret,"KeyPair can only verify"),this.eddsa.sign(t,this)};At.prototype.verify=function(t,a){return this.eddsa.verify(t,a,this)};At.prototype.getSecret=function(t){return sc(this._secret,"KeyPair is public only"),sa.encode(this.secret(),t)};At.prototype.getPublic=function(t){return sa.encode(this.pubBytes(),t)};var Hl=At,zl=Rr,Za=zt,Xs=Za.assert,Ja=Za.cachedProperty,Gl=Za.parseBytes;function h0(e,t){this.eddsa=e,typeof t!="object"&&(t=Gl(t)),Array.isArray(t)&&(Xs(t.length===e.encodingLength*2,"Signature has invalid size"),t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),Xs(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof zl&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}Ja(h0,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});Ja(h0,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});Ja(h0,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});Ja(h0,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});h0.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};h0.prototype.toHex=function(){return Za.encode(this.toBytes(),"hex").toUpperCase()};var jl=h0,$l=Wa,Wl=$a,w0=zt,Ql=w0.assert,fc=w0.parseBytes,oc=Hl,Ys=jl;function Vt(e){if(Ql(e==="ed25519","only tested with ed25519 so far"),!(this instanceof Vt))return new Vt(e);e=Wl[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=$l.sha512}var Xl=Vt;Vt.prototype.sign=function(t,a){t=fc(t);var r=this.keyFromSecret(a),i=this.hashInt(r.messagePrefix(),t),n=this.g.mul(i),s=this.encodePoint(n),f=this.hashInt(s,r.pubBytes(),t).mul(r.priv()),u=i.add(f).umod(this.curve.n);return this.makeSignature({R:n,S:u,Rencoded:s})};Vt.prototype.verify=function(t,a,r){if(t=fc(t),a=this.makeSignature(a),a.S().gte(a.eddsa.curve.n)||a.S().isNeg())return!1;var i=this.keyFromPublic(r),n=this.hashInt(a.Rencoded(),i.pubBytes(),t),s=this.g.mul(a.S()),f=a.R().add(i.pub().mul(n));return f.eq(s)};Vt.prototype.hashInt=function(){for(var t=this.hash(),a=0;a<arguments.length;a++)t.update(arguments[a]);return w0.intFromLE(t.digest()).umod(this.curve.n)};Vt.prototype.keyFromPublic=function(t){return oc.fromPublic(this,t)};Vt.prototype.keyFromSecret=function(t){return oc.fromSecret(this,t)};Vt.prototype.makeSignature=function(t){return t instanceof Ys?t:new Ys(this,t)};Vt.prototype.encodePoint=function(t){var a=t.getY().toArray("le",this.encodingLength);return a[this.encodingLength-1]|=t.getX().isOdd()?128:0,a};Vt.prototype.decodePoint=function(t){t=w0.parseBytes(t);var a=t.length-1,r=t.slice(0,a).concat(t[a]&-129),i=(t[a]&128)!==0,n=w0.intFromLE(r);return this.curve.pointFromY(n,i)};Vt.prototype.encodeInt=function(t){return t.toArray("le",this.encodingLength)};Vt.prototype.decodeInt=function(t){return w0.intFromLE(t)};Vt.prototype.isPoint=function(t){return t instanceof this.pointClass};(function(e){var t=e;t.version=$u.version,t.utils=zt,t.rand=Uo,t.curve=ds,t.curves=$a,t.ec=ql,t.eddsa=Xl})(Gu);var cc={exports:{}};function Yl(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Oi={exports:{}},Zs;function _e(){return Zs||(Zs=1,function(e,t){(function(a,r){e.exports=r()})(be,function(){var a=a||function(r,i){var n;if(typeof window<"u"&&window.crypto&&(n=window.crypto),typeof self<"u"&&self.crypto&&(n=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(n=globalThis.crypto),!n&&typeof window<"u"&&window.msCrypto&&(n=window.msCrypto),!n&&typeof be<"u"&&be.crypto&&(n=be.crypto),!n&&typeof Yl=="function")try{n=k0}catch{}var s=function(){if(n){if(typeof n.getRandomValues=="function")try{return n.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof n.randomBytes=="function")try{return n.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},f=Object.create||function(){function A(){}return function(w){var N;return A.prototype=w,N=new A,A.prototype=null,N}}(),u={},o=u.lib={},c=o.Base=function(){return{extend:function(A){var w=f(this);return A&&w.mixIn(A),(!w.hasOwnProperty("init")||this.init===w.init)&&(w.init=function(){w.$super.init.apply(this,arguments)}),w.init.prototype=w,w.$super=this,w},create:function(){var A=this.extend();return A.init.apply(A,arguments),A},init:function(){},mixIn:function(A){for(var w in A)A.hasOwnProperty(w)&&(this[w]=A[w]);A.hasOwnProperty("toString")&&(this.toString=A.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),l=o.WordArray=c.extend({init:function(A,w){A=this.words=A||[],w!=i?this.sigBytes=w:this.sigBytes=A.length*4},toString:function(A){return(A||g).stringify(this)},concat:function(A){var w=this.words,N=A.words,k=this.sigBytes,M=A.sigBytes;if(this.clamp(),k%4)for(var V=0;V<M;V++){var z=N[V>>>2]>>>24-V%4*8&255;w[k+V>>>2]|=z<<24-(k+V)%4*8}else for(var W=0;W<M;W+=4)w[k+W>>>2]=N[W>>>2];return this.sigBytes+=M,this},clamp:function(){var A=this.words,w=this.sigBytes;A[w>>>2]&=4294967295<<32-w%4*8,A.length=r.ceil(w/4)},clone:function(){var A=c.clone.call(this);return A.words=this.words.slice(0),A},random:function(A){for(var w=[],N=0;N<A;N+=4)w.push(s());return new l.init(w,A)}}),h=u.enc={},g=h.Hex={stringify:function(A){for(var w=A.words,N=A.sigBytes,k=[],M=0;M<N;M++){var V=w[M>>>2]>>>24-M%4*8&255;k.push((V>>>4).toString(16)),k.push((V&15).toString(16))}return k.join("")},parse:function(A){for(var w=A.length,N=[],k=0;k<w;k+=2)N[k>>>3]|=parseInt(A.substr(k,2),16)<<24-k%8*4;return new l.init(N,w/2)}},v=h.Latin1={stringify:function(A){for(var w=A.words,N=A.sigBytes,k=[],M=0;M<N;M++){var V=w[M>>>2]>>>24-M%4*8&255;k.push(String.fromCharCode(V))}return k.join("")},parse:function(A){for(var w=A.length,N=[],k=0;k<w;k++)N[k>>>2]|=(A.charCodeAt(k)&255)<<24-k%4*8;return new l.init(N,w)}},y=h.Utf8={stringify:function(A){try{return decodeURIComponent(escape(v.stringify(A)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(A){return v.parse(unescape(encodeURIComponent(A)))}},b=o.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(A){typeof A=="string"&&(A=y.parse(A)),this._data.concat(A),this._nDataBytes+=A.sigBytes},_process:function(A){var w,N=this._data,k=N.words,M=N.sigBytes,V=this.blockSize,z=V*4,W=M/z;A?W=r.ceil(W):W=r.max((W|0)-this._minBufferSize,0);var U=W*V,C=r.min(U*4,M);if(U){for(var d=0;d<U;d+=V)this._doProcessBlock(k,d);w=k.splice(0,U),N.sigBytes-=C}return new l.init(w,C)},clone:function(){var A=c.clone.call(this);return A._data=this._data.clone(),A},_minBufferSize:0});o.Hasher=b.extend({cfg:c.extend(),init:function(A){this.cfg=this.cfg.extend(A),this.reset()},reset:function(){b.reset.call(this),this._doReset()},update:function(A){return this._append(A),this._process(),this},finalize:function(A){A&&this._append(A);var w=this._doFinalize();return w},blockSize:16,_createHelper:function(A){return function(w,N){return new A.init(N).finalize(w)}},_createHmacHelper:function(A){return function(w,N){return new I.HMAC.init(A,N).finalize(w)}}});var I=u.algo={};return u}(Math);return a})}(Oi)),Oi.exports}var Vi={exports:{}},Js;function ei(){return Js||(Js=1,function(e,t){(function(a,r){e.exports=r(_e())})(be,function(a){return function(r){var i=a,n=i.lib,s=n.Base,f=n.WordArray,u=i.x64={};u.Word=s.extend({init:function(o,c){this.high=o,this.low=c}}),u.WordArray=s.extend({init:function(o,c){o=this.words=o||[],c!=r?this.sigBytes=c:this.sigBytes=o.length*8},toX32:function(){for(var o=this.words,c=o.length,l=[],h=0;h<c;h++){var g=o[h];l.push(g.high),l.push(g.low)}return f.create(l,this.sigBytes)},clone:function(){for(var o=s.clone.call(this),c=o.words=this.words.slice(0),l=c.length,h=0;h<l;h++)c[h]=c[h].clone();return o}})}(),a})}(Vi)),Vi.exports}var Ki={exports:{}},ef;function Zl(){return ef||(ef=1,function(e,t){(function(a,r){e.exports=r(_e())})(be,function(a){return function(){if(typeof ArrayBuffer=="function"){var r=a,i=r.lib,n=i.WordArray,s=n.init,f=n.init=function(u){if(u instanceof ArrayBuffer&&(u=new Uint8Array(u)),(u instanceof Int8Array||typeof Uint8ClampedArray<"u"&&u instanceof Uint8ClampedArray||u instanceof Int16Array||u instanceof Uint16Array||u instanceof Int32Array||u instanceof Uint32Array||u instanceof Float32Array||u instanceof Float64Array)&&(u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength)),u instanceof Uint8Array){for(var o=u.byteLength,c=[],l=0;l<o;l++)c[l>>>2]|=u[l]<<24-l%4*8;s.call(this,c,o)}else s.apply(this,arguments)};f.prototype=n}}(),a.lib.WordArray})}(Ki)),Ki.exports}var qi={exports:{}},tf;function Jl(){return tf||(tf=1,function(e,t){(function(a,r){e.exports=r(_e())})(be,function(a){return function(){var r=a,i=r.lib,n=i.WordArray,s=r.enc;s.Utf16=s.Utf16BE={stringify:function(u){for(var o=u.words,c=u.sigBytes,l=[],h=0;h<c;h+=2){var g=o[h>>>2]>>>16-h%4*8&65535;l.push(String.fromCharCode(g))}return l.join("")},parse:function(u){for(var o=u.length,c=[],l=0;l<o;l++)c[l>>>1]|=u.charCodeAt(l)<<16-l%2*16;return n.create(c,o*2)}},s.Utf16LE={stringify:function(u){for(var o=u.words,c=u.sigBytes,l=[],h=0;h<c;h+=2){var g=f(o[h>>>2]>>>16-h%4*8&65535);l.push(String.fromCharCode(g))}return l.join("")},parse:function(u){for(var o=u.length,c=[],l=0;l<o;l++)c[l>>>1]|=f(u.charCodeAt(l)<<16-l%2*16);return n.create(c,o*2)}};function f(u){return u<<8&4278255360|u>>>8&16711935}}(),a.enc.Utf16})}(qi)),qi.exports}var Hi={exports:{}},rf;function v0(){return rf||(rf=1,function(e,t){(function(a,r){e.exports=r(_e())})(be,function(a){return function(){var r=a,i=r.lib,n=i.WordArray,s=r.enc;s.Base64={stringify:function(u){var o=u.words,c=u.sigBytes,l=this._map;u.clamp();for(var h=[],g=0;g<c;g+=3)for(var v=o[g>>>2]>>>24-g%4*8&255,y=o[g+1>>>2]>>>24-(g+1)%4*8&255,b=o[g+2>>>2]>>>24-(g+2)%4*8&255,I=v<<16|y<<8|b,A=0;A<4&&g+A*.75<c;A++)h.push(l.charAt(I>>>6*(3-A)&63));var w=l.charAt(64);if(w)for(;h.length%4;)h.push(w);return h.join("")},parse:function(u){var o=u.length,c=this._map,l=this._reverseMap;if(!l){l=this._reverseMap=[];for(var h=0;h<c.length;h++)l[c.charCodeAt(h)]=h}var g=c.charAt(64);if(g){var v=u.indexOf(g);v!==-1&&(o=v)}return f(u,o,l)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function f(u,o,c){for(var l=[],h=0,g=0;g<o;g++)if(g%4){var v=c[u.charCodeAt(g-1)]<<g%4*2,y=c[u.charCodeAt(g)]>>>6-g%4*2,b=v|y;l[h>>>2]|=b<<24-h%4*8,h++}return n.create(l,h)}}(),a.enc.Base64})}(Hi)),Hi.exports}var zi={exports:{}},af;function eh(){return af||(af=1,function(e,t){(function(a,r){e.exports=r(_e())})(be,function(a){return function(){var r=a,i=r.lib,n=i.WordArray,s=r.enc;s.Base64url={stringify:function(u,o){o===void 0&&(o=!0);var c=u.words,l=u.sigBytes,h=o?this._safe_map:this._map;u.clamp();for(var g=[],v=0;v<l;v+=3)for(var y=c[v>>>2]>>>24-v%4*8&255,b=c[v+1>>>2]>>>24-(v+1)%4*8&255,I=c[v+2>>>2]>>>24-(v+2)%4*8&255,A=y<<16|b<<8|I,w=0;w<4&&v+w*.75<l;w++)g.push(h.charAt(A>>>6*(3-w)&63));var N=h.charAt(64);if(N)for(;g.length%4;)g.push(N);return g.join("")},parse:function(u,o){o===void 0&&(o=!0);var c=u.length,l=o?this._safe_map:this._map,h=this._reverseMap;if(!h){h=this._reverseMap=[];for(var g=0;g<l.length;g++)h[l.charCodeAt(g)]=g}var v=l.charAt(64);if(v){var y=u.indexOf(v);y!==-1&&(c=y)}return f(u,c,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function f(u,o,c){for(var l=[],h=0,g=0;g<o;g++)if(g%4){var v=c[u.charCodeAt(g-1)]<<g%4*2,y=c[u.charCodeAt(g)]>>>6-g%4*2,b=v|y;l[h>>>2]|=b<<24-h%4*8,h++}return n.create(l,h)}}(),a.enc.Base64url})}(zi)),zi.exports}var Gi={exports:{}},nf;function p0(){return nf||(nf=1,function(e,t){(function(a,r){e.exports=r(_e())})(be,function(a){return function(r){var i=a,n=i.lib,s=n.WordArray,f=n.Hasher,u=i.algo,o=[];(function(){for(var y=0;y<64;y++)o[y]=r.abs(r.sin(y+1))*4294967296|0})();var c=u.MD5=f.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(y,b){for(var I=0;I<16;I++){var A=b+I,w=y[A];y[A]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360}var N=this._hash.words,k=y[b+0],M=y[b+1],V=y[b+2],z=y[b+3],W=y[b+4],U=y[b+5],C=y[b+6],d=y[b+7],x=y[b+8],m=y[b+9],S=y[b+10],D=y[b+11],F=y[b+12],P=y[b+13],R=y[b+14],p=y[b+15],E=N[0],q=N[1],j=N[2],G=N[3];E=l(E,q,j,G,k,7,o[0]),G=l(G,E,q,j,M,12,o[1]),j=l(j,G,E,q,V,17,o[2]),q=l(q,j,G,E,z,22,o[3]),E=l(E,q,j,G,W,7,o[4]),G=l(G,E,q,j,U,12,o[5]),j=l(j,G,E,q,C,17,o[6]),q=l(q,j,G,E,d,22,o[7]),E=l(E,q,j,G,x,7,o[8]),G=l(G,E,q,j,m,12,o[9]),j=l(j,G,E,q,S,17,o[10]),q=l(q,j,G,E,D,22,o[11]),E=l(E,q,j,G,F,7,o[12]),G=l(G,E,q,j,P,12,o[13]),j=l(j,G,E,q,R,17,o[14]),q=l(q,j,G,E,p,22,o[15]),E=h(E,q,j,G,M,5,o[16]),G=h(G,E,q,j,C,9,o[17]),j=h(j,G,E,q,D,14,o[18]),q=h(q,j,G,E,k,20,o[19]),E=h(E,q,j,G,U,5,o[20]),G=h(G,E,q,j,S,9,o[21]),j=h(j,G,E,q,p,14,o[22]),q=h(q,j,G,E,W,20,o[23]),E=h(E,q,j,G,m,5,o[24]),G=h(G,E,q,j,R,9,o[25]),j=h(j,G,E,q,z,14,o[26]),q=h(q,j,G,E,x,20,o[27]),E=h(E,q,j,G,P,5,o[28]),G=h(G,E,q,j,V,9,o[29]),j=h(j,G,E,q,d,14,o[30]),q=h(q,j,G,E,F,20,o[31]),E=g(E,q,j,G,U,4,o[32]),G=g(G,E,q,j,x,11,o[33]),j=g(j,G,E,q,D,16,o[34]),q=g(q,j,G,E,R,23,o[35]),E=g(E,q,j,G,M,4,o[36]),G=g(G,E,q,j,W,11,o[37]),j=g(j,G,E,q,d,16,o[38]),q=g(q,j,G,E,S,23,o[39]),E=g(E,q,j,G,P,4,o[40]),G=g(G,E,q,j,k,11,o[41]),j=g(j,G,E,q,z,16,o[42]),q=g(q,j,G,E,C,23,o[43]),E=g(E,q,j,G,m,4,o[44]),G=g(G,E,q,j,F,11,o[45]),j=g(j,G,E,q,p,16,o[46]),q=g(q,j,G,E,V,23,o[47]),E=v(E,q,j,G,k,6,o[48]),G=v(G,E,q,j,d,10,o[49]),j=v(j,G,E,q,R,15,o[50]),q=v(q,j,G,E,U,21,o[51]),E=v(E,q,j,G,F,6,o[52]),G=v(G,E,q,j,z,10,o[53]),j=v(j,G,E,q,S,15,o[54]),q=v(q,j,G,E,M,21,o[55]),E=v(E,q,j,G,x,6,o[56]),G=v(G,E,q,j,p,10,o[57]),j=v(j,G,E,q,C,15,o[58]),q=v(q,j,G,E,P,21,o[59]),E=v(E,q,j,G,W,6,o[60]),G=v(G,E,q,j,D,10,o[61]),j=v(j,G,E,q,V,15,o[62]),q=v(q,j,G,E,m,21,o[63]),N[0]=N[0]+E|0,N[1]=N[1]+q|0,N[2]=N[2]+j|0,N[3]=N[3]+G|0},_doFinalize:function(){var y=this._data,b=y.words,I=this._nDataBytes*8,A=y.sigBytes*8;b[A>>>5]|=128<<24-A%32;var w=r.floor(I/4294967296),N=I;b[(A+64>>>9<<4)+15]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,b[(A+64>>>9<<4)+14]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,y.sigBytes=(b.length+1)*4,this._process();for(var k=this._hash,M=k.words,V=0;V<4;V++){var z=M[V];M[V]=(z<<8|z>>>24)&16711935|(z<<24|z>>>8)&4278255360}return k},clone:function(){var y=f.clone.call(this);return y._hash=this._hash.clone(),y}});function l(y,b,I,A,w,N,k){var M=y+(b&I|~b&A)+w+k;return(M<<N|M>>>32-N)+b}function h(y,b,I,A,w,N,k){var M=y+(b&A|I&~A)+w+k;return(M<<N|M>>>32-N)+b}function g(y,b,I,A,w,N,k){var M=y+(b^I^A)+w+k;return(M<<N|M>>>32-N)+b}function v(y,b,I,A,w,N,k){var M=y+(I^(b|~A))+w+k;return(M<<N|M>>>32-N)+b}i.MD5=f._createHelper(c),i.HmacMD5=f._createHmacHelper(c)}(Math),a.MD5})}(Gi)),Gi.exports}var ji={exports:{}},sf;function uc(){return sf||(sf=1,function(e,t){(function(a,r){e.exports=r(_e())})(be,function(a){return function(){var r=a,i=r.lib,n=i.WordArray,s=i.Hasher,f=r.algo,u=[],o=f.SHA1=s.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(c,l){for(var h=this._hash.words,g=h[0],v=h[1],y=h[2],b=h[3],I=h[4],A=0;A<80;A++){if(A<16)u[A]=c[l+A]|0;else{var w=u[A-3]^u[A-8]^u[A-14]^u[A-16];u[A]=w<<1|w>>>31}var N=(g<<5|g>>>27)+I+u[A];A<20?N+=(v&y|~v&b)+1518500249:A<40?N+=(v^y^b)+1859775393:A<60?N+=(v&y|v&b|y&b)-1894007588:N+=(v^y^b)-899497514,I=b,b=y,y=v<<30|v>>>2,v=g,g=N}h[0]=h[0]+g|0,h[1]=h[1]+v|0,h[2]=h[2]+y|0,h[3]=h[3]+b|0,h[4]=h[4]+I|0},_doFinalize:function(){var c=this._data,l=c.words,h=this._nDataBytes*8,g=c.sigBytes*8;return l[g>>>5]|=128<<24-g%32,l[(g+64>>>9<<4)+14]=Math.floor(h/4294967296),l[(g+64>>>9<<4)+15]=h,c.sigBytes=l.length*4,this._process(),this._hash},clone:function(){var c=s.clone.call(this);return c._hash=this._hash.clone(),c}});r.SHA1=s._createHelper(o),r.HmacSHA1=s._createHmacHelper(o)}(),a.SHA1})}(ji)),ji.exports}var $i={exports:{}},ff;function ps(){return ff||(ff=1,function(e,t){(function(a,r){e.exports=r(_e())})(be,function(a){return function(r){var i=a,n=i.lib,s=n.WordArray,f=n.Hasher,u=i.algo,o=[],c=[];(function(){function g(I){for(var A=r.sqrt(I),w=2;w<=A;w++)if(!(I%w))return!1;return!0}function v(I){return(I-(I|0))*4294967296|0}for(var y=2,b=0;b<64;)g(y)&&(b<8&&(o[b]=v(r.pow(y,1/2))),c[b]=v(r.pow(y,1/3)),b++),y++})();var l=[],h=u.SHA256=f.extend({_doReset:function(){this._hash=new s.init(o.slice(0))},_doProcessBlock:function(g,v){for(var y=this._hash.words,b=y[0],I=y[1],A=y[2],w=y[3],N=y[4],k=y[5],M=y[6],V=y[7],z=0;z<64;z++){if(z<16)l[z]=g[v+z]|0;else{var W=l[z-15],U=(W<<25|W>>>7)^(W<<14|W>>>18)^W>>>3,C=l[z-2],d=(C<<15|C>>>17)^(C<<13|C>>>19)^C>>>10;l[z]=U+l[z-7]+d+l[z-16]}var x=N&k^~N&M,m=b&I^b&A^I&A,S=(b<<30|b>>>2)^(b<<19|b>>>13)^(b<<10|b>>>22),D=(N<<26|N>>>6)^(N<<21|N>>>11)^(N<<7|N>>>25),F=V+D+x+c[z]+l[z],P=S+m;V=M,M=k,k=N,N=w+F|0,w=A,A=I,I=b,b=F+P|0}y[0]=y[0]+b|0,y[1]=y[1]+I|0,y[2]=y[2]+A|0,y[3]=y[3]+w|0,y[4]=y[4]+N|0,y[5]=y[5]+k|0,y[6]=y[6]+M|0,y[7]=y[7]+V|0},_doFinalize:function(){var g=this._data,v=g.words,y=this._nDataBytes*8,b=g.sigBytes*8;return v[b>>>5]|=128<<24-b%32,v[(b+64>>>9<<4)+14]=r.floor(y/4294967296),v[(b+64>>>9<<4)+15]=y,g.sigBytes=v.length*4,this._process(),this._hash},clone:function(){var g=f.clone.call(this);return g._hash=this._hash.clone(),g}});i.SHA256=f._createHelper(h),i.HmacSHA256=f._createHmacHelper(h)}(Math),a.SHA256})}($i)),$i.exports}var Wi={exports:{}},of;function th(){return of||(of=1,function(e,t){(function(a,r,i){e.exports=r(_e(),ps())})(be,function(a){return function(){var r=a,i=r.lib,n=i.WordArray,s=r.algo,f=s.SHA256,u=s.SHA224=f.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var o=f._doFinalize.call(this);return o.sigBytes-=4,o}});r.SHA224=f._createHelper(u),r.HmacSHA224=f._createHmacHelper(u)}(),a.SHA224})}(Wi)),Wi.exports}var Qi={exports:{}},cf;function dc(){return cf||(cf=1,function(e,t){(function(a,r,i){e.exports=r(_e(),ei())})(be,function(a){return function(){var r=a,i=r.lib,n=i.Hasher,s=r.x64,f=s.Word,u=s.WordArray,o=r.algo;function c(){return f.create.apply(f,arguments)}var l=[c(1116352408,3609767458),c(1899447441,602891725),c(3049323471,3964484399),c(3921009573,2173295548),c(961987163,4081628472),c(1508970993,3053834265),c(2453635748,2937671579),c(2870763221,3664609560),c(3624381080,2734883394),c(310598401,1164996542),c(607225278,1323610764),c(1426881987,3590304994),c(1925078388,4068182383),c(2162078206,991336113),c(2614888103,633803317),c(3248222580,3479774868),c(3835390401,2666613458),c(4022224774,944711139),c(264347078,2341262773),c(604807628,2007800933),c(770255983,1495990901),c(1249150122,1856431235),c(1555081692,3175218132),c(1996064986,2198950837),c(2554220882,3999719339),c(2821834349,766784016),c(2952996808,2566594879),c(3210313671,3203337956),c(3336571891,1034457026),c(3584528711,2466948901),c(113926993,3758326383),c(338241895,168717936),c(666307205,1188179964),c(773529912,1546045734),c(1294757372,1522805485),c(1396182291,2643833823),c(1695183700,2343527390),c(1986661051,1014477480),c(2177026350,1206759142),c(2456956037,344077627),c(2730485921,1290863460),c(2820302411,3158454273),c(3259730800,3505952657),c(3345764771,106217008),c(3516065817,3606008344),c(3600352804,1432725776),c(4094571909,1467031594),c(275423344,851169720),c(430227734,3100823752),c(506948616,1363258195),c(659060556,3750685593),c(883997877,3785050280),c(958139571,3318307427),c(1322822218,3812723403),c(1537002063,2003034995),c(1747873779,3602036899),c(1955562222,1575990012),c(2024104815,1125592928),c(2227730452,2716904306),c(2361852424,442776044),c(2428436474,593698344),c(2756734187,3733110249),c(3204031479,2999351573),c(3329325298,3815920427),c(3391569614,3928383900),c(3515267271,566280711),c(3940187606,3454069534),c(4118630271,4000239992),c(116418474,1914138554),c(174292421,2731055270),c(289380356,3203993006),c(460393269,320620315),c(685471733,587496836),c(852142971,1086792851),c(1017036298,365543100),c(1126000580,2618297676),c(1288033470,3409855158),c(1501505948,4234509866),c(1607167915,987167468),c(1816402316,1246189591)],h=[];(function(){for(var v=0;v<80;v++)h[v]=c()})();var g=o.SHA512=n.extend({_doReset:function(){this._hash=new u.init([new f.init(1779033703,4089235720),new f.init(3144134277,2227873595),new f.init(1013904242,4271175723),new f.init(2773480762,1595750129),new f.init(1359893119,2917565137),new f.init(2600822924,725511199),new f.init(528734635,4215389547),new f.init(1541459225,327033209)])},_doProcessBlock:function(v,y){for(var b=this._hash.words,I=b[0],A=b[1],w=b[2],N=b[3],k=b[4],M=b[5],V=b[6],z=b[7],W=I.high,U=I.low,C=A.high,d=A.low,x=w.high,m=w.low,S=N.high,D=N.low,F=k.high,P=k.low,R=M.high,p=M.low,E=V.high,q=V.low,j=z.high,G=z.low,ee=W,re=U,fe=C,se=d,le=x,ve=m,We=S,pe=D,he=F,we=P,ge=R,Pe=p,Yr=E,Ue=q,je=j,Fr=G,Fe=0;Fe<80;Fe++){var De,Jt,He=h[Fe];if(Fe<16)Jt=He.high=v[y+Fe*2]|0,De=He.low=v[y+Fe*2+1]|0;else{var Qe=h[Fe-15],Ar=Qe.high,Oe=Qe.low,it=(Ar>>>1|Oe<<31)^(Ar>>>8|Oe<<24)^Ar>>>7,G0=(Oe>>>1|Ar<<31)^(Oe>>>8|Ar<<24)^(Oe>>>7|Ar<<25),Xe=h[Fe-2],Me=Xe.high,kr=Xe.low,nt=(Me>>>19|kr<<13)^(Me<<3|kr>>>29)^Me>>>6,Ye=(kr>>>19|Me<<13)^(kr<<3|Me>>>29)^(kr>>>6|Me<<26),j0=h[Fe-7],st=j0.high,ft=j0.low,$0=h[Fe-16],ot=$0.high,Ze=$0.low;De=G0+ft,Jt=it+st+(De>>>0<G0>>>0?1:0),De=De+Ye,Jt=Jt+nt+(De>>>0<Ye>>>0?1:0),De=De+Ze,Jt=Jt+ot+(De>>>0<Ze>>>0?1:0),He.high=Jt,He.low=De}var ua=he&ge^~he&Yr,Je=we&Pe^~we&Ue,ct=ee&fe^ee&le^fe&le,da=re&se^re&ve^se&ve,ut=(ee>>>28|re<<4)^(ee<<30|re>>>2)^(ee<<25|re>>>7),et=(re>>>28|ee<<4)^(re<<30|ee>>>2)^(re<<25|ee>>>7),la=(he>>>14|we<<18)^(he>>>18|we<<14)^(he<<23|we>>>9),dt=(we>>>14|he<<18)^(we>>>18|he<<14)^(we<<23|he>>>9),tt=l[Fe],ha=tt.high,rt=tt.low,Ie=Fr+dt,er=je+la+(Ie>>>0<Fr>>>0?1:0),Ie=Ie+Je,er=er+ua+(Ie>>>0<Je>>>0?1:0),Ie=Ie+rt,er=er+ha+(Ie>>>0<rt>>>0?1:0),Ie=Ie+De,er=er+Jt+(Ie>>>0<De>>>0?1:0),at=et+da,lt=ut+ct+(at>>>0<et>>>0?1:0);je=Yr,Fr=Ue,Yr=ge,Ue=Pe,ge=he,Pe=we,we=pe+Ie|0,he=We+er+(we>>>0<pe>>>0?1:0)|0,We=le,pe=ve,le=fe,ve=se,fe=ee,se=re,re=Ie+at|0,ee=er+lt+(re>>>0<Ie>>>0?1:0)|0}U=I.low=U+re,I.high=W+ee+(U>>>0<re>>>0?1:0),d=A.low=d+se,A.high=C+fe+(d>>>0<se>>>0?1:0),m=w.low=m+ve,w.high=x+le+(m>>>0<ve>>>0?1:0),D=N.low=D+pe,N.high=S+We+(D>>>0<pe>>>0?1:0),P=k.low=P+we,k.high=F+he+(P>>>0<we>>>0?1:0),p=M.low=p+Pe,M.high=R+ge+(p>>>0<Pe>>>0?1:0),q=V.low=q+Ue,V.high=E+Yr+(q>>>0<Ue>>>0?1:0),G=z.low=G+Fr,z.high=j+je+(G>>>0<Fr>>>0?1:0)},_doFinalize:function(){var v=this._data,y=v.words,b=this._nDataBytes*8,I=v.sigBytes*8;y[I>>>5]|=128<<24-I%32,y[(I+128>>>10<<5)+30]=Math.floor(b/4294967296),y[(I+128>>>10<<5)+31]=b,v.sigBytes=y.length*4,this._process();var A=this._hash.toX32();return A},clone:function(){var v=n.clone.call(this);return v._hash=this._hash.clone(),v},blockSize:1024/32});r.SHA512=n._createHelper(g),r.HmacSHA512=n._createHmacHelper(g)}(),a.SHA512})}(Qi)),Qi.exports}var Xi={exports:{}},uf;function rh(){return uf||(uf=1,function(e,t){(function(a,r,i){e.exports=r(_e(),ei(),dc())})(be,function(a){return function(){var r=a,i=r.x64,n=i.Word,s=i.WordArray,f=r.algo,u=f.SHA512,o=f.SHA384=u.extend({_doReset:function(){this._hash=new s.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},_doFinalize:function(){var c=u._doFinalize.call(this);return c.sigBytes-=16,c}});r.SHA384=u._createHelper(o),r.HmacSHA384=u._createHmacHelper(o)}(),a.SHA384})}(Xi)),Xi.exports}var Yi={exports:{}},df;function ah(){return df||(df=1,function(e,t){(function(a,r,i){e.exports=r(_e(),ei())})(be,function(a){return function(r){var i=a,n=i.lib,s=n.WordArray,f=n.Hasher,u=i.x64,o=u.Word,c=i.algo,l=[],h=[],g=[];(function(){for(var b=1,I=0,A=0;A<24;A++){l[b+5*I]=(A+1)*(A+2)/2%64;var w=I%5,N=(2*b+3*I)%5;b=w,I=N}for(var b=0;b<5;b++)for(var I=0;I<5;I++)h[b+5*I]=I+(2*b+3*I)%5*5;for(var k=1,M=0;M<24;M++){for(var V=0,z=0,W=0;W<7;W++){if(k&1){var U=(1<<W)-1;U<32?z^=1<<U:V^=1<<U-32}k&128?k=k<<1^113:k<<=1}g[M]=o.create(V,z)}})();var v=[];(function(){for(var b=0;b<25;b++)v[b]=o.create()})();var y=c.SHA3=f.extend({cfg:f.cfg.extend({outputLength:512}),_doReset:function(){for(var b=this._state=[],I=0;I<25;I++)b[I]=new o.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(b,I){for(var A=this._state,w=this.blockSize/2,N=0;N<w;N++){var k=b[I+2*N],M=b[I+2*N+1];k=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360,M=(M<<8|M>>>24)&16711935|(M<<24|M>>>8)&4278255360;var V=A[N];V.high^=M,V.low^=k}for(var z=0;z<24;z++){for(var W=0;W<5;W++){for(var U=0,C=0,d=0;d<5;d++){var V=A[W+5*d];U^=V.high,C^=V.low}var x=v[W];x.high=U,x.low=C}for(var W=0;W<5;W++)for(var m=v[(W+4)%5],S=v[(W+1)%5],D=S.high,F=S.low,U=m.high^(D<<1|F>>>31),C=m.low^(F<<1|D>>>31),d=0;d<5;d++){var V=A[W+5*d];V.high^=U,V.low^=C}for(var P=1;P<25;P++){var U,C,V=A[P],R=V.high,p=V.low,E=l[P];E<32?(U=R<<E|p>>>32-E,C=p<<E|R>>>32-E):(U=p<<E-32|R>>>64-E,C=R<<E-32|p>>>64-E);var q=v[h[P]];q.high=U,q.low=C}var j=v[0],G=A[0];j.high=G.high,j.low=G.low;for(var W=0;W<5;W++)for(var d=0;d<5;d++){var P=W+5*d,V=A[P],ee=v[P],re=v[(W+1)%5+5*d],fe=v[(W+2)%5+5*d];V.high=ee.high^~re.high&fe.high,V.low=ee.low^~re.low&fe.low}var V=A[0],se=g[z];V.high^=se.high,V.low^=se.low}},_doFinalize:function(){var b=this._data,I=b.words;this._nDataBytes*8;var A=b.sigBytes*8,w=this.blockSize*32;I[A>>>5]|=1<<24-A%32,I[(r.ceil((A+1)/w)*w>>>5)-1]|=128,b.sigBytes=I.length*4,this._process();for(var N=this._state,k=this.cfg.outputLength/8,M=k/8,V=[],z=0;z<M;z++){var W=N[z],U=W.high,C=W.low;U=(U<<8|U>>>24)&16711935|(U<<24|U>>>8)&4278255360,C=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,V.push(C),V.push(U)}return new s.init(V,k)},clone:function(){for(var b=f.clone.call(this),I=b._state=this._state.slice(0),A=0;A<25;A++)I[A]=I[A].clone();return b}});i.SHA3=f._createHelper(y),i.HmacSHA3=f._createHmacHelper(y)}(Math),a.SHA3})}(Yi)),Yi.exports}var Zi={exports:{}},lf;function ih(){return lf||(lf=1,function(e,t){(function(a,r){e.exports=r(_e())})(be,function(a){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(r){var i=a,n=i.lib,s=n.WordArray,f=n.Hasher,u=i.algo,o=s.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),c=s.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),l=s.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),h=s.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),g=s.create([0,1518500249,1859775393,2400959708,2840853838]),v=s.create([1352829926,1548603684,1836072691,2053994217,0]),y=u.RIPEMD160=f.extend({_doReset:function(){this._hash=s.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(M,V){for(var z=0;z<16;z++){var W=V+z,U=M[W];M[W]=(U<<8|U>>>24)&16711935|(U<<24|U>>>8)&4278255360}var C=this._hash.words,d=g.words,x=v.words,m=o.words,S=c.words,D=l.words,F=h.words,P,R,p,E,q,j,G,ee,re,fe;j=P=C[0],G=R=C[1],ee=p=C[2],re=E=C[3],fe=q=C[4];for(var se,z=0;z<80;z+=1)se=P+M[V+m[z]]|0,z<16?se+=b(R,p,E)+d[0]:z<32?se+=I(R,p,E)+d[1]:z<48?se+=A(R,p,E)+d[2]:z<64?se+=w(R,p,E)+d[3]:se+=N(R,p,E)+d[4],se=se|0,se=k(se,D[z]),se=se+q|0,P=q,q=E,E=k(p,10),p=R,R=se,se=j+M[V+S[z]]|0,z<16?se+=N(G,ee,re)+x[0]:z<32?se+=w(G,ee,re)+x[1]:z<48?se+=A(G,ee,re)+x[2]:z<64?se+=I(G,ee,re)+x[3]:se+=b(G,ee,re)+x[4],se=se|0,se=k(se,F[z]),se=se+fe|0,j=fe,fe=re,re=k(ee,10),ee=G,G=se;se=C[1]+p+re|0,C[1]=C[2]+E+fe|0,C[2]=C[3]+q+j|0,C[3]=C[4]+P+G|0,C[4]=C[0]+R+ee|0,C[0]=se},_doFinalize:function(){var M=this._data,V=M.words,z=this._nDataBytes*8,W=M.sigBytes*8;V[W>>>5]|=128<<24-W%32,V[(W+64>>>9<<4)+14]=(z<<8|z>>>24)&16711935|(z<<24|z>>>8)&4278255360,M.sigBytes=(V.length+1)*4,this._process();for(var U=this._hash,C=U.words,d=0;d<5;d++){var x=C[d];C[d]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360}return U},clone:function(){var M=f.clone.call(this);return M._hash=this._hash.clone(),M}});function b(M,V,z){return M^V^z}function I(M,V,z){return M&V|~M&z}function A(M,V,z){return(M|~V)^z}function w(M,V,z){return M&z|V&~z}function N(M,V,z){return M^(V|~z)}function k(M,V){return M<<V|M>>>32-V}i.RIPEMD160=f._createHelper(y),i.HmacRIPEMD160=f._createHmacHelper(y)}(),a.RIPEMD160})}(Zi)),Zi.exports}var Ji={exports:{}},hf;function xs(){return hf||(hf=1,function(e,t){(function(a,r){e.exports=r(_e())})(be,function(a){(function(){var r=a,i=r.lib,n=i.Base,s=r.enc,f=s.Utf8,u=r.algo;u.HMAC=n.extend({init:function(o,c){o=this._hasher=new o.init,typeof c=="string"&&(c=f.parse(c));var l=o.blockSize,h=l*4;c.sigBytes>h&&(c=o.finalize(c)),c.clamp();for(var g=this._oKey=c.clone(),v=this._iKey=c.clone(),y=g.words,b=v.words,I=0;I<l;I++)y[I]^=1549556828,b[I]^=909522486;g.sigBytes=v.sigBytes=h,this.reset()},reset:function(){var o=this._hasher;o.reset(),o.update(this._iKey)},update:function(o){return this._hasher.update(o),this},finalize:function(o){var c=this._hasher,l=c.finalize(o);c.reset();var h=c.finalize(this._oKey.clone().concat(l));return h}})})()})}(Ji)),Ji.exports}var en={exports:{}},vf;function nh(){return vf||(vf=1,function(e,t){(function(a,r,i){e.exports=r(_e(),ps(),xs())})(be,function(a){return function(){var r=a,i=r.lib,n=i.Base,s=i.WordArray,f=r.algo,u=f.SHA256,o=f.HMAC,c=f.PBKDF2=n.extend({cfg:n.extend({keySize:128/32,hasher:u,iterations:25e4}),init:function(l){this.cfg=this.cfg.extend(l)},compute:function(l,h){for(var g=this.cfg,v=o.create(g.hasher,l),y=s.create(),b=s.create([1]),I=y.words,A=b.words,w=g.keySize,N=g.iterations;I.length<w;){var k=v.update(h).finalize(b);v.reset();for(var M=k.words,V=M.length,z=k,W=1;W<N;W++){z=v.finalize(z),v.reset();for(var U=z.words,C=0;C<V;C++)M[C]^=U[C]}y.concat(k),A[0]++}return y.sigBytes=w*4,y}});r.PBKDF2=function(l,h,g){return c.create(g).compute(l,h)}}(),a.PBKDF2})}(en)),en.exports}var tn={exports:{}},pf;function Xr(){return pf||(pf=1,function(e,t){(function(a,r,i){e.exports=r(_e(),uc(),xs())})(be,function(a){return function(){var r=a,i=r.lib,n=i.Base,s=i.WordArray,f=r.algo,u=f.MD5,o=f.EvpKDF=n.extend({cfg:n.extend({keySize:128/32,hasher:u,iterations:1}),init:function(c){this.cfg=this.cfg.extend(c)},compute:function(c,l){for(var h,g=this.cfg,v=g.hasher.create(),y=s.create(),b=y.words,I=g.keySize,A=g.iterations;b.length<I;){h&&v.update(h),h=v.update(c).finalize(l),v.reset();for(var w=1;w<A;w++)h=v.finalize(h),v.reset();y.concat(h)}return y.sigBytes=I*4,y}});r.EvpKDF=function(c,l,h){return o.create(h).compute(c,l)}}(),a.EvpKDF})}(tn)),tn.exports}var rn={exports:{}},xf;function It(){return xf||(xf=1,function(e,t){(function(a,r,i){e.exports=r(_e(),Xr())})(be,function(a){a.lib.Cipher||function(r){var i=a,n=i.lib,s=n.Base,f=n.WordArray,u=n.BufferedBlockAlgorithm,o=i.enc;o.Utf8;var c=o.Base64,l=i.algo,h=l.EvpKDF,g=n.Cipher=u.extend({cfg:s.extend(),createEncryptor:function(U,C){return this.create(this._ENC_XFORM_MODE,U,C)},createDecryptor:function(U,C){return this.create(this._DEC_XFORM_MODE,U,C)},init:function(U,C,d){this.cfg=this.cfg.extend(d),this._xformMode=U,this._key=C,this.reset()},reset:function(){u.reset.call(this),this._doReset()},process:function(U){return this._append(U),this._process()},finalize:function(U){U&&this._append(U);var C=this._doFinalize();return C},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function U(C){return typeof C=="string"?W:M}return function(C){return{encrypt:function(d,x,m){return U(x).encrypt(C,d,x,m)},decrypt:function(d,x,m){return U(x).decrypt(C,d,x,m)}}}}()});n.StreamCipher=g.extend({_doFinalize:function(){var U=this._process(!0);return U},blockSize:1});var v=i.mode={},y=n.BlockCipherMode=s.extend({createEncryptor:function(U,C){return this.Encryptor.create(U,C)},createDecryptor:function(U,C){return this.Decryptor.create(U,C)},init:function(U,C){this._cipher=U,this._iv=C}}),b=v.CBC=function(){var U=y.extend();U.Encryptor=U.extend({processBlock:function(d,x){var m=this._cipher,S=m.blockSize;C.call(this,d,x,S),m.encryptBlock(d,x),this._prevBlock=d.slice(x,x+S)}}),U.Decryptor=U.extend({processBlock:function(d,x){var m=this._cipher,S=m.blockSize,D=d.slice(x,x+S);m.decryptBlock(d,x),C.call(this,d,x,S),this._prevBlock=D}});function C(d,x,m){var S,D=this._iv;D?(S=D,this._iv=r):S=this._prevBlock;for(var F=0;F<m;F++)d[x+F]^=S[F]}return U}(),I=i.pad={},A=I.Pkcs7={pad:function(U,C){for(var d=C*4,x=d-U.sigBytes%d,m=x<<24|x<<16|x<<8|x,S=[],D=0;D<x;D+=4)S.push(m);var F=f.create(S,x);U.concat(F)},unpad:function(U){var C=U.words[U.sigBytes-1>>>2]&255;U.sigBytes-=C}};n.BlockCipher=g.extend({cfg:g.cfg.extend({mode:b,padding:A}),reset:function(){var U;g.reset.call(this);var C=this.cfg,d=C.iv,x=C.mode;this._xformMode==this._ENC_XFORM_MODE?U=x.createEncryptor:(U=x.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==U?this._mode.init(this,d&&d.words):(this._mode=U.call(x,this,d&&d.words),this._mode.__creator=U)},_doProcessBlock:function(U,C){this._mode.processBlock(U,C)},_doFinalize:function(){var U,C=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(C.pad(this._data,this.blockSize),U=this._process(!0)):(U=this._process(!0),C.unpad(U)),U},blockSize:128/32});var w=n.CipherParams=s.extend({init:function(U){this.mixIn(U)},toString:function(U){return(U||this.formatter).stringify(this)}}),N=i.format={},k=N.OpenSSL={stringify:function(U){var C,d=U.ciphertext,x=U.salt;return x?C=f.create([1398893684,1701076831]).concat(x).concat(d):C=d,C.toString(c)},parse:function(U){var C,d=c.parse(U),x=d.words;return x[0]==1398893684&&x[1]==1701076831&&(C=f.create(x.slice(2,4)),x.splice(0,4),d.sigBytes-=16),w.create({ciphertext:d,salt:C})}},M=n.SerializableCipher=s.extend({cfg:s.extend({format:k}),encrypt:function(U,C,d,x){x=this.cfg.extend(x);var m=U.createEncryptor(d,x),S=m.finalize(C),D=m.cfg;return w.create({ciphertext:S,key:d,iv:D.iv,algorithm:U,mode:D.mode,padding:D.padding,blockSize:U.blockSize,formatter:x.format})},decrypt:function(U,C,d,x){x=this.cfg.extend(x),C=this._parse(C,x.format);var m=U.createDecryptor(d,x).finalize(C.ciphertext);return m},_parse:function(U,C){return typeof U=="string"?C.parse(U,this):U}}),V=i.kdf={},z=V.OpenSSL={execute:function(U,C,d,x,m){if(x||(x=f.random(64/8)),m)var S=h.create({keySize:C+d,hasher:m}).compute(U,x);else var S=h.create({keySize:C+d}).compute(U,x);var D=f.create(S.words.slice(C),d*4);return S.sigBytes=C*4,w.create({key:S,iv:D,salt:x})}},W=n.PasswordBasedCipher=M.extend({cfg:M.cfg.extend({kdf:z}),encrypt:function(U,C,d,x){x=this.cfg.extend(x);var m=x.kdf.execute(d,U.keySize,U.ivSize,x.salt,x.hasher);x.iv=m.iv;var S=M.encrypt.call(this,U,C,m.key,x);return S.mixIn(m),S},decrypt:function(U,C,d,x){x=this.cfg.extend(x),C=this._parse(C,x.format);var m=x.kdf.execute(d,U.keySize,U.ivSize,C.salt,x.hasher);x.iv=m.iv;var S=M.decrypt.call(this,U,C,m.key,x);return S}})}()})}(rn)),rn.exports}var an={exports:{}},gf;function sh(){return gf||(gf=1,function(e,t){(function(a,r,i){e.exports=r(_e(),It())})(be,function(a){return a.mode.CFB=function(){var r=a.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(n,s){var f=this._cipher,u=f.blockSize;i.call(this,n,s,u,f),this._prevBlock=n.slice(s,s+u)}}),r.Decryptor=r.extend({processBlock:function(n,s){var f=this._cipher,u=f.blockSize,o=n.slice(s,s+u);i.call(this,n,s,u,f),this._prevBlock=o}});function i(n,s,f,u){var o,c=this._iv;c?(o=c.slice(0),this._iv=void 0):o=this._prevBlock,u.encryptBlock(o,0);for(var l=0;l<f;l++)n[s+l]^=o[l]}return r}(),a.mode.CFB})}(an)),an.exports}var nn={exports:{}},yf;function fh(){return yf||(yf=1,function(e,t){(function(a,r,i){e.exports=r(_e(),It())})(be,function(a){return a.mode.CTR=function(){var r=a.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(n,s){var f=this._cipher,u=f.blockSize,o=this._iv,c=this._counter;o&&(c=this._counter=o.slice(0),this._iv=void 0);var l=c.slice(0);f.encryptBlock(l,0),c[u-1]=c[u-1]+1|0;for(var h=0;h<u;h++)n[s+h]^=l[h]}});return r.Decryptor=i,r}(),a.mode.CTR})}(nn)),nn.exports}var sn={exports:{}},bf;function oh(){return bf||(bf=1,function(e,t){(function(a,r,i){e.exports=r(_e(),It())})(be,function(a){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return a.mode.CTRGladman=function(){var r=a.lib.BlockCipherMode.extend();function i(f){if((f>>24&255)===255){var u=f>>16&255,o=f>>8&255,c=f&255;u===255?(u=0,o===255?(o=0,c===255?c=0:++c):++o):++u,f=0,f+=u<<16,f+=o<<8,f+=c}else f+=1<<24;return f}function n(f){return(f[0]=i(f[0]))===0&&(f[1]=i(f[1])),f}var s=r.Encryptor=r.extend({processBlock:function(f,u){var o=this._cipher,c=o.blockSize,l=this._iv,h=this._counter;l&&(h=this._counter=l.slice(0),this._iv=void 0),n(h);var g=h.slice(0);o.encryptBlock(g,0);for(var v=0;v<c;v++)f[u+v]^=g[v]}});return r.Decryptor=s,r}(),a.mode.CTRGladman})}(sn)),sn.exports}var fn={exports:{}},mf;function ch(){return mf||(mf=1,function(e,t){(function(a,r,i){e.exports=r(_e(),It())})(be,function(a){return a.mode.OFB=function(){var r=a.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(n,s){var f=this._cipher,u=f.blockSize,o=this._iv,c=this._keystream;o&&(c=this._keystream=o.slice(0),this._iv=void 0),f.encryptBlock(c,0);for(var l=0;l<u;l++)n[s+l]^=c[l]}});return r.Decryptor=i,r}(),a.mode.OFB})}(fn)),fn.exports}var on={exports:{}},Cf;function uh(){return Cf||(Cf=1,function(e,t){(function(a,r,i){e.exports=r(_e(),It())})(be,function(a){return a.mode.ECB=function(){var r=a.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(i,n){this._cipher.encryptBlock(i,n)}}),r.Decryptor=r.extend({processBlock:function(i,n){this._cipher.decryptBlock(i,n)}}),r}(),a.mode.ECB})}(on)),on.exports}var cn={exports:{}},Ef;function dh(){return Ef||(Ef=1,function(e,t){(function(a,r,i){e.exports=r(_e(),It())})(be,function(a){return a.pad.AnsiX923={pad:function(r,i){var n=r.sigBytes,s=i*4,f=s-n%s,u=n+f-1;r.clamp(),r.words[u>>>2]|=f<<24-u%4*8,r.sigBytes+=f},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},a.pad.Ansix923})}(cn)),cn.exports}var un={exports:{}},Af;function lh(){return Af||(Af=1,function(e,t){(function(a,r,i){e.exports=r(_e(),It())})(be,function(a){return a.pad.Iso10126={pad:function(r,i){var n=i*4,s=n-r.sigBytes%n;r.concat(a.lib.WordArray.random(s-1)).concat(a.lib.WordArray.create([s<<24],1))},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},a.pad.Iso10126})}(un)),un.exports}var dn={exports:{}},Sf;function hh(){return Sf||(Sf=1,function(e,t){(function(a,r,i){e.exports=r(_e(),It())})(be,function(a){return a.pad.Iso97971={pad:function(r,i){r.concat(a.lib.WordArray.create([2147483648],1)),a.pad.ZeroPadding.pad(r,i)},unpad:function(r){a.pad.ZeroPadding.unpad(r),r.sigBytes--}},a.pad.Iso97971})}(dn)),dn.exports}var ln={exports:{}},Bf;function vh(){return Bf||(Bf=1,function(e,t){(function(a,r,i){e.exports=r(_e(),It())})(be,function(a){return a.pad.ZeroPadding={pad:function(r,i){var n=i*4;r.clamp(),r.sigBytes+=n-(r.sigBytes%n||n)},unpad:function(r){for(var i=r.words,n=r.sigBytes-1,n=r.sigBytes-1;n>=0;n--)if(i[n>>>2]>>>24-n%4*8&255){r.sigBytes=n+1;break}}},a.pad.ZeroPadding})}(ln)),ln.exports}var hn={exports:{}},_f;function ph(){return _f||(_f=1,function(e,t){(function(a,r,i){e.exports=r(_e(),It())})(be,function(a){return a.pad.NoPadding={pad:function(){},unpad:function(){}},a.pad.NoPadding})}(hn)),hn.exports}var vn={exports:{}},If;function xh(){return If||(If=1,function(e,t){(function(a,r,i){e.exports=r(_e(),It())})(be,function(a){return function(r){var i=a,n=i.lib,s=n.CipherParams,f=i.enc,u=f.Hex,o=i.format;o.Hex={stringify:function(c){return c.ciphertext.toString(u)},parse:function(c){var l=u.parse(c);return s.create({ciphertext:l})}}}(),a.format.Hex})}(vn)),vn.exports}var pn={exports:{}},Tf;function gh(){return Tf||(Tf=1,function(e,t){(function(a,r,i){e.exports=r(_e(),v0(),p0(),Xr(),It())})(be,function(a){return function(){var r=a,i=r.lib,n=i.BlockCipher,s=r.algo,f=[],u=[],o=[],c=[],l=[],h=[],g=[],v=[],y=[],b=[];(function(){for(var w=[],N=0;N<256;N++)N<128?w[N]=N<<1:w[N]=N<<1^283;for(var k=0,M=0,N=0;N<256;N++){var V=M^M<<1^M<<2^M<<3^M<<4;V=V>>>8^V&255^99,f[k]=V,u[V]=k;var z=w[k],W=w[z],U=w[W],C=w[V]*257^V*16843008;o[k]=C<<24|C>>>8,c[k]=C<<16|C>>>16,l[k]=C<<8|C>>>24,h[k]=C;var C=U*16843009^W*65537^z*257^k*16843008;g[V]=C<<24|C>>>8,v[V]=C<<16|C>>>16,y[V]=C<<8|C>>>24,b[V]=C,k?(k=z^w[w[w[U^z]]],M^=w[w[M]]):k=M=1}})();var I=[0,1,2,4,8,16,32,64,128,27,54],A=s.AES=n.extend({_doReset:function(){var w;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var N=this._keyPriorReset=this._key,k=N.words,M=N.sigBytes/4,V=this._nRounds=M+6,z=(V+1)*4,W=this._keySchedule=[],U=0;U<z;U++)U<M?W[U]=k[U]:(w=W[U-1],U%M?M>6&&U%M==4&&(w=f[w>>>24]<<24|f[w>>>16&255]<<16|f[w>>>8&255]<<8|f[w&255]):(w=w<<8|w>>>24,w=f[w>>>24]<<24|f[w>>>16&255]<<16|f[w>>>8&255]<<8|f[w&255],w^=I[U/M|0]<<24),W[U]=W[U-M]^w);for(var C=this._invKeySchedule=[],d=0;d<z;d++){var U=z-d;if(d%4)var w=W[U];else var w=W[U-4];d<4||U<=4?C[d]=w:C[d]=g[f[w>>>24]]^v[f[w>>>16&255]]^y[f[w>>>8&255]]^b[f[w&255]]}}},encryptBlock:function(w,N){this._doCryptBlock(w,N,this._keySchedule,o,c,l,h,f)},decryptBlock:function(w,N){var k=w[N+1];w[N+1]=w[N+3],w[N+3]=k,this._doCryptBlock(w,N,this._invKeySchedule,g,v,y,b,u);var k=w[N+1];w[N+1]=w[N+3],w[N+3]=k},_doCryptBlock:function(w,N,k,M,V,z,W,U){for(var C=this._nRounds,d=w[N]^k[0],x=w[N+1]^k[1],m=w[N+2]^k[2],S=w[N+3]^k[3],D=4,F=1;F<C;F++){var P=M[d>>>24]^V[x>>>16&255]^z[m>>>8&255]^W[S&255]^k[D++],R=M[x>>>24]^V[m>>>16&255]^z[S>>>8&255]^W[d&255]^k[D++],p=M[m>>>24]^V[S>>>16&255]^z[d>>>8&255]^W[x&255]^k[D++],E=M[S>>>24]^V[d>>>16&255]^z[x>>>8&255]^W[m&255]^k[D++];d=P,x=R,m=p,S=E}var P=(U[d>>>24]<<24|U[x>>>16&255]<<16|U[m>>>8&255]<<8|U[S&255])^k[D++],R=(U[x>>>24]<<24|U[m>>>16&255]<<16|U[S>>>8&255]<<8|U[d&255])^k[D++],p=(U[m>>>24]<<24|U[S>>>16&255]<<16|U[d>>>8&255]<<8|U[x&255])^k[D++],E=(U[S>>>24]<<24|U[d>>>16&255]<<16|U[x>>>8&255]<<8|U[m&255])^k[D++];w[N]=P,w[N+1]=R,w[N+2]=p,w[N+3]=E},keySize:256/32});r.AES=n._createHelper(A)}(),a.AES})}(pn)),pn.exports}var xn={exports:{}},wf;function yh(){return wf||(wf=1,function(e,t){(function(a,r,i){e.exports=r(_e(),v0(),p0(),Xr(),It())})(be,function(a){return function(){var r=a,i=r.lib,n=i.WordArray,s=i.BlockCipher,f=r.algo,u=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],o=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],l=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],h=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],g=f.DES=s.extend({_doReset:function(){for(var I=this._key,A=I.words,w=[],N=0;N<56;N++){var k=u[N]-1;w[N]=A[k>>>5]>>>31-k%32&1}for(var M=this._subKeys=[],V=0;V<16;V++){for(var z=M[V]=[],W=c[V],N=0;N<24;N++)z[N/6|0]|=w[(o[N]-1+W)%28]<<31-N%6,z[4+(N/6|0)]|=w[28+(o[N+24]-1+W)%28]<<31-N%6;z[0]=z[0]<<1|z[0]>>>31;for(var N=1;N<7;N++)z[N]=z[N]>>>(N-1)*4+3;z[7]=z[7]<<5|z[7]>>>27}for(var U=this._invSubKeys=[],N=0;N<16;N++)U[N]=M[15-N]},encryptBlock:function(I,A){this._doCryptBlock(I,A,this._subKeys)},decryptBlock:function(I,A){this._doCryptBlock(I,A,this._invSubKeys)},_doCryptBlock:function(I,A,w){this._lBlock=I[A],this._rBlock=I[A+1],v.call(this,4,252645135),v.call(this,16,65535),y.call(this,2,858993459),y.call(this,8,16711935),v.call(this,1,1431655765);for(var N=0;N<16;N++){for(var k=w[N],M=this._lBlock,V=this._rBlock,z=0,W=0;W<8;W++)z|=l[W][((V^k[W])&h[W])>>>0];this._lBlock=V,this._rBlock=M^z}var U=this._lBlock;this._lBlock=this._rBlock,this._rBlock=U,v.call(this,1,1431655765),y.call(this,8,16711935),y.call(this,2,858993459),v.call(this,16,65535),v.call(this,4,252645135),I[A]=this._lBlock,I[A+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function v(I,A){var w=(this._lBlock>>>I^this._rBlock)&A;this._rBlock^=w,this._lBlock^=w<<I}function y(I,A){var w=(this._rBlock>>>I^this._lBlock)&A;this._lBlock^=w,this._rBlock^=w<<I}r.DES=s._createHelper(g);var b=f.TripleDES=s.extend({_doReset:function(){var I=this._key,A=I.words;if(A.length!==2&&A.length!==4&&A.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var w=A.slice(0,2),N=A.length<4?A.slice(0,2):A.slice(2,4),k=A.length<6?A.slice(0,2):A.slice(4,6);this._des1=g.createEncryptor(n.create(w)),this._des2=g.createEncryptor(n.create(N)),this._des3=g.createEncryptor(n.create(k))},encryptBlock:function(I,A){this._des1.encryptBlock(I,A),this._des2.decryptBlock(I,A),this._des3.encryptBlock(I,A)},decryptBlock:function(I,A){this._des3.decryptBlock(I,A),this._des2.encryptBlock(I,A),this._des1.decryptBlock(I,A)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=s._createHelper(b)}(),a.TripleDES})}(xn)),xn.exports}var gn={exports:{}},Df;function bh(){return Df||(Df=1,function(e,t){(function(a,r,i){e.exports=r(_e(),v0(),p0(),Xr(),It())})(be,function(a){return function(){var r=a,i=r.lib,n=i.StreamCipher,s=r.algo,f=s.RC4=n.extend({_doReset:function(){for(var c=this._key,l=c.words,h=c.sigBytes,g=this._S=[],v=0;v<256;v++)g[v]=v;for(var v=0,y=0;v<256;v++){var b=v%h,I=l[b>>>2]>>>24-b%4*8&255;y=(y+g[v]+I)%256;var A=g[v];g[v]=g[y],g[y]=A}this._i=this._j=0},_doProcessBlock:function(c,l){c[l]^=u.call(this)},keySize:256/32,ivSize:0});function u(){for(var c=this._S,l=this._i,h=this._j,g=0,v=0;v<4;v++){l=(l+1)%256,h=(h+c[l])%256;var y=c[l];c[l]=c[h],c[h]=y,g|=c[(c[l]+c[h])%256]<<24-v*8}return this._i=l,this._j=h,g}r.RC4=n._createHelper(f);var o=s.RC4Drop=f.extend({cfg:f.cfg.extend({drop:192}),_doReset:function(){f._doReset.call(this);for(var c=this.cfg.drop;c>0;c--)u.call(this)}});r.RC4Drop=n._createHelper(o)}(),a.RC4})}(gn)),gn.exports}var yn={exports:{}},Nf;function mh(){return Nf||(Nf=1,function(e,t){(function(a,r,i){e.exports=r(_e(),v0(),p0(),Xr(),It())})(be,function(a){return function(){var r=a,i=r.lib,n=i.StreamCipher,s=r.algo,f=[],u=[],o=[],c=s.Rabbit=n.extend({_doReset:function(){for(var h=this._key.words,g=this.cfg.iv,v=0;v<4;v++)h[v]=(h[v]<<8|h[v]>>>24)&16711935|(h[v]<<24|h[v]>>>8)&4278255360;var y=this._X=[h[0],h[3]<<16|h[2]>>>16,h[1],h[0]<<16|h[3]>>>16,h[2],h[1]<<16|h[0]>>>16,h[3],h[2]<<16|h[1]>>>16],b=this._C=[h[2]<<16|h[2]>>>16,h[0]&4294901760|h[1]&65535,h[3]<<16|h[3]>>>16,h[1]&4294901760|h[2]&65535,h[0]<<16|h[0]>>>16,h[2]&4294901760|h[3]&65535,h[1]<<16|h[1]>>>16,h[3]&4294901760|h[0]&65535];this._b=0;for(var v=0;v<4;v++)l.call(this);for(var v=0;v<8;v++)b[v]^=y[v+4&7];if(g){var I=g.words,A=I[0],w=I[1],N=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,k=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,M=N>>>16|k&4294901760,V=k<<16|N&65535;b[0]^=N,b[1]^=M,b[2]^=k,b[3]^=V,b[4]^=N,b[5]^=M,b[6]^=k,b[7]^=V;for(var v=0;v<4;v++)l.call(this)}},_doProcessBlock:function(h,g){var v=this._X;l.call(this),f[0]=v[0]^v[5]>>>16^v[3]<<16,f[1]=v[2]^v[7]>>>16^v[5]<<16,f[2]=v[4]^v[1]>>>16^v[7]<<16,f[3]=v[6]^v[3]>>>16^v[1]<<16;for(var y=0;y<4;y++)f[y]=(f[y]<<8|f[y]>>>24)&16711935|(f[y]<<24|f[y]>>>8)&4278255360,h[g+y]^=f[y]},blockSize:128/32,ivSize:64/32});function l(){for(var h=this._X,g=this._C,v=0;v<8;v++)u[v]=g[v];g[0]=g[0]+1295307597+this._b|0,g[1]=g[1]+3545052371+(g[0]>>>0<u[0]>>>0?1:0)|0,g[2]=g[2]+886263092+(g[1]>>>0<u[1]>>>0?1:0)|0,g[3]=g[3]+1295307597+(g[2]>>>0<u[2]>>>0?1:0)|0,g[4]=g[4]+3545052371+(g[3]>>>0<u[3]>>>0?1:0)|0,g[5]=g[5]+886263092+(g[4]>>>0<u[4]>>>0?1:0)|0,g[6]=g[6]+1295307597+(g[5]>>>0<u[5]>>>0?1:0)|0,g[7]=g[7]+3545052371+(g[6]>>>0<u[6]>>>0?1:0)|0,this._b=g[7]>>>0<u[7]>>>0?1:0;for(var v=0;v<8;v++){var y=h[v]+g[v],b=y&65535,I=y>>>16,A=((b*b>>>17)+b*I>>>15)+I*I,w=((y&4294901760)*y|0)+((y&65535)*y|0);o[v]=A^w}h[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,h[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,h[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,h[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,h[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,h[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,h[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,h[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}r.Rabbit=n._createHelper(c)}(),a.Rabbit})}(yn)),yn.exports}var bn={exports:{}},Rf;function Ch(){return Rf||(Rf=1,function(e,t){(function(a,r,i){e.exports=r(_e(),v0(),p0(),Xr(),It())})(be,function(a){return function(){var r=a,i=r.lib,n=i.StreamCipher,s=r.algo,f=[],u=[],o=[],c=s.RabbitLegacy=n.extend({_doReset:function(){var h=this._key.words,g=this.cfg.iv,v=this._X=[h[0],h[3]<<16|h[2]>>>16,h[1],h[0]<<16|h[3]>>>16,h[2],h[1]<<16|h[0]>>>16,h[3],h[2]<<16|h[1]>>>16],y=this._C=[h[2]<<16|h[2]>>>16,h[0]&4294901760|h[1]&65535,h[3]<<16|h[3]>>>16,h[1]&4294901760|h[2]&65535,h[0]<<16|h[0]>>>16,h[2]&4294901760|h[3]&65535,h[1]<<16|h[1]>>>16,h[3]&4294901760|h[0]&65535];this._b=0;for(var b=0;b<4;b++)l.call(this);for(var b=0;b<8;b++)y[b]^=v[b+4&7];if(g){var I=g.words,A=I[0],w=I[1],N=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,k=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,M=N>>>16|k&4294901760,V=k<<16|N&65535;y[0]^=N,y[1]^=M,y[2]^=k,y[3]^=V,y[4]^=N,y[5]^=M,y[6]^=k,y[7]^=V;for(var b=0;b<4;b++)l.call(this)}},_doProcessBlock:function(h,g){var v=this._X;l.call(this),f[0]=v[0]^v[5]>>>16^v[3]<<16,f[1]=v[2]^v[7]>>>16^v[5]<<16,f[2]=v[4]^v[1]>>>16^v[7]<<16,f[3]=v[6]^v[3]>>>16^v[1]<<16;for(var y=0;y<4;y++)f[y]=(f[y]<<8|f[y]>>>24)&16711935|(f[y]<<24|f[y]>>>8)&4278255360,h[g+y]^=f[y]},blockSize:128/32,ivSize:64/32});function l(){for(var h=this._X,g=this._C,v=0;v<8;v++)u[v]=g[v];g[0]=g[0]+1295307597+this._b|0,g[1]=g[1]+3545052371+(g[0]>>>0<u[0]>>>0?1:0)|0,g[2]=g[2]+886263092+(g[1]>>>0<u[1]>>>0?1:0)|0,g[3]=g[3]+1295307597+(g[2]>>>0<u[2]>>>0?1:0)|0,g[4]=g[4]+3545052371+(g[3]>>>0<u[3]>>>0?1:0)|0,g[5]=g[5]+886263092+(g[4]>>>0<u[4]>>>0?1:0)|0,g[6]=g[6]+1295307597+(g[5]>>>0<u[5]>>>0?1:0)|0,g[7]=g[7]+3545052371+(g[6]>>>0<u[6]>>>0?1:0)|0,this._b=g[7]>>>0<u[7]>>>0?1:0;for(var v=0;v<8;v++){var y=h[v]+g[v],b=y&65535,I=y>>>16,A=((b*b>>>17)+b*I>>>15)+I*I,w=((y&4294901760)*y|0)+((y&65535)*y|0);o[v]=A^w}h[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,h[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,h[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,h[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,h[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,h[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,h[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,h[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}r.RabbitLegacy=n._createHelper(c)}(),a.RabbitLegacy})}(bn)),bn.exports}var mn={exports:{}},Ff;function Eh(){return Ff||(Ff=1,function(e,t){(function(a,r,i){e.exports=r(_e(),v0(),p0(),Xr(),It())})(be,function(a){return function(){var r=a,i=r.lib,n=i.BlockCipher,s=r.algo;const f=16,u=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],o=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var c={pbox:[],sbox:[]};function l(b,I){let A=I>>24&255,w=I>>16&255,N=I>>8&255,k=I&255,M=b.sbox[0][A]+b.sbox[1][w];return M=M^b.sbox[2][N],M=M+b.sbox[3][k],M}function h(b,I,A){let w=I,N=A,k;for(let M=0;M<f;++M)w=w^b.pbox[M],N=l(b,w)^N,k=w,w=N,N=k;return k=w,w=N,N=k,N=N^b.pbox[f],w=w^b.pbox[f+1],{left:w,right:N}}function g(b,I,A){let w=I,N=A,k;for(let M=f+1;M>1;--M)w=w^b.pbox[M],N=l(b,w)^N,k=w,w=N,N=k;return k=w,w=N,N=k,N=N^b.pbox[1],w=w^b.pbox[0],{left:w,right:N}}function v(b,I,A){for(let V=0;V<4;V++){b.sbox[V]=[];for(let z=0;z<256;z++)b.sbox[V][z]=o[V][z]}let w=0;for(let V=0;V<f+2;V++)b.pbox[V]=u[V]^I[w],w++,w>=A&&(w=0);let N=0,k=0,M=0;for(let V=0;V<f+2;V+=2)M=h(b,N,k),N=M.left,k=M.right,b.pbox[V]=N,b.pbox[V+1]=k;for(let V=0;V<4;V++)for(let z=0;z<256;z+=2)M=h(b,N,k),N=M.left,k=M.right,b.sbox[V][z]=N,b.sbox[V][z+1]=k;return!0}var y=s.Blowfish=n.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var b=this._keyPriorReset=this._key,I=b.words,A=b.sigBytes/4;v(c,I,A)}},encryptBlock:function(b,I){var A=h(c,b[I],b[I+1]);b[I]=A.left,b[I+1]=A.right},decryptBlock:function(b,I){var A=g(c,b[I],b[I+1]);b[I]=A.left,b[I+1]=A.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=n._createHelper(y)}(),a.Blowfish})}(mn)),mn.exports}(function(e,t){(function(a,r,i){e.exports=r(_e(),ei(),Zl(),Jl(),v0(),eh(),p0(),uc(),ps(),th(),dc(),rh(),ah(),ih(),xs(),nh(),Xr(),It(),sh(),fh(),oh(),ch(),uh(),dh(),lh(),hh(),vh(),ph(),xh(),gh(),yh(),bh(),mh(),Ch(),Eh())})(be,function(a){return a})})(cc);var Ah=cc.exports;const Sh=co(Ah);var me={options:{usePureJavaScript:!1}},gs={},Bh=gs,kf={};gs.encode=function(e,t,a){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(a!==void 0&&typeof a!="number")throw new TypeError('"maxline" must be a number.');var r="";if(!(e instanceof Uint8Array))r=_h(e,t);else{var i=0,n=t.length,s=t.charAt(0),f=[0];for(i=0;i<e.length;++i){for(var u=0,o=e[i];u<f.length;++u)o+=f[u]<<8,f[u]=o%n,o=o/n|0;for(;o>0;)f.push(o%n),o=o/n|0}for(i=0;e[i]===0&&i<e.length-1;++i)r+=s;for(i=f.length-1;i>=0;--i)r+=t[f[i]]}if(a){var c=new RegExp(".{1,"+a+"}","g");r=r.match(c).join(`\r
`)}return r};gs.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var a=kf[t];if(!a){a=kf[t]=[];for(var r=0;r<t.length;++r)a[t.charCodeAt(r)]=r}e=e.replace(/\s/g,"");for(var i=t.length,n=t.charAt(0),s=[0],r=0;r<e.length;r++){var f=a[e.charCodeAt(r)];if(f===void 0)return;for(var u=0,o=f;u<s.length;++u)o+=s[u]*i,s[u]=o&255,o>>=8;for(;o>0;)s.push(o&255),o>>=8}for(var c=0;e[c]===n&&c<e.length-1;++c)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function _h(e,t){var a=0,r=t.length,i=t.charAt(0),n=[0];for(a=0;a<e.length();++a){for(var s=0,f=e.at(a);s<n.length;++s)f+=n[s]<<8,n[s]=f%r,f=f/r|0;for(;f>0;)n.push(f%r),f=f/r|0}var u="";for(a=0;e.at(a)===0&&a<e.length()-1;++a)u+=i;for(a=n.length-1;a>=0;--a)u+=t[n[a]];return u}var Mf=me,Lf=Bh,K=Mf.util=Mf.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){K.nextTick=process.nextTick,typeof setImmediate=="function"?K.setImmediate=setImmediate:K.setImmediate=K.nextTick;return}if(typeof setImmediate=="function"){K.setImmediate=function(){return setImmediate.apply(void 0,arguments)},K.nextTick=function(s){return setImmediate(s)};return}if(K.setImmediate=function(s){setTimeout(s,0)},typeof window<"u"&&typeof window.postMessage=="function"){let s=function(f){if(f.source===window&&f.data===e){f.stopPropagation();var u=t.slice();t.length=0,u.forEach(function(o){o()})}};var e="forge.setImmediate",t=[];K.setImmediate=function(f){t.push(f),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",s,!0)}if(typeof MutationObserver<"u"){var a=Date.now(),r=!0,i=document.createElement("div"),t=[];new MutationObserver(function(){var f=t.slice();t.length=0,f.forEach(function(u){u()})}).observe(i,{attributes:!0});var n=K.setImmediate;K.setImmediate=function(f){Date.now()-a>15?(a=Date.now(),n(f)):(t.push(f),t.length===1&&i.setAttribute("a",r=!r))}}K.nextTick=K.setImmediate})();K.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;K.globalScope=function(){return K.isNodejs?be:typeof self>"u"?window:self}();K.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};K.isArrayBuffer=function(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer};K.isArrayBufferView=function(e){return e&&K.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function fa(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}K.ByteBuffer=ys;function ys(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(K.isArrayBuffer(e)||K.isArrayBufferView(e))if(typeof Buffer<"u"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch{for(var a=0;a<t.length;++a)this.putByte(t[a])}}else(e instanceof ys||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}K.ByteStringBuffer=ys;var Ih=4096;K.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>Ih&&(this.data.substr(0,1),this._constructedStringLength=0)};K.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};K.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};K.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};K.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var a=this.data;t>0;)t&1&&(a+=e),t>>>=1,t>0&&(e+=e);return this.data=a,this._optimizeConstructedString(t),this};K.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};K.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(K.encodeUtf8(e))};K.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};K.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};K.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};K.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};K.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};K.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};K.ByteStringBuffer.prototype.putInt=function(e,t){fa(t);var a="";do t-=8,a+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(a)};K.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};K.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};K.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};K.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};K.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};K.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};K.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};K.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};K.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};K.ByteStringBuffer.prototype.getInt=function(e){fa(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};K.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),a=2<<e-2;return t>=a&&(t-=a<<1),t};K.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};K.ByteStringBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};K.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};K.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};K.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};K.ByteStringBuffer.prototype.copy=function(){var e=K.createBuffer(this.data);return e.read=this.read,e};K.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};K.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};K.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};K.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var a=this.data.charCodeAt(t);a<16&&(e+="0"),e+=a.toString(16)}return e};K.ByteStringBuffer.prototype.toString=function(){return K.decodeUtf8(this.bytes())};function Th(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var a=K.isArrayBuffer(e),r=K.isArrayBufferView(e);if(a||r){a?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}K.DataBuffer=Th;K.DataBuffer.prototype.length=function(){return this.write-this.read};K.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};K.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var a=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),r=new Uint8Array(this.length()+t);return r.set(a),this.data=new DataView(r.buffer),this};K.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};K.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var a=0;a<t;++a)this.data.setUint8(e);return this};K.DataBuffer.prototype.putBytes=function(e,t){if(K.isArrayBufferView(e)){var a=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),r=a.byteLength-a.byteOffset;this.accommodate(r);var i=new Uint8Array(this.data.buffer,this.write);return i.set(a),this.write+=r,this}if(K.isArrayBuffer(e)){var a=new Uint8Array(e);this.accommodate(a.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(a,this.write),this.write+=a.byteLength,this}if(e instanceof K.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&K.isArrayBufferView(e.data)){var a=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(a.byteLength);var i=new Uint8Array(e.data.byteLength,this.write);return i.set(a),this.write+=a.byteLength,this}if(e instanceof K.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var n;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),n=new Uint8Array(this.data.buffer,this.write),this.write+=K.binary.hex.decode(e,n,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),n=new Uint8Array(this.data.buffer,this.write),this.write+=K.binary.base64.decode(e,n,this.write),this;if(t==="utf8"&&(e=K.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),n=new Uint8Array(this.data.buffer,this.write),this.write+=K.binary.raw.decode(n),this;if(t==="utf16")return this.accommodate(e.length*2),n=new Uint16Array(this.data.buffer,this.write),this.write+=K.text.utf16.encode(n),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};K.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};K.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};K.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};K.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};K.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};K.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};K.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};K.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};K.DataBuffer.prototype.putInt=function(e,t){fa(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};K.DataBuffer.prototype.putSignedInt=function(e,t){return fa(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};K.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};K.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};K.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};K.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};K.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};K.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};K.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};K.DataBuffer.prototype.getInt=function(e){fa(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};K.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),a=2<<e-2;return t>=a&&(t-=a<<1),t};K.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};K.DataBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};K.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};K.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};K.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};K.DataBuffer.prototype.copy=function(){return new K.DataBuffer(this)};K.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};K.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};K.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};K.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var a=this.data.getUint8(t);a<16&&(e+="0"),e+=a.toString(16)}return e};K.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return K.binary.raw.encode(t);if(e==="hex")return K.binary.hex.encode(t);if(e==="base64")return K.binary.base64.encode(t);if(e==="utf8")return K.text.utf8.decode(t);if(e==="utf16")return K.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};K.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=K.encodeUtf8(e)),new K.ByteBuffer(e)};K.fillString=function(e,t){for(var a="";t>0;)t&1&&(a+=e),t>>>=1,t>0&&(e+=e);return a};K.xorBytes=function(e,t,a){for(var r="",i="",n="",s=0,f=0;a>0;--a,++s)i=e.charCodeAt(s)^t.charCodeAt(s),f>=10&&(r+=n,n="",f=0),n+=String.fromCharCode(i),++f;return r+=n,r};K.hexToBytes=function(e){var t="",a=0;for(e.length&!0&&(a=1,t+=String.fromCharCode(parseInt(e[0],16)));a<e.length;a+=2)t+=String.fromCharCode(parseInt(e.substr(a,2),16));return t};K.bytesToHex=function(e){return K.createBuffer(e).toHex()};K.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var Vr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Kr=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],lc="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";K.encode64=function(e,t){for(var a="",r="",i,n,s,f=0;f<e.length;)i=e.charCodeAt(f++),n=e.charCodeAt(f++),s=e.charCodeAt(f++),a+=Vr.charAt(i>>2),a+=Vr.charAt((i&3)<<4|n>>4),isNaN(n)?a+="==":(a+=Vr.charAt((n&15)<<2|s>>6),a+=isNaN(s)?"=":Vr.charAt(s&63)),t&&a.length>t&&(r+=a.substr(0,t)+`\r
`,a=a.substr(t));return r+=a,r};K.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",a,r,i,n,s=0;s<e.length;)a=Kr[e.charCodeAt(s++)-43],r=Kr[e.charCodeAt(s++)-43],i=Kr[e.charCodeAt(s++)-43],n=Kr[e.charCodeAt(s++)-43],t+=String.fromCharCode(a<<2|r>>4),i!==64&&(t+=String.fromCharCode((r&15)<<4|i>>2),n!==64&&(t+=String.fromCharCode((i&3)<<6|n)));return t};K.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};K.decodeUtf8=function(e){return decodeURIComponent(escape(e))};K.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Lf.encode,decode:Lf.decode}};K.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};K.binary.raw.decode=function(e,t,a){var r=t;r||(r=new Uint8Array(e.length)),a=a||0;for(var i=a,n=0;n<e.length;++n)r[i++]=e.charCodeAt(n);return t?i-a:r};K.binary.hex.encode=K.bytesToHex;K.binary.hex.decode=function(e,t,a){var r=t;r||(r=new Uint8Array(Math.ceil(e.length/2))),a=a||0;var i=0,n=a;for(e.length&1&&(i=1,r[n++]=parseInt(e[0],16));i<e.length;i+=2)r[n++]=parseInt(e.substr(i,2),16);return t?n-a:r};K.binary.base64.encode=function(e,t){for(var a="",r="",i,n,s,f=0;f<e.byteLength;)i=e[f++],n=e[f++],s=e[f++],a+=Vr.charAt(i>>2),a+=Vr.charAt((i&3)<<4|n>>4),isNaN(n)?a+="==":(a+=Vr.charAt((n&15)<<2|s>>6),a+=isNaN(s)?"=":Vr.charAt(s&63)),t&&a.length>t&&(r+=a.substr(0,t)+`\r
`,a=a.substr(t));return r+=a,r};K.binary.base64.decode=function(e,t,a){var r=t;r||(r=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),a=a||0;for(var i,n,s,f,u=0,o=a;u<e.length;)i=Kr[e.charCodeAt(u++)-43],n=Kr[e.charCodeAt(u++)-43],s=Kr[e.charCodeAt(u++)-43],f=Kr[e.charCodeAt(u++)-43],r[o++]=i<<2|n>>4,s!==64&&(r[o++]=(n&15)<<4|s>>2,f!==64&&(r[o++]=(s&3)<<6|f));return t?o-a:r.subarray(0,o)};K.binary.base58.encode=function(e,t){return K.binary.baseN.encode(e,lc,t)};K.binary.base58.decode=function(e,t){return K.binary.baseN.decode(e,lc,t)};K.text={utf8:{},utf16:{}};K.text.utf8.encode=function(e,t,a){e=K.encodeUtf8(e);var r=t;r||(r=new Uint8Array(e.length)),a=a||0;for(var i=a,n=0;n<e.length;++n)r[i++]=e.charCodeAt(n);return t?i-a:r};K.text.utf8.decode=function(e){return K.decodeUtf8(String.fromCharCode.apply(null,e))};K.text.utf16.encode=function(e,t,a){var r=t;r||(r=new Uint8Array(e.length*2));var i=new Uint16Array(r.buffer);a=a||0;for(var n=a,s=a,f=0;f<e.length;++f)i[s++]=e.charCodeAt(f),n+=2;return t?n-a:r};K.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};K.deflate=function(e,t,a){if(t=K.decode64(e.deflate(K.encode64(t)).rval),a){var r=2,i=t.charCodeAt(1);i&32&&(r=6),t=t.substring(r,t.length-4)}return t};K.inflate=function(e,t,a){var r=e.inflate(K.encode64(t)).rval;return r===null?null:K.decode64(r)};var bs=function(e,t,a){if(!e)throw new Error("WebStorage not available.");var r;if(a===null?r=e.removeItem(t):(a=K.encode64(JSON.stringify(a)),r=e.setItem(t,a)),typeof r<"u"&&r.rval!==!0){var i=new Error(r.error.message);throw i.id=r.error.id,i.name=r.error.name,i}},ms=function(e,t){if(!e)throw new Error("WebStorage not available.");var a=e.getItem(t);if(e.init)if(a.rval===null){if(a.error){var r=new Error(a.error.message);throw r.id=a.error.id,r.name=a.error.name,r}a=null}else a=a.rval;return a!==null&&(a=JSON.parse(K.decode64(a))),a},wh=function(e,t,a,r){var i=ms(e,t);i===null&&(i={}),i[a]=r,bs(e,t,i)},Dh=function(e,t,a){var r=ms(e,t);return r!==null&&(r=a in r?r[a]:null),r},Nh=function(e,t,a){var r=ms(e,t);if(r!==null&&a in r){delete r[a];var i=!0;for(var n in r){i=!1;break}i&&(r=null),bs(e,t,r)}},Rh=function(e,t){bs(e,t,null)},ti=function(e,t,a){var r=null;typeof a>"u"&&(a=["web","flash"]);var i,n=!1,s=null;for(var f in a){i=a[f];try{if(i==="flash"||i==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");r=e.apply(this,t),n=i==="flash"}(i==="web"||i==="both")&&(t[0]=localStorage,r=e.apply(this,t),n=!0)}catch(u){s=u}if(n)break}if(!n)throw s;return r};K.setItem=function(e,t,a,r,i){ti(wh,arguments,i)};K.getItem=function(e,t,a,r){return ti(Dh,arguments,r)};K.removeItem=function(e,t,a,r){ti(Nh,arguments,r)};K.clearItems=function(e,t,a){ti(Rh,arguments,a)};K.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};K.format=function(e){for(var t=/%./g,a,r,i=0,n=[],s=0;a=t.exec(e);){r=e.substring(s,t.lastIndex-2),r.length>0&&n.push(r),s=t.lastIndex;var f=a[0][1];switch(f){case"s":case"o":i<arguments.length?n.push(arguments[i+++1]):n.push("<?>");break;case"%":n.push("%");break;default:n.push("<%"+f+"?>")}}return n.push(e.substring(s)),n.join("")};K.formatNumber=function(e,t,a,r){var i=e,n=isNaN(t=Math.abs(t))?2:t,s=a===void 0?",":a,f=r===void 0?".":r,u=i<0?"-":"",o=parseInt(i=Math.abs(+i||0).toFixed(n),10)+"",c=o.length>3?o.length%3:0;return u+(c?o.substr(0,c)+f:"")+o.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+f)+(n?s+Math.abs(i-o).toFixed(n).slice(2):"")};K.formatSize=function(e){return e>=1073741824?e=K.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=K.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=K.formatNumber(e/1024,0)+" KiB":e=K.formatNumber(e,0)+" bytes",e};K.bytesFromIP=function(e){return e.indexOf(".")!==-1?K.bytesFromIPv4(e):e.indexOf(":")!==-1?K.bytesFromIPv6(e):null};K.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=K.createBuffer(),a=0;a<e.length;++a){var r=parseInt(e[a],10);if(isNaN(r))return null;t.putByte(r)}return t.getBytes()};K.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(s){return s.length===0&&++t,!0});for(var a=(8-e.length+t)*2,r=K.createBuffer(),i=0;i<8;++i){if(!e[i]||e[i].length===0){r.fillWithByte(0,a),a=0;continue}var n=K.hexToBytes(e[i]);n.length<2&&r.putByte(0),r.putBytes(n)}return r.getBytes()};K.bytesToIP=function(e){return e.length===4?K.bytesToIPv4(e):e.length===16?K.bytesToIPv6(e):null};K.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],a=0;a<e.length;++a)t.push(e.charCodeAt(a));return t.join(".")};K.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],a=[],r=0,i=0;i<e.length;i+=2){for(var n=K.bytesToHex(e[i]+e[i+1]);n[0]==="0"&&n!=="0";)n=n.substr(1);if(n==="0"){var s=a[a.length-1],f=t.length;!s||f!==s.end+1?a.push({start:f,end:f}):(s.end=f,s.end-s.start>a[r].end-a[r].start&&(r=a.length-1))}t.push(n)}if(a.length>0){var u=a[r];u.end-u.start>0&&(t.splice(u.start,u.end-u.start+1,""),u.start===0&&t.unshift(""),u.end===7&&t.push(""))}return t.join(":")};K.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in K&&!e.update)return t(null,K.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return K.cores=navigator.hardwareConcurrency,t(null,K.cores);if(typeof Worker>"u")return K.cores=1,t(null,K.cores);if(typeof Blob>"u")return K.cores=2,t(null,K.cores);var a=URL.createObjectURL(new Blob(["(",(function(){self.addEventListener("message",function(s){var f=Date.now(),u=f+4;self.postMessage({st:f,et:u})})}).toString(),")()"],{type:"application/javascript"}));r([],5,16);function r(s,f,u){if(f===0){var o=Math.floor(s.reduce(function(c,l){return c+l},0)/s.length);return K.cores=Math.max(1,o),URL.revokeObjectURL(a),t(null,K.cores)}i(u,function(c,l){s.push(n(u,l)),r(s,f-1,u)})}function i(s,f){for(var u=[],o=[],c=0;c<s;++c){var l=new Worker(a);l.addEventListener("message",function(h){if(o.push(h.data),o.length===s){for(var g=0;g<s;++g)u[g].terminate();f(null,o)}}),u.push(l)}for(var c=0;c<s;++c)u[c].postMessage(c)}function n(s,f){for(var u=[],o=0;o<s;++o)for(var c=f[o],l=u[o]=[],h=0;h<s;++h)if(o!==h){var g=f[h];(c.st>g.st&&c.st<g.et||g.st>c.st&&g.st<c.et)&&l.push(h)}return u.reduce(function(v,y){return Math.max(v,y.length)},0)}};var St=me;St.cipher=St.cipher||{};St.cipher.algorithms=St.cipher.algorithms||{};St.cipher.createCipher=function(e,t){var a=e;if(typeof a=="string"&&(a=St.cipher.getAlgorithm(a),a&&(a=a())),!a)throw new Error("Unsupported algorithm: "+e);return new St.cipher.BlockCipher({algorithm:a,key:t,decrypt:!1})};St.cipher.createDecipher=function(e,t){var a=e;if(typeof a=="string"&&(a=St.cipher.getAlgorithm(a),a&&(a=a())),!a)throw new Error("Unsupported algorithm: "+e);return new St.cipher.BlockCipher({algorithm:a,key:t,decrypt:!0})};St.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),St.cipher.algorithms[e]=t};St.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in St.cipher.algorithms?St.cipher.algorithms[e]:null};var Cs=St.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};Cs.prototype.start=function(e){e=e||{};var t={};for(var a in e)t[a]=e[a];t.decrypt=this._decrypt,this._finish=!1,this._input=St.util.createBuffer(),this.output=e.output||St.util.createBuffer(),this.mode.start(t)};Cs.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Cs.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(a){return e(this.blockSize,a,!1)},this.mode.unpad=function(a){return e(this.blockSize,a,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))};var Et=me;Et.cipher=Et.cipher||{};var Ae=Et.cipher.modes=Et.cipher.modes||{};Ae.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Ae.ecb.prototype.start=function(e){};Ae.ecb.prototype.encrypt=function(e,t,a){if(e.length()<this.blockSize&&!(a&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r])};Ae.ecb.prototype.decrypt=function(e,t,a){if(e.length()<this.blockSize&&!(a&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r])};Ae.ecb.prototype.pad=function(e,t){var a=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(a,a),!0};Ae.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var a=e.length(),r=e.at(a-1);return r>this.blockSize<<2?!1:(e.truncate(r),!0)};Ae.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Ae.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=ri(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};Ae.cbc.prototype.encrypt=function(e,t,a){if(e.length()<this.blockSize&&!(a&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=this._prev[r]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r]);this._prev=this._outBlock};Ae.cbc.prototype.decrypt=function(e,t,a){if(e.length()<this.blockSize&&!(a&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._prev[r]^this._outBlock[r]);this._prev=this._inBlock.slice(0)};Ae.cbc.prototype.pad=function(e,t){var a=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(a,a),!0};Ae.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var a=e.length(),r=e.at(a-1);return r>this.blockSize<<2?!1:(e.truncate(r),!0)};Ae.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Et.util.createBuffer(),this._partialBytes=0};Ae.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=ri(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ae.cfb.prototype.encrypt=function(e,t,a){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);return}var n=(this.blockSize-r)%this.blockSize;n>0&&(n=this.blockSize-n),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(n>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),n>0&&!a)return t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=n,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};Ae.cfb.prototype.decrypt=function(e,t,a){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);return}var n=(this.blockSize-r)%this.blockSize;n>0&&(n=this.blockSize-n),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(n>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),n>0&&!a)return t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=n,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};Ae.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Et.util.createBuffer(),this._partialBytes=0};Ae.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=ri(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ae.ofb.prototype.encrypt=function(e,t,a){var r=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var n=(this.blockSize-r)%this.blockSize;n>0&&(n=this.blockSize-n),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(n>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),n>0&&!a)return t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=n,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};Ae.ofb.prototype.decrypt=Ae.ofb.prototype.encrypt;Ae.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Et.util.createBuffer(),this._partialBytes=0};Ae.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=ri(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ae.ctr.prototype.encrypt=function(e,t,a){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var n=(this.blockSize-r)%this.blockSize;n>0&&(n=this.blockSize-n),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(n>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),n>0&&!a)return t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=n,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}ai(this._inBlock)};Ae.ctr.prototype.decrypt=Ae.ctr.prototype.encrypt;Ae.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Et.util.createBuffer(),this._partialBytes=0,this._R=3774873600};Ae.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=Et.util.createBuffer(e.iv);this._cipherLength=0;var a;if("additionalData"in e?a=Et.util.createBuffer(e.additionalData):a=Et.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=Et.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var r=t.length();if(r===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Rn(r*8)))}this._inBlock=this._j0.slice(0),ai(this._inBlock),this._partialBytes=0,a=Et.util.createBuffer(a),this._aDataLength=Rn(a.length()*8);var i=a.length()%this.blockSize;for(i&&a.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];a.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[a.getInt32(),a.getInt32(),a.getInt32(),a.getInt32()])};Ae.gcm.prototype.encrypt=function(e,t,a){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var n=(this.blockSize-r)%this.blockSize;n>0&&(n=this.blockSize-n),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(n<=0||a){if(a){var s=r%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),n>0&&!a)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=n,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),ai(this._inBlock)};Ae.gcm.prototype.decrypt=function(e,t,a){var r=e.length();if(r<this.blockSize&&!(a&&r>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),ai(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);r<this.blockSize?this._cipherLength+=r%this.blockSize:this._cipherLength+=this.blockSize};Ae.gcm.prototype.afterFinish=function(e,t){var a=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=Et.util.createBuffer();var r=this._aDataLength.concat(Rn(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,r);var i=[];this.cipher.encrypt(this._j0,i);for(var n=0;n<this._ints;++n)this.tag.putInt32(this._s[n]^i[n]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(a=!1),a};Ae.gcm.prototype.multiply=function(e,t){for(var a=[0,0,0,0],r=t.slice(0),i=0;i<128;++i){var n=e[i/32|0]&1<<31-i%32;n&&(a[0]^=r[0],a[1]^=r[1],a[2]^=r[2],a[3]^=r[3]),this.pow(r,r)}return a};Ae.gcm.prototype.pow=function(e,t){for(var a=e[3]&1,r=3;r>0;--r)t[r]=e[r]>>>1|(e[r-1]&1)<<31;t[0]=e[0]>>>1,a&&(t[0]^=this._R)};Ae.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],a=0;a<32;++a){var r=a/8|0,i=e[r]>>>(7-a%8)*4&15,n=this._m[a][i];t[0]^=n[0],t[1]^=n[1],t[2]^=n[2],t[3]^=n[3]}return t};Ae.gcm.prototype.ghash=function(e,t,a){return t[0]^=a[0],t[1]^=a[1],t[2]^=a[2],t[3]^=a[3],this.tableMultiply(t)};Ae.gcm.prototype.generateHashTable=function(e,t){for(var a=8/t,r=4*a,i=16*a,n=new Array(i),s=0;s<i;++s){var f=[0,0,0,0],u=s/r|0,o=(r-1-s%r)*t;f[u]=1<<t-1<<o,n[s]=this.generateSubHashTable(this.multiply(f,e),t)}return n};Ae.gcm.prototype.generateSubHashTable=function(e,t){var a=1<<t,r=a>>>1,i=new Array(a);i[r]=e.slice(0);for(var n=r>>>1;n>0;)this.pow(i[2*n],i[n]=[]),n>>=1;for(n=2;n<r;){for(var s=1;s<n;++s){var f=i[n],u=i[s];i[n+s]=[f[0]^u[0],f[1]^u[1],f[2]^u[2],f[3]^u[3]]}n*=2}for(i[0]=[0,0,0,0],n=r+1;n<a;++n){var o=i[n^r];i[n]=[e[0]^o[0],e[1]^o[1],e[2]^o[2],e[3]^o[3]]}return i};function ri(e,t){if(typeof e=="string"&&(e=Et.util.createBuffer(e)),Et.util.isArray(e)&&e.length>4){var a=e;e=Et.util.createBuffer();for(var r=0;r<a.length;++r)e.putByte(a[r])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!Et.util.isArray(e)){for(var i=[],n=t/4,r=0;r<n;++r)i.push(e.getInt32());e=i}return e}function ai(e){e[e.length-1]=e[e.length-1]+1&4294967295}function Rn(e){return[e/4294967296|0,e&4294967295]}var Ke=me;Ke.aes=Ke.aes||{};Ke.aes.startEncrypting=function(e,t,a,r){var i=ii({key:e,output:a,decrypt:!1,mode:r});return i.start(t),i};Ke.aes.createEncryptionCipher=function(e,t){return ii({key:e,output:null,decrypt:!1,mode:t})};Ke.aes.startDecrypting=function(e,t,a,r){var i=ii({key:e,output:a,decrypt:!0,mode:r});return i.start(t),i};Ke.aes.createDecryptionCipher=function(e,t){return ii({key:e,output:null,decrypt:!0,mode:t})};Ke.aes.Algorithm=function(e,t){Es||vc();var a=this;a.name=e,a.mode=new t({blockSize:16,cipher:{encrypt:function(r,i){return kn(a._w,r,i,!1)},decrypt:function(r,i){return kn(a._w,r,i,!0)}}}),a._init=!1};Ke.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,a;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=Ke.util.createBuffer(t);else if(Ke.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){a=t,t=Ke.util.createBuffer();for(var r=0;r<a.length;++r)t.putByte(a[r])}if(!Ke.util.isArray(t)){a=t,t=[];var i=a.length();if(i===16||i===24||i===32){i=i>>>2;for(var r=0;r<i;++r)t.push(a.getInt32())}}if(!Ke.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var n=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(n)!==-1;this._w=pc(t,e.decrypt&&!s),this._init=!0}};Ke.aes._expandKey=function(e,t){return Es||vc(),pc(e,t)};Ke.aes._updateBlock=kn;K0("AES-ECB",Ke.cipher.modes.ecb);K0("AES-CBC",Ke.cipher.modes.cbc);K0("AES-CFB",Ke.cipher.modes.cfb);K0("AES-OFB",Ke.cipher.modes.ofb);K0("AES-CTR",Ke.cipher.modes.ctr);K0("AES-GCM",Ke.cipher.modes.gcm);function K0(e,t){var a=function(){return new Ke.aes.Algorithm(e,t)};Ke.cipher.registerAlgorithm(e,a)}var Es=!1,b0=4,kt,Fn,hc,s0,ir;function vc(){Es=!0,hc=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;kt=new Array(256),Fn=new Array(256),s0=new Array(4),ir=new Array(4);for(var t=0;t<4;++t)s0[t]=new Array(256),ir[t]=new Array(256);for(var a=0,r=0,i,n,s,f,u,o,c,t=0;t<256;++t){f=r^r<<1^r<<2^r<<3^r<<4,f=f>>8^f&255^99,kt[a]=f,Fn[f]=a,u=e[f],i=e[a],n=e[i],s=e[n],o=u<<24^f<<16^f<<8^(f^u),c=(i^n^s)<<24^(a^s)<<16^(a^n^s)<<8^(a^i^s);for(var l=0;l<4;++l)s0[l][a]=o,ir[l][f]=c,o=o<<24|o>>>8,c=c<<24|c>>>8;a===0?a=r=1:(a=i^e[e[e[i^s]]],r^=e[e[r]])}}function pc(e,t){for(var a=e.slice(0),r,i=1,n=a.length,s=n+6+1,f=b0*s,u=n;u<f;++u)r=a[u-1],u%n===0?(r=kt[r>>>16&255]<<24^kt[r>>>8&255]<<16^kt[r&255]<<8^kt[r>>>24]^hc[i]<<24,i++):n>6&&u%n===4&&(r=kt[r>>>24]<<24^kt[r>>>16&255]<<16^kt[r>>>8&255]<<8^kt[r&255]),a[u]=a[u-n]^r;if(t){var o,c=ir[0],l=ir[1],h=ir[2],g=ir[3],v=a.slice(0);f=a.length;for(var u=0,y=f-b0;u<f;u+=b0,y-=b0)if(u===0||u===f-b0)v[u]=a[y],v[u+1]=a[y+3],v[u+2]=a[y+2],v[u+3]=a[y+1];else for(var b=0;b<b0;++b)o=a[y+b],v[u+(3&-b)]=c[kt[o>>>24]]^l[kt[o>>>16&255]]^h[kt[o>>>8&255]]^g[kt[o&255]];a=v}return a}function kn(e,t,a,r){var i=e.length/4-1,n,s,f,u,o;r?(n=ir[0],s=ir[1],f=ir[2],u=ir[3],o=Fn):(n=s0[0],s=s0[1],f=s0[2],u=s0[3],o=kt);var c,l,h,g,v,y,b;c=t[0]^e[0],l=t[r?3:1]^e[1],h=t[2]^e[2],g=t[r?1:3]^e[3];for(var I=3,A=1;A<i;++A)v=n[c>>>24]^s[l>>>16&255]^f[h>>>8&255]^u[g&255]^e[++I],y=n[l>>>24]^s[h>>>16&255]^f[g>>>8&255]^u[c&255]^e[++I],b=n[h>>>24]^s[g>>>16&255]^f[c>>>8&255]^u[l&255]^e[++I],g=n[g>>>24]^s[c>>>16&255]^f[l>>>8&255]^u[h&255]^e[++I],c=v,l=y,h=b;a[0]=o[c>>>24]<<24^o[l>>>16&255]<<16^o[h>>>8&255]<<8^o[g&255]^e[++I],a[r?3:1]=o[l>>>24]<<24^o[h>>>16&255]<<16^o[g>>>8&255]<<8^o[c&255]^e[++I],a[2]=o[h>>>24]<<24^o[g>>>16&255]<<16^o[c>>>8&255]<<8^o[l&255]^e[++I],a[r?1:3]=o[g>>>24]<<24^o[c>>>16&255]<<16^o[l>>>8&255]<<8^o[h&255]^e[++I]}function ii(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),a="AES-"+t,r;e.decrypt?r=Ke.cipher.createDecipher(a,e.key):r=Ke.cipher.createCipher(a,e.key);var i=r.start;return r.start=function(n,s){var f=null;s instanceof Ke.util.ByteBuffer&&(f=s,s={}),s=s||{},s.output=f,s.iv=n,i.call(r,s)},r}var ta=me;ta.pki=ta.pki||{};var Mn=ta.pki.oids=ta.oids=ta.oids||{};function Z(e,t){Mn[e]=t,Mn[t]=e}function ke(e,t){Mn[e]=t}Z("1.2.840.113549.1.1.1","rsaEncryption");Z("1.2.840.113549.1.1.4","md5WithRSAEncryption");Z("1.2.840.113549.1.1.5","sha1WithRSAEncryption");Z("1.2.840.113549.1.1.7","RSAES-OAEP");Z("1.2.840.113549.1.1.8","mgf1");Z("1.2.840.113549.1.1.9","pSpecified");Z("1.2.840.113549.1.1.10","RSASSA-PSS");Z("1.2.840.113549.1.1.11","sha256WithRSAEncryption");Z("1.2.840.113549.1.1.12","sha384WithRSAEncryption");Z("1.2.840.113549.1.1.13","sha512WithRSAEncryption");Z("1.3.101.112","EdDSA25519");Z("1.2.840.10040.4.3","dsa-with-sha1");Z("1.3.14.3.2.7","desCBC");Z("1.3.14.3.2.26","sha1");Z("1.3.14.3.2.29","sha1WithRSASignature");Z("2.16.840.1.101.3.4.2.1","sha256");Z("2.16.840.1.101.3.4.2.2","sha384");Z("2.16.840.1.101.3.4.2.3","sha512");Z("2.16.840.1.101.3.4.2.4","sha224");Z("2.16.840.1.101.3.4.2.5","sha512-224");Z("2.16.840.1.101.3.4.2.6","sha512-256");Z("1.2.840.113549.2.2","md2");Z("1.2.840.113549.2.5","md5");Z("1.2.840.113549.1.7.1","data");Z("1.2.840.113549.1.7.2","signedData");Z("1.2.840.113549.1.7.3","envelopedData");Z("1.2.840.113549.1.7.4","signedAndEnvelopedData");Z("1.2.840.113549.1.7.5","digestedData");Z("1.2.840.113549.1.7.6","encryptedData");Z("1.2.840.113549.1.9.1","emailAddress");Z("1.2.840.113549.1.9.2","unstructuredName");Z("1.2.840.113549.1.9.3","contentType");Z("1.2.840.113549.1.9.4","messageDigest");Z("1.2.840.113549.1.9.5","signingTime");Z("1.2.840.113549.1.9.6","counterSignature");Z("1.2.840.113549.1.9.7","challengePassword");Z("1.2.840.113549.1.9.8","unstructuredAddress");Z("1.2.840.113549.1.9.14","extensionRequest");Z("1.2.840.113549.1.9.20","friendlyName");Z("1.2.840.113549.1.9.21","localKeyId");Z("1.2.840.113549.1.9.22.1","x509Certificate");Z("1.2.840.113549.1.12.10.1.1","keyBag");Z("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");Z("1.2.840.113549.1.12.10.1.3","certBag");Z("1.2.840.113549.1.12.10.1.4","crlBag");Z("1.2.840.113549.1.12.10.1.5","secretBag");Z("1.2.840.113549.1.12.10.1.6","safeContentsBag");Z("1.2.840.113549.1.5.13","pkcs5PBES2");Z("1.2.840.113549.1.5.12","pkcs5PBKDF2");Z("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");Z("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");Z("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");Z("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");Z("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");Z("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");Z("1.2.840.113549.2.7","hmacWithSHA1");Z("1.2.840.113549.2.8","hmacWithSHA224");Z("1.2.840.113549.2.9","hmacWithSHA256");Z("1.2.840.113549.2.10","hmacWithSHA384");Z("1.2.840.113549.2.11","hmacWithSHA512");Z("1.2.840.113549.3.7","des-EDE3-CBC");Z("2.16.840.1.101.3.4.1.2","aes128-CBC");Z("2.16.840.1.101.3.4.1.22","aes192-CBC");Z("2.16.840.1.101.3.4.1.42","aes256-CBC");Z("2.5.4.3","commonName");Z("2.5.4.4","surname");Z("2.5.4.5","serialNumber");Z("2.5.4.6","countryName");Z("2.5.4.7","localityName");Z("2.5.4.8","stateOrProvinceName");Z("2.5.4.9","streetAddress");Z("2.5.4.10","organizationName");Z("2.5.4.11","organizationalUnitName");Z("2.5.4.12","title");Z("2.5.4.13","description");Z("2.5.4.15","businessCategory");Z("2.5.4.17","postalCode");Z("2.5.4.42","givenName");Z("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");Z("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");Z("2.16.840.1.113730.1.1","nsCertType");Z("2.16.840.1.113730.1.13","nsComment");ke("2.5.29.1","authorityKeyIdentifier");ke("2.5.29.2","keyAttributes");ke("2.5.29.3","certificatePolicies");ke("2.5.29.4","keyUsageRestriction");ke("2.5.29.5","policyMapping");ke("2.5.29.6","subtreesConstraint");ke("2.5.29.7","subjectAltName");ke("2.5.29.8","issuerAltName");ke("2.5.29.9","subjectDirectoryAttributes");ke("2.5.29.10","basicConstraints");ke("2.5.29.11","nameConstraints");ke("2.5.29.12","policyConstraints");ke("2.5.29.13","basicConstraints");Z("2.5.29.14","subjectKeyIdentifier");Z("2.5.29.15","keyUsage");ke("2.5.29.16","privateKeyUsagePeriod");Z("2.5.29.17","subjectAltName");Z("2.5.29.18","issuerAltName");Z("2.5.29.19","basicConstraints");ke("2.5.29.20","cRLNumber");ke("2.5.29.21","cRLReason");ke("2.5.29.22","expirationDate");ke("2.5.29.23","instructionCode");ke("2.5.29.24","invalidityDate");ke("2.5.29.25","cRLDistributionPoints");ke("2.5.29.26","issuingDistributionPoint");ke("2.5.29.27","deltaCRLIndicator");ke("2.5.29.28","issuingDistributionPoint");ke("2.5.29.29","certificateIssuer");ke("2.5.29.30","nameConstraints");Z("2.5.29.31","cRLDistributionPoints");Z("2.5.29.32","certificatePolicies");ke("2.5.29.33","policyMappings");ke("2.5.29.34","policyConstraints");Z("2.5.29.35","authorityKeyIdentifier");ke("2.5.29.36","policyConstraints");Z("2.5.29.37","extKeyUsage");ke("2.5.29.46","freshestCRL");ke("2.5.29.54","inhibitAnyPolicy");Z("1.3.6.1.4.1.11129.2.4.2","timestampList");Z("1.3.6.1.5.5.7.1.1","authorityInfoAccess");Z("1.3.6.1.5.5.7.3.1","serverAuth");Z("1.3.6.1.5.5.7.3.2","clientAuth");Z("1.3.6.1.5.5.7.3.3","codeSigning");Z("1.3.6.1.5.5.7.3.4","emailProtection");Z("1.3.6.1.5.5.7.3.8","timeStamping");var ze=me,ae=ze.asn1=ze.asn1||{};ae.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};ae.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};ae.create=function(e,t,a,r,i){if(ze.util.isArray(r)){for(var n=[],s=0;s<r.length;++s)r[s]!==void 0&&n.push(r[s]);r=n}var f={tagClass:e,type:t,constructed:a,composed:a||ze.util.isArray(r),value:r};return i&&"bitStringContents"in i&&(f.bitStringContents=i.bitStringContents,f.original=ae.copy(f)),f};ae.copy=function(e,t){var a;if(ze.util.isArray(e)){a=[];for(var r=0;r<e.length;++r)a.push(ae.copy(e[r],t));return a}return typeof e=="string"?e:(a={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:ae.copy(e.value,t)},t&&!t.excludeBitStringContents&&(a.bitStringContents=e.bitStringContents),a)};ae.equals=function(e,t,a){if(ze.util.isArray(e)){if(!ze.util.isArray(t)||e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(!ae.equals(e[r],t[r]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var i=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&ae.equals(e.value,t.value);return a&&a.includeBitStringContents&&(i=i&&e.bitStringContents===t.bitStringContents),i};ae.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var a,r=t&128;return r?a=e.getInt((t&127)<<3):a=t,a}};function Z0(e,t,a){if(a>t){var r=new Error("Too few bytes to parse DER.");throw r.available=e.length(),r.remaining=t,r.requested=a,r}}var Fh=function(e,t){var a=e.getByte();if(t--,a!==128){var r,i=a&128;if(!i)r=a;else{var n=a&127;Z0(e,t,n),r=e.getInt(n<<3)}if(r<0)throw new Error("Negative length: "+r);return r}};ae.fromDer=function(e,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=ze.util.createBuffer(e));var a=e.length(),r=ma(e,e.length(),0,t);if(t.parseAllBytes&&e.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=a,i.remaining=e.length(),i}return r};function ma(e,t,a,r){var i;Z0(e,t,2);var n=e.getByte();t--;var s=n&192,f=n&31;i=e.length();var u=Fh(e,t);if(t-=i-e.length(),u!==void 0&&u>t){if(r.strict){var o=new Error("Too few bytes to read ASN.1 value.");throw o.available=e.length(),o.remaining=t,o.requested=u,o}u=t}var c,l,h=(n&32)===32;if(h)if(c=[],u===void 0)for(;;){if(Z0(e,t,2),e.bytes(2)==="\0\0"){e.getBytes(2),t-=2;break}i=e.length(),c.push(ma(e,t,a+1,r)),t-=i-e.length()}else for(;u>0;)i=e.length(),c.push(ma(e,u,a+1,r)),t-=i-e.length(),u-=i-e.length();if(c===void 0&&s===ae.Class.UNIVERSAL&&f===ae.Type.BITSTRING&&(l=e.bytes(u)),c===void 0&&r.decodeBitStrings&&s===ae.Class.UNIVERSAL&&f===ae.Type.BITSTRING&&u>1){var g=e.read,v=t,y=0;if(f===ae.Type.BITSTRING&&(Z0(e,t,1),y=e.getByte(),t--),y===0)try{i=e.length();var b={strict:!0,decodeBitStrings:!0},I=ma(e,t,a+1,b),A=i-e.length();t-=A,f==ae.Type.BITSTRING&&A++;var w=I.tagClass;A===u&&(w===ae.Class.UNIVERSAL||w===ae.Class.CONTEXT_SPECIFIC)&&(c=[I])}catch{}c===void 0&&(e.read=g,t=v)}if(c===void 0){if(u===void 0){if(r.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");u=t}if(f===ae.Type.BMPSTRING)for(c="";u>0;u-=2)Z0(e,t,2),c+=String.fromCharCode(e.getInt16()),t-=2;else c=e.getBytes(u),t-=u}var N=l===void 0?null:{bitStringContents:l};return ae.create(s,f,h,c,N)}ae.toDer=function(e){var t=ze.util.createBuffer(),a=e.tagClass|e.type,r=ze.util.createBuffer(),i=!1;if("bitStringContents"in e&&(i=!0,e.original&&(i=ae.equals(e,e.original))),i)r.putBytes(e.bitStringContents);else if(e.composed){e.constructed?a|=32:r.putByte(0);for(var n=0;n<e.value.length;++n)e.value[n]!==void 0&&r.putBuffer(ae.toDer(e.value[n]))}else if(e.type===ae.Type.BMPSTRING)for(var n=0;n<e.value.length;++n)r.putInt16(e.value.charCodeAt(n));else e.type===ae.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&!(e.value.charCodeAt(1)&128)||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)?r.putBytes(e.value.substr(1)):r.putBytes(e.value);if(t.putByte(a),r.length()<=127)t.putByte(r.length()&127);else{var s=r.length(),f="";do f+=String.fromCharCode(s&255),s=s>>>8;while(s>0);t.putByte(f.length|128);for(var n=f.length-1;n>=0;--n)t.putByte(f.charCodeAt(n))}return t.putBuffer(r),t};ae.oidToDer=function(e){var t=e.split("."),a=ze.util.createBuffer();a.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var r,i,n,s,f=2;f<t.length;++f){r=!0,i=[],n=parseInt(t[f],10);do s=n&127,n=n>>>7,r||(s|=128),i.push(s),r=!1;while(n>0);for(var u=i.length-1;u>=0;--u)a.putByte(i[u])}return a};ae.derToOid=function(e){var t;typeof e=="string"&&(e=ze.util.createBuffer(e));var a=e.getByte();t=Math.floor(a/40)+"."+a%40;for(var r=0;e.length()>0;)a=e.getByte(),r=r<<7,a&128?r+=a&127:(t+="."+(r+a),r=0);return t};ae.utcTimeToDate=function(e){var t=new Date,a=parseInt(e.substr(0,2),10);a=a>=50?1900+a:2e3+a;var r=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),n=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),f=0;if(e.length>11){var u=e.charAt(10),o=10;u!=="+"&&u!=="-"&&(f=parseInt(e.substr(10,2),10),o+=2)}if(t.setUTCFullYear(a,r,i),t.setUTCHours(n,s,f,0),o&&(u=e.charAt(o),u==="+"||u==="-")){var c=parseInt(e.substr(o+1,2),10),l=parseInt(e.substr(o+4,2),10),h=c*60+l;h*=6e4,u==="+"?t.setTime(+t-h):t.setTime(+t+h)}return t};ae.generalizedTimeToDate=function(e){var t=new Date,a=parseInt(e.substr(0,4),10),r=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),n=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),f=parseInt(e.substr(12,2),10),u=0,o=0,c=!1;e.charAt(e.length-1)==="Z"&&(c=!0);var l=e.length-5,h=e.charAt(l);if(h==="+"||h==="-"){var g=parseInt(e.substr(l+1,2),10),v=parseInt(e.substr(l+4,2),10);o=g*60+v,o*=6e4,h==="+"&&(o*=-1),c=!0}return e.charAt(14)==="."&&(u=parseFloat(e.substr(14),10)*1e3),c?(t.setUTCFullYear(a,r,i),t.setUTCHours(n,s,f,u),t.setTime(+t+o)):(t.setFullYear(a,r,i),t.setHours(n,s,f,u)),t};ae.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",a=[];a.push((""+e.getUTCFullYear()).substr(2)),a.push(""+(e.getUTCMonth()+1)),a.push(""+e.getUTCDate()),a.push(""+e.getUTCHours()),a.push(""+e.getUTCMinutes()),a.push(""+e.getUTCSeconds());for(var r=0;r<a.length;++r)a[r].length<2&&(t+="0"),t+=a[r];return t+="Z",t};ae.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",a=[];a.push(""+e.getUTCFullYear()),a.push(""+(e.getUTCMonth()+1)),a.push(""+e.getUTCDate()),a.push(""+e.getUTCHours()),a.push(""+e.getUTCMinutes()),a.push(""+e.getUTCSeconds());for(var r=0;r<a.length;++r)a[r].length<2&&(t+="0"),t+=a[r];return t+="Z",t};ae.integerToDer=function(e){var t=ze.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var a=new Error("Integer too large; max is 32-bits.");throw a.integer=e,a};ae.derToInteger=function(e){typeof e=="string"&&(e=ze.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};ae.validate=function(e,t,a,r){var i=!1;if((e.tagClass===t.tagClass||typeof t.tagClass>"u")&&(e.type===t.type||typeof t.type>"u"))if(e.constructed===t.constructed||typeof t.constructed>"u"){if(i=!0,t.value&&ze.util.isArray(t.value))for(var n=0,s=0;i&&s<t.value.length;++s)i=t.value[s].optional||!1,e.value[n]&&(i=ae.validate(e.value[n],t.value[s],a,r),i?++n:t.value[s].optional&&(i=!0)),!i&&r&&r.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(i&&a&&(t.capture&&(a[t.capture]=e.value),t.captureAsn1&&(a[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(a[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e))if(e.bitStringContents.length<2)a[t.captureBitStringValue]="";else{var f=e.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");a[t.captureBitStringValue]=e.bitStringContents.slice(1)}}else r&&r.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else r&&(e.tagClass!==t.tagClass&&r.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&r.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return i};var Pf=/[^\\u0000-\\u00ff]/;ae.prettyPrint=function(e,t,a){var r="";t=t||0,a=a||2,t>0&&(r+=`
`);for(var i="",n=0;n<t*a;++n)i+=" ";switch(r+=i+"Tag: ",e.tagClass){case ae.Class.UNIVERSAL:r+="Universal:";break;case ae.Class.APPLICATION:r+="Application:";break;case ae.Class.CONTEXT_SPECIFIC:r+="Context-Specific:";break;case ae.Class.PRIVATE:r+="Private:";break}if(e.tagClass===ae.Class.UNIVERSAL)switch(r+=e.type,e.type){case ae.Type.NONE:r+=" (None)";break;case ae.Type.BOOLEAN:r+=" (Boolean)";break;case ae.Type.INTEGER:r+=" (Integer)";break;case ae.Type.BITSTRING:r+=" (Bit string)";break;case ae.Type.OCTETSTRING:r+=" (Octet string)";break;case ae.Type.NULL:r+=" (Null)";break;case ae.Type.OID:r+=" (Object Identifier)";break;case ae.Type.ODESC:r+=" (Object Descriptor)";break;case ae.Type.EXTERNAL:r+=" (External or Instance of)";break;case ae.Type.REAL:r+=" (Real)";break;case ae.Type.ENUMERATED:r+=" (Enumerated)";break;case ae.Type.EMBEDDED:r+=" (Embedded PDV)";break;case ae.Type.UTF8:r+=" (UTF8)";break;case ae.Type.ROID:r+=" (Relative Object Identifier)";break;case ae.Type.SEQUENCE:r+=" (Sequence)";break;case ae.Type.SET:r+=" (Set)";break;case ae.Type.PRINTABLESTRING:r+=" (Printable String)";break;case ae.Type.IA5String:r+=" (IA5String (ASCII))";break;case ae.Type.UTCTIME:r+=" (UTC time)";break;case ae.Type.GENERALIZEDTIME:r+=" (Generalized time)";break;case ae.Type.BMPSTRING:r+=" (BMP String)";break}else r+=e.type;if(r+=`
`,r+=i+"Constructed: "+e.constructed+`
`,e.composed){for(var s=0,f="",n=0;n<e.value.length;++n)e.value[n]!==void 0&&(s+=1,f+=ae.prettyPrint(e.value[n],t+1,a),n+1<e.value.length&&(f+=","));r+=i+"Sub values: "+s+f}else{if(r+=i+"Value: ",e.type===ae.Type.OID){var u=ae.derToOid(e.value);r+=u,ze.pki&&ze.pki.oids&&u in ze.pki.oids&&(r+=" ("+ze.pki.oids[u]+") ")}if(e.type===ae.Type.INTEGER)try{r+=ae.derToInteger(e.value)}catch{r+="0x"+ze.util.bytesToHex(e.value)}else if(e.type===ae.Type.BITSTRING){if(e.value.length>1?r+="0x"+ze.util.bytesToHex(e.value.slice(1)):r+="(none)",e.value.length>0){var o=e.value.charCodeAt(0);o==1?r+=" (1 unused bit shown)":o>1&&(r+=" ("+o+" unused bits shown)")}}else if(e.type===ae.Type.OCTETSTRING)Pf.test(e.value)||(r+="("+e.value+") "),r+="0x"+ze.util.bytesToHex(e.value);else if(e.type===ae.Type.UTF8)try{r+=ze.util.decodeUtf8(e.value)}catch(c){if(c.message==="URI malformed")r+="0x"+ze.util.bytesToHex(e.value)+" (malformed UTF8)";else throw c}else e.type===ae.Type.PRINTABLESTRING||e.type===ae.Type.IA5String?r+=e.value:Pf.test(e.value)?r+="0x"+ze.util.bytesToHex(e.value):e.value.length===0?r+="[null]":r+=e.value}return r};var Na=me;Na.md=Na.md||{};Na.md.algorithms=Na.md.algorithms||{};var Br=me,kh=Br.hmac=Br.hmac||{};kh.create=function(){var e=null,t=null,a=null,r=null,i={};return i.start=function(n,s){if(n!==null)if(typeof n=="string")if(n=n.toLowerCase(),n in Br.md.algorithms)t=Br.md.algorithms[n].create();else throw new Error('Unknown hash algorithm "'+n+'"');else t=n;if(s===null)s=e;else{if(typeof s=="string")s=Br.util.createBuffer(s);else if(Br.util.isArray(s)){var f=s;s=Br.util.createBuffer();for(var u=0;u<f.length;++u)s.putByte(f[u])}var o=s.length();o>t.blockLength&&(t.start(),t.update(s.bytes()),s=t.digest()),a=Br.util.createBuffer(),r=Br.util.createBuffer(),o=s.length();for(var u=0;u<o;++u){var f=s.at(u);a.putByte(54^f),r.putByte(92^f)}if(o<t.blockLength)for(var f=t.blockLength-o,u=0;u<f;++u)a.putByte(54),r.putByte(92);e=s,a=a.bytes(),r=r.bytes()}t.start(),t.update(a)},i.update=function(n){t.update(n)},i.getMac=function(){var n=t.digest().bytes();return t.start(),t.update(r),t.update(n),t.digest()},i.digest=i.getMac,i};var ur=me,xc=ur.md5=ur.md5||{};ur.md.md5=ur.md.algorithms.md5=xc;xc.create=function(){gc||Mh();var e=null,t=ur.util.createBuffer(),a=new Array(16),r={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var i=r.messageLengthSize/4,n=0;n<i;++n)r.fullMessageLength.push(0);return t=ur.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},r},r.start(),r.update=function(i,n){n==="utf8"&&(i=ur.util.encodeUtf8(i));var s=i.length;r.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var f=r.fullMessageLength.length-1;f>=0;--f)r.fullMessageLength[f]+=s[1],s[1]=s[0]+(r.fullMessageLength[f]/4294967296>>>0),r.fullMessageLength[f]=r.fullMessageLength[f]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(i),Uf(e,a,t),(t.read>2048||t.length()===0)&&t.compact(),r},r.digest=function(){var i=ur.util.createBuffer();i.putBytes(t.bytes());var n=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,s=n&r.blockLength-1;i.putBytes(Ln.substr(0,r.blockLength-s));for(var f,u=0,o=r.fullMessageLength.length-1;o>=0;--o)f=r.fullMessageLength[o]*8+u,u=f/4294967296>>>0,i.putInt32Le(f>>>0);var c={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3};Uf(c,a,i);var l=ur.util.createBuffer();return l.putInt32Le(c.h0),l.putInt32Le(c.h1),l.putInt32Le(c.h2),l.putInt32Le(c.h3),l},r};var Ln=null,Ca=null,J0=null,A0=null,gc=!1;function Mh(){Ln="",Ln+=ur.util.fillString("\0",64),Ca=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],J0=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],A0=new Array(64);for(var e=0;e<64;++e)A0[e]=Math.floor(Math.abs(Math.sin(e+1))*4294967296);gc=!0}function Uf(e,t,a){for(var r,i,n,s,f,u,o,c,l=a.length();l>=64;){for(i=e.h0,n=e.h1,s=e.h2,f=e.h3,c=0;c<16;++c)t[c]=a.getInt32Le(),u=f^n&(s^f),r=i+u+A0[c]+t[c],o=J0[c],i=f,f=s,s=n,n+=r<<o|r>>>32-o;for(;c<32;++c)u=s^f&(n^s),r=i+u+A0[c]+t[Ca[c]],o=J0[c],i=f,f=s,s=n,n+=r<<o|r>>>32-o;for(;c<48;++c)u=n^s^f,r=i+u+A0[c]+t[Ca[c]],o=J0[c],i=f,f=s,s=n,n+=r<<o|r>>>32-o;for(;c<64;++c)u=s^(n|~f),r=i+u+A0[c]+t[Ca[c]],o=J0[c],i=f,f=s,s=n,n+=r<<o|r>>>32-o;e.h0=e.h0+i|0,e.h1=e.h1+n|0,e.h2=e.h2+s|0,e.h3=e.h3+f|0,l-=64}}var Ra=me,yc=Ra.pem=Ra.pem||{};yc.encode=function(e,t){t=t||{};var a="-----BEGIN "+e.type+`-----\r
`,r;if(e.procType&&(r={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},a+=pa(r)),e.contentDomain&&(r={name:"Content-Domain",values:[e.contentDomain]},a+=pa(r)),e.dekInfo&&(r={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&r.values.push(e.dekInfo.parameters),a+=pa(r)),e.headers)for(var i=0;i<e.headers.length;++i)a+=pa(e.headers[i]);return e.procType&&(a+=`\r
`),a+=Ra.util.encode64(e.body,t.maxline||64)+`\r
`,a+="-----END "+e.type+`-----\r
`,a};yc.decode=function(e){for(var t=[],a=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,r=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,n;n=a.exec(e),!!n;){var s=n[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var f={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Ra.util.decode64(n[3])};if(t.push(f),!!n[2]){for(var u=n[2].split(i),o=0;n&&o<u.length;){for(var c=u[o].replace(/\s+$/,""),l=o+1;l<u.length;++l){var h=u[l];if(!/\s/.test(h[0]))break;c+=h,o=l}if(n=c.match(r),n){for(var g={name:n[1],values:[]},v=n[2].split(","),y=0;y<v.length;++y)g.values.push(Lh(v[y]));if(f.procType)if(!f.contentDomain&&g.name==="Content-Domain")f.contentDomain=v[0]||"";else if(!f.dekInfo&&g.name==="DEK-Info"){if(g.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');f.dekInfo={algorithm:v[0],parameters:v[1]||null}}else f.headers.push(g);else{if(g.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(g.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');f.procType={version:v[0],type:v[1]}}}++o}if(f.procType==="ENCRYPTED"&&!f.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function pa(e){for(var t=e.name+": ",a=[],r=function(u,o){return" "+o},i=0;i<e.values.length;++i)a.push(e.values[i].replace(/^(\S+\r\n)/,r));t+=a.join(",")+`\r
`;for(var n=0,s=-1,i=0;i<t.length;++i,++n)if(n>65&&s!==-1){var f=t[s];f===","?(++s,t=t.substr(0,s)+`\r
 `+t.substr(s)):t=t.substr(0,s)+`\r
`+f+t.substr(s+1),n=i-s-1,s=-1,++i}else(t[i]===" "||t[i]==="	"||t[i]===",")&&(s=i);return t}function Lh(e){return e.replace(/^\s+/,"")}var $e=me;$e.des=$e.des||{};$e.des.startEncrypting=function(e,t,a,r){var i=ni({key:e,output:a,decrypt:!1,mode:r||(t===null?"ECB":"CBC")});return i.start(t),i};$e.des.createEncryptionCipher=function(e,t){return ni({key:e,output:null,decrypt:!1,mode:t})};$e.des.startDecrypting=function(e,t,a,r){var i=ni({key:e,output:a,decrypt:!0,mode:r||(t===null?"ECB":"CBC")});return i.start(t),i};$e.des.createDecryptionCipher=function(e,t){return ni({key:e,output:null,decrypt:!0,mode:t})};$e.des.Algorithm=function(e,t){var a=this;a.name=e,a.mode=new t({blockSize:8,cipher:{encrypt:function(r,i){return Of(a._keys,r,i,!1)},decrypt:function(r,i){return Of(a._keys,r,i,!0)}}}),a._init=!1};$e.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=$e.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=Gh(t),this._init=!0}};Er("DES-ECB",$e.cipher.modes.ecb);Er("DES-CBC",$e.cipher.modes.cbc);Er("DES-CFB",$e.cipher.modes.cfb);Er("DES-OFB",$e.cipher.modes.ofb);Er("DES-CTR",$e.cipher.modes.ctr);Er("3DES-ECB",$e.cipher.modes.ecb);Er("3DES-CBC",$e.cipher.modes.cbc);Er("3DES-CFB",$e.cipher.modes.cfb);Er("3DES-OFB",$e.cipher.modes.ofb);Er("3DES-CTR",$e.cipher.modes.ctr);function Er(e,t){var a=function(){return new $e.des.Algorithm(e,t)};$e.cipher.registerAlgorithm(e,a)}var Ph=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Uh=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Oh=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Vh=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Kh=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],qh=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Hh=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],zh=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Gh(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],a=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],r=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],n=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],f=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],o=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],c=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],l=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],h=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],g=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],v=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=e.length()>8?3:1,b=[],I=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],A=0,w,N=0;N<y;N++){var k=e.getInt32(),M=e.getInt32();w=(k>>>4^M)&252645135,M^=w,k^=w<<4,w=(M>>>-16^k)&65535,k^=w,M^=w<<-16,w=(k>>>2^M)&858993459,M^=w,k^=w<<2,w=(M>>>-16^k)&65535,k^=w,M^=w<<-16,w=(k>>>1^M)&1431655765,M^=w,k^=w<<1,w=(M>>>8^k)&16711935,k^=w,M^=w<<8,w=(k>>>1^M)&1431655765,M^=w,k^=w<<1,w=k<<8|M>>>20&240,k=M<<24|M<<8&16711680|M>>>8&65280|M>>>24&240,M=w;for(var V=0;V<I.length;++V){I[V]?(k=k<<2|k>>>26,M=M<<2|M>>>26):(k=k<<1|k>>>27,M=M<<1|M>>>27),k&=-15,M&=-15;var z=t[k>>>28]|a[k>>>24&15]|r[k>>>20&15]|i[k>>>16&15]|n[k>>>12&15]|s[k>>>8&15]|f[k>>>4&15],W=u[M>>>28]|o[M>>>24&15]|c[M>>>20&15]|l[M>>>16&15]|h[M>>>12&15]|g[M>>>8&15]|v[M>>>4&15];w=(W>>>16^z)&65535,b[A++]=z^w,b[A++]=W^w<<16}}return b}function Of(e,t,a,r){var i=e.length===32?3:9,n;i===3?n=r?[30,-2,-2]:[0,32,2]:n=r?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,f=t[0],u=t[1];s=(f>>>4^u)&252645135,u^=s,f^=s<<4,s=(f>>>16^u)&65535,u^=s,f^=s<<16,s=(u>>>2^f)&858993459,f^=s,u^=s<<2,s=(u>>>8^f)&16711935,f^=s,u^=s<<8,s=(f>>>1^u)&1431655765,u^=s,f^=s<<1,f=f<<1|f>>>31,u=u<<1|u>>>31;for(var o=0;o<i;o+=3){for(var c=n[o+1],l=n[o+2],h=n[o];h!=c;h+=l){var g=u^e[h],v=(u>>>4|u<<28)^e[h+1];s=f,f=u,u=s^(Uh[g>>>24&63]|Vh[g>>>16&63]|qh[g>>>8&63]|zh[g&63]|Ph[v>>>24&63]|Oh[v>>>16&63]|Kh[v>>>8&63]|Hh[v&63])}s=f,f=u,u=s}f=f>>>1|f<<31,u=u>>>1|u<<31,s=(f>>>1^u)&1431655765,u^=s,f^=s<<1,s=(u>>>8^f)&16711935,f^=s,u^=s<<8,s=(u>>>2^f)&858993459,f^=s,u^=s<<2,s=(f>>>16^u)&65535,u^=s,f^=s<<16,s=(f>>>4^u)&252645135,u^=s,f^=s<<4,a[0]=f,a[1]=u}function ni(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),a="DES-"+t,r;e.decrypt?r=$e.cipher.createDecipher(a,e.key):r=$e.cipher.createCipher(a,e.key);var i=r.start;return r.start=function(n,s){var f=null;s instanceof $e.util.ByteBuffer&&(f=s,s={}),s=s||{},s.output=f,s.iv=n,i.call(r,s)},r}var Mt=me,jh=Mt.pkcs5=Mt.pkcs5||{},Sr;Mt.util.isNodejs&&!Mt.options.usePureJavaScript&&(Sr=k0);Mt.pbkdf2=jh.pbkdf2=function(e,t,a,r,i,n){if(typeof i=="function"&&(n=i,i=null),Mt.util.isNodejs&&!Mt.options.usePureJavaScript&&Sr.pbkdf2&&(i===null||typeof i!="object")&&(Sr.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),n?Sr.pbkdf2Sync.length===4?Sr.pbkdf2(e,t,a,r,function(w,N){if(w)return n(w);n(null,N.toString("binary"))}):Sr.pbkdf2(e,t,a,r,i,function(w,N){if(w)return n(w);n(null,N.toString("binary"))}):Sr.pbkdf2Sync.length===4?Sr.pbkdf2Sync(e,t,a,r).toString("binary"):Sr.pbkdf2Sync(e,t,a,r,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Mt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Mt.md[i].create()}var s=i.digestLength;if(r>4294967295*s){var f=new Error("Derived key is too long.");if(n)return n(f);throw f}var u=Math.ceil(r/s),o=r-(u-1)*s,c=Mt.hmac.create();c.start(i,e);var l="",h,g,v;if(!n){for(var y=1;y<=u;++y){c.start(null,null),c.update(t),c.update(Mt.util.int32ToBytes(y)),h=v=c.digest().getBytes();for(var b=2;b<=a;++b)c.start(null,null),c.update(v),g=c.digest().getBytes(),h=Mt.util.xorBytes(h,g,s),v=g;l+=y<u?h:h.substr(0,o)}return l}var y=1,b;function I(){if(y>u)return n(null,l);c.start(null,null),c.update(t),c.update(Mt.util.int32ToBytes(y)),h=v=c.digest().getBytes(),b=2,A()}function A(){if(b<=a)return c.start(null,null),c.update(v),g=c.digest().getBytes(),h=Mt.util.xorBytes(h,g,s),v=g,++b,Mt.util.setImmediate(A);l+=y<u?h:h.substr(0,o),++y,I()}I()};var dr=me,bc=dr.sha256=dr.sha256||{};dr.md.sha256=dr.md.algorithms.sha256=bc;bc.create=function(){mc||$h();var e=null,t=dr.util.createBuffer(),a=new Array(64),r={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var i=r.messageLengthSize/4,n=0;n<i;++n)r.fullMessageLength.push(0);return t=dr.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},r},r.start(),r.update=function(i,n){n==="utf8"&&(i=dr.util.encodeUtf8(i));var s=i.length;r.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var f=r.fullMessageLength.length-1;f>=0;--f)r.fullMessageLength[f]+=s[1],s[1]=s[0]+(r.fullMessageLength[f]/4294967296>>>0),r.fullMessageLength[f]=r.fullMessageLength[f]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(i),Vf(e,a,t),(t.read>2048||t.length()===0)&&t.compact(),r},r.digest=function(){var i=dr.util.createBuffer();i.putBytes(t.bytes());var n=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,s=n&r.blockLength-1;i.putBytes(Pn.substr(0,r.blockLength-s));for(var f,u,o=r.fullMessageLength[0]*8,c=0;c<r.fullMessageLength.length-1;++c)f=r.fullMessageLength[c+1]*8,u=f/4294967296>>>0,o+=u,i.putInt32(o>>>0),o=f>>>0;i.putInt32(o);var l={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};Vf(l,a,i);var h=dr.util.createBuffer();return h.putInt32(l.h0),h.putInt32(l.h1),h.putInt32(l.h2),h.putInt32(l.h3),h.putInt32(l.h4),h.putInt32(l.h5),h.putInt32(l.h6),h.putInt32(l.h7),h},r};var Pn=null,mc=!1,Cc=null;function $h(){Pn="",Pn+=dr.util.fillString("\0",64),Cc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],mc=!0}function Vf(e,t,a){for(var r,i,n,s,f,u,o,c,l,h,g,v,y,b,I,A=a.length();A>=64;){for(o=0;o<16;++o)t[o]=a.getInt32();for(;o<64;++o)r=t[o-2],r=(r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,i=t[o-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[o]=r+t[o-7]+i+t[o-16]|0;for(c=e.h0,l=e.h1,h=e.h2,g=e.h3,v=e.h4,y=e.h5,b=e.h6,I=e.h7,o=0;o<64;++o)s=(v>>>6|v<<26)^(v>>>11|v<<21)^(v>>>25|v<<7),f=b^v&(y^b),n=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),u=c&l|h&(c^l),r=I+s+f+Cc[o]+t[o],i=n+u,I=b,b=y,y=v,v=g+r>>>0,g=h,h=l,l=c,c=r+i>>>0;e.h0=e.h0+c|0,e.h1=e.h1+l|0,e.h2=e.h2+h|0,e.h3=e.h3+g|0,e.h4=e.h4+v|0,e.h5=e.h5+y|0,e.h6=e.h6+b|0,e.h7=e.h7+I|0,A-=64}}var or=me,Ea=null;or.util.isNodejs&&!or.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Ea=k0);var Wh=or.prng=or.prng||{};Wh.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},a=e.md,r=new Array(32),i=0;i<32;++i)r[i]=a.create();t.pools=r,t.pool=0,t.generate=function(o,c){if(!c)return t.generateSync(o);var l=t.plugin.cipher,h=t.plugin.increment,g=t.plugin.formatKey,v=t.plugin.formatSeed,y=or.util.createBuffer();t.key=null,b();function b(I){if(I)return c(I);if(y.length()>=o)return c(null,y.getBytes(o));if(t.generated>1048575&&(t.key=null),t.key===null)return or.util.nextTick(function(){n(b)});var A=l(t.key,t.seed);t.generated+=A.length,y.putBytes(A),t.key=g(l(t.key,h(t.seed))),t.seed=v(l(t.key,t.seed)),or.util.setImmediate(b)}},t.generateSync=function(o){var c=t.plugin.cipher,l=t.plugin.increment,h=t.plugin.formatKey,g=t.plugin.formatSeed;t.key=null;for(var v=or.util.createBuffer();v.length()<o;){t.generated>1048575&&(t.key=null),t.key===null&&s();var y=c(t.key,t.seed);t.generated+=y.length,v.putBytes(y),t.key=h(c(t.key,l(t.seed))),t.seed=g(c(t.key,t.seed))}return v.getBytes(o)};function n(o){if(t.pools[0].messageLength>=32)return f(),o();var c=32-t.pools[0].messageLength<<5;t.seedFile(c,function(l,h){if(l)return o(l);t.collect(h),f(),o()})}function s(){if(t.pools[0].messageLength>=32)return f();var o=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(o)),f()}function f(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var o=t.plugin.md.create();o.update(t.keyBytes);for(var c=1,l=0;l<32;++l)t.reseeds%c===0&&(o.update(t.pools[l].digest().getBytes()),t.pools[l].start()),c=c<<1;t.keyBytes=o.digest().getBytes(),o.start(),o.update(t.keyBytes);var h=o.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(h),t.generated=0}function u(o){var c=null,l=or.util.globalScope,h=l.crypto||l.msCrypto;h&&h.getRandomValues&&(c=function(k){return h.getRandomValues(k)});var g=or.util.createBuffer();if(c)for(;g.length()<o;){var v=Math.max(1,Math.min(o-g.length(),65536)/4),y=new Uint32Array(Math.floor(v));try{c(y);for(var b=0;b<y.length;++b)g.putInt32(y[b])}catch(k){if(!(typeof QuotaExceededError<"u"&&k instanceof QuotaExceededError))throw k}}if(g.length()<o)for(var I,A,w,N=Math.floor(Math.random()*65536);g.length()<o;){A=16807*(N&65535),I=16807*(N>>16),A+=(I&32767)<<16,A+=I>>15,A=(A&2147483647)+(A>>31),N=A&4294967295;for(var b=0;b<3;++b)w=N>>>(b<<3),w^=Math.floor(Math.random()*256),g.putByte(w&255)}return g.getBytes(o)}return Ea?(t.seedFile=function(o,c){Ea.randomBytes(o,function(l,h){if(l)return c(l);c(null,h.toString())})},t.seedFileSync=function(o){return Ea.randomBytes(o).toString()}):(t.seedFile=function(o,c){try{c(null,u(o))}catch(l){c(l)}},t.seedFileSync=u),t.collect=function(o){for(var c=o.length,l=0;l<c;++l)t.pools[t.pool].update(o.substr(l,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(o,c){for(var l="",h=0;h<c;h+=8)l+=String.fromCharCode(o>>h&255);t.collect(l)},t.registerWorker=function(o){if(o===self)t.seedFile=function(l,h){function g(v){var y=v.data;y.forge&&y.forge.prng&&(self.removeEventListener("message",g),h(y.forge.prng.err,y.forge.prng.bytes))}self.addEventListener("message",g),self.postMessage({forge:{prng:{needed:l}}})};else{var c=function(l){var h=l.data;h.forge&&h.forge.prng&&t.seedFile(h.forge.prng.needed,function(g,v){o.postMessage({forge:{prng:{err:g,bytes:v}}})})};o.addEventListener("message",c)}},t};var mt=me;(function(){if(mt.random&&mt.random.getBytes){mt.random;return}(function(e){var t={},a=new Array(4),r=mt.util.createBuffer();t.formatKey=function(l){var h=mt.util.createBuffer(l);return l=new Array(4),l[0]=h.getInt32(),l[1]=h.getInt32(),l[2]=h.getInt32(),l[3]=h.getInt32(),mt.aes._expandKey(l,!1)},t.formatSeed=function(l){var h=mt.util.createBuffer(l);return l=new Array(4),l[0]=h.getInt32(),l[1]=h.getInt32(),l[2]=h.getInt32(),l[3]=h.getInt32(),l},t.cipher=function(l,h){return mt.aes._updateBlock(l,h,a,!1),r.putInt32(a[0]),r.putInt32(a[1]),r.putInt32(a[2]),r.putInt32(a[3]),r.getBytes()},t.increment=function(l){return++l[3],l},t.md=mt.md.sha256;function i(){var l=mt.prng.create(t);return l.getBytes=function(h,g){return l.generate(h,g)},l.getBytesSync=function(h){return l.generate(h)},l}var n=i(),s=null,f=mt.util.globalScope,u=f.crypto||f.msCrypto;if(u&&u.getRandomValues&&(s=function(l){return u.getRandomValues(l)}),mt.options.usePureJavaScript||!mt.util.isNodejs&&!s){if(n.collectInt(+new Date,32),typeof navigator<"u"){var o="";for(var c in navigator)try{typeof navigator[c]=="string"&&(o+=navigator[c])}catch{}n.collect(o),o=null}e&&(e().mousemove(function(l){n.collectInt(l.clientX,16),n.collectInt(l.clientY,16)}),e().keypress(function(l){n.collectInt(l.charCode,8)}))}if(!mt.random)mt.random=n;else for(var c in n)mt.random[c]=n[c];mt.random.createInstance=i,mt.random})(typeof jQuery<"u"?jQuery:null)})();var Ut=me,Cn=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Kf=[1,2,3,5],Qh=function(e,t){return e<<t&65535|(e&65535)>>16-t},Xh=function(e,t){return(e&65535)>>t|e<<16-t&65535};Ut.rc2=Ut.rc2||{};Ut.rc2.expandKey=function(e,t){typeof e=="string"&&(e=Ut.util.createBuffer(e)),t=t||128;var a=e,r=e.length(),i=t,n=Math.ceil(i/8),s=255>>(i&7),f;for(f=r;f<128;f++)a.putByte(Cn[a.at(f-1)+a.at(f-r)&255]);for(a.setAt(128-n,Cn[a.at(128-n)&s]),f=127-n;f>=0;f--)a.setAt(f,Cn[a.at(f+1)^a.at(f+n)]);return a};var Ec=function(e,t,a){var r=!1,i=null,n=null,s=null,f,u,o,c,l=[];for(e=Ut.rc2.expandKey(e,t),o=0;o<64;o++)l.push(e.getInt16Le());a?(f=function(v){for(o=0;o<4;o++)v[o]+=l[c]+(v[(o+3)%4]&v[(o+2)%4])+(~v[(o+3)%4]&v[(o+1)%4]),v[o]=Qh(v[o],Kf[o]),c++},u=function(v){for(o=0;o<4;o++)v[o]+=l[v[(o+3)%4]&63]}):(f=function(v){for(o=3;o>=0;o--)v[o]=Xh(v[o],Kf[o]),v[o]-=l[c]+(v[(o+3)%4]&v[(o+2)%4])+(~v[(o+3)%4]&v[(o+1)%4]),c--},u=function(v){for(o=3;o>=0;o--)v[o]-=l[v[(o+3)%4]&63]});var h=function(v){var y=[];for(o=0;o<4;o++){var b=i.getInt16Le();s!==null&&(a?b^=s.getInt16Le():s.putInt16Le(b)),y.push(b&65535)}c=a?0:63;for(var I=0;I<v.length;I++)for(var A=0;A<v[I][0];A++)v[I][1](y);for(o=0;o<4;o++)s!==null&&(a?s.putInt16Le(y[o]):y[o]^=s.getInt16Le()),n.putInt16Le(y[o])},g=null;return g={start:function(v,y){v&&typeof v=="string"&&(v=Ut.util.createBuffer(v)),r=!1,i=Ut.util.createBuffer(),n=y||new Ut.util.createBuffer,s=v,g.output=n},update:function(v){for(r||i.putBuffer(v);i.length()>=8;)h([[5,f],[1,u],[6,f],[1,u],[5,f]])},finish:function(v){var y=!0;if(a)if(v)y=v(8,i,!a);else{var b=i.length()===8?8:8-i.length();i.fillWithByte(b,b)}if(y&&(r=!0,g.update()),!a&&(y=i.length()===0,y))if(v)y=v(8,n,!a);else{var I=n.length(),A=n.at(I-1);A>I?y=!1:n.truncate(A)}return y}},g};Ut.rc2.startEncrypting=function(e,t,a){var r=Ut.rc2.createEncryptionCipher(e,128);return r.start(t,a),r};Ut.rc2.createEncryptionCipher=function(e,t){return Ec(e,t,!0)};Ut.rc2.startDecrypting=function(e,t,a){var r=Ut.rc2.createDecryptionCipher(e,128);return r.start(t,a),r};Ut.rc2.createDecryptionCipher=function(e,t){return Ec(e,t,!1)};var Un=me;Un.jsbn=Un.jsbn||{};var Ir;function Y(e,t,a){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,a):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}Un.jsbn.BigInteger=Y;function Re(){return new Y(null)}function Yh(e,t,a,r,i,n){for(;--n>=0;){var s=t*this.data[e++]+a.data[r]+i;i=Math.floor(s/67108864),a.data[r++]=s&67108863}return i}function Zh(e,t,a,r,i,n){for(var s=t&32767,f=t>>15;--n>=0;){var u=this.data[e]&32767,o=this.data[e++]>>15,c=f*u+o*s;u=s*u+((c&32767)<<15)+a.data[r]+(i&1073741823),i=(u>>>30)+(c>>>15)+f*o+(i>>>30),a.data[r++]=u&1073741823}return i}function qf(e,t,a,r,i,n){for(var s=t&16383,f=t>>14;--n>=0;){var u=this.data[e]&16383,o=this.data[e++]>>14,c=f*u+o*s;u=s*u+((c&16383)<<14)+a.data[r]+i,i=(u>>28)+(c>>14)+f*o,a.data[r++]=u&268435455}return i}typeof navigator>"u"?(Y.prototype.am=qf,Ir=28):navigator.appName=="Microsoft Internet Explorer"?(Y.prototype.am=Zh,Ir=30):navigator.appName!="Netscape"?(Y.prototype.am=Yh,Ir=26):(Y.prototype.am=qf,Ir=28);Y.prototype.DB=Ir;Y.prototype.DM=(1<<Ir)-1;Y.prototype.DV=1<<Ir;var As=52;Y.prototype.FV=Math.pow(2,As);Y.prototype.F1=As-Ir;Y.prototype.F2=2*Ir-As;var Jh="0123456789abcdefghijklmnopqrstuvwxyz",si=new Array,q0,jt;q0=48;for(jt=0;jt<=9;++jt)si[q0++]=jt;q0=97;for(jt=10;jt<36;++jt)si[q0++]=jt;q0=65;for(jt=10;jt<36;++jt)si[q0++]=jt;function Hf(e){return Jh.charAt(e)}function Ac(e,t){var a=si[e.charCodeAt(t)];return a??-1}function e1(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function t1(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function qr(e){var t=Re();return t.fromInt(e),t}function r1(e,t){var a;if(t==16)a=4;else if(t==8)a=3;else if(t==256)a=8;else if(t==2)a=1;else if(t==32)a=5;else if(t==4)a=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var r=e.length,i=!1,n=0;--r>=0;){var s=a==8?e[r]&255:Ac(e,r);if(s<0){e.charAt(r)=="-"&&(i=!0);continue}i=!1,n==0?this.data[this.t++]=s:n+a>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-n)-1)<<n,this.data[this.t++]=s>>this.DB-n):this.data[this.t-1]|=s<<n,n+=a,n>=this.DB&&(n-=this.DB)}a==8&&e[0]&128&&(this.s=-1,n>0&&(this.data[this.t-1]|=(1<<this.DB-n)-1<<n)),this.clamp(),i&&Y.ZERO.subTo(this,this)}function a1(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function i1(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var a=(1<<t)-1,r,i=!1,n="",s=this.t,f=this.DB-s*this.DB%t;if(s-- >0)for(f<this.DB&&(r=this.data[s]>>f)>0&&(i=!0,n=Hf(r));s>=0;)f<t?(r=(this.data[s]&(1<<f)-1)<<t-f,r|=this.data[--s]>>(f+=this.DB-t)):(r=this.data[s]>>(f-=t)&a,f<=0&&(f+=this.DB,--s)),r>0&&(i=!0),i&&(n+=Hf(r));return i?n:"0"}function n1(){var e=Re();return Y.ZERO.subTo(this,e),e}function s1(){return this.s<0?this.negate():this}function f1(e){var t=this.s-e.s;if(t!=0)return t;var a=this.t;if(t=a-e.t,t!=0)return this.s<0?-t:t;for(;--a>=0;)if((t=this.data[a]-e.data[a])!=0)return t;return 0}function fi(e){var t=1,a;return(a=e>>>16)!=0&&(e=a,t+=16),(a=e>>8)!=0&&(e=a,t+=8),(a=e>>4)!=0&&(e=a,t+=4),(a=e>>2)!=0&&(e=a,t+=2),(a=e>>1)!=0&&(e=a,t+=1),t}function o1(){return this.t<=0?0:this.DB*(this.t-1)+fi(this.data[this.t-1]^this.s&this.DM)}function c1(e,t){var a;for(a=this.t-1;a>=0;--a)t.data[a+e]=this.data[a];for(a=e-1;a>=0;--a)t.data[a]=0;t.t=this.t+e,t.s=this.s}function u1(e,t){for(var a=e;a<this.t;++a)t.data[a-e]=this.data[a];t.t=Math.max(this.t-e,0),t.s=this.s}function d1(e,t){var a=e%this.DB,r=this.DB-a,i=(1<<r)-1,n=Math.floor(e/this.DB),s=this.s<<a&this.DM,f;for(f=this.t-1;f>=0;--f)t.data[f+n+1]=this.data[f]>>r|s,s=(this.data[f]&i)<<a;for(f=n-1;f>=0;--f)t.data[f]=0;t.data[n]=s,t.t=this.t+n+1,t.s=this.s,t.clamp()}function l1(e,t){t.s=this.s;var a=Math.floor(e/this.DB);if(a>=this.t){t.t=0;return}var r=e%this.DB,i=this.DB-r,n=(1<<r)-1;t.data[0]=this.data[a]>>r;for(var s=a+1;s<this.t;++s)t.data[s-a-1]|=(this.data[s]&n)<<i,t.data[s-a]=this.data[s]>>r;r>0&&(t.data[this.t-a-1]|=(this.s&n)<<i),t.t=this.t-a,t.clamp()}function h1(e,t){for(var a=0,r=0,i=Math.min(e.t,this.t);a<i;)r+=this.data[a]-e.data[a],t.data[a++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;a<this.t;)r+=this.data[a],t.data[a++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;a<e.t;)r-=e.data[a],t.data[a++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t.data[a++]=this.DV+r:r>0&&(t.data[a++]=r),t.t=a,t.clamp()}function v1(e,t){var a=this.abs(),r=e.abs(),i=a.t;for(t.t=i+r.t;--i>=0;)t.data[i]=0;for(i=0;i<r.t;++i)t.data[i+a.t]=a.am(0,r.data[i],t,i,0,a.t);t.s=0,t.clamp(),this.s!=e.s&&Y.ZERO.subTo(t,t)}function p1(e){for(var t=this.abs(),a=e.t=2*t.t;--a>=0;)e.data[a]=0;for(a=0;a<t.t-1;++a){var r=t.am(a,t.data[a],e,2*a,0,1);(e.data[a+t.t]+=t.am(a+1,2*t.data[a],e,2*a+1,r,t.t-a-1))>=t.DV&&(e.data[a+t.t]-=t.DV,e.data[a+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(a,t.data[a],e,2*a,0,1)),e.s=0,e.clamp()}function x1(e,t,a){var r=e.abs();if(!(r.t<=0)){var i=this.abs();if(i.t<r.t){t!=null&&t.fromInt(0),a!=null&&this.copyTo(a);return}a==null&&(a=Re());var n=Re(),s=this.s,f=e.s,u=this.DB-fi(r.data[r.t-1]);u>0?(r.lShiftTo(u,n),i.lShiftTo(u,a)):(r.copyTo(n),i.copyTo(a));var o=n.t,c=n.data[o-1];if(c!=0){var l=c*(1<<this.F1)+(o>1?n.data[o-2]>>this.F2:0),h=this.FV/l,g=(1<<this.F1)/l,v=1<<this.F2,y=a.t,b=y-o,I=t??Re();for(n.dlShiftTo(b,I),a.compareTo(I)>=0&&(a.data[a.t++]=1,a.subTo(I,a)),Y.ONE.dlShiftTo(o,I),I.subTo(n,n);n.t<o;)n.data[n.t++]=0;for(;--b>=0;){var A=a.data[--y]==c?this.DM:Math.floor(a.data[y]*h+(a.data[y-1]+v)*g);if((a.data[y]+=n.am(0,A,a,b,0,o))<A)for(n.dlShiftTo(b,I),a.subTo(I,a);a.data[y]<--A;)a.subTo(I,a)}t!=null&&(a.drShiftTo(o,t),s!=f&&Y.ZERO.subTo(t,t)),a.t=o,a.clamp(),u>0&&a.rShiftTo(u,a),s<0&&Y.ZERO.subTo(a,a)}}}function g1(e){var t=Re();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(Y.ZERO)>0&&e.subTo(t,t),t}function x0(e){this.m=e}function y1(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function b1(e){return e}function m1(e){e.divRemTo(this.m,null,e)}function C1(e,t,a){e.multiplyTo(t,a),this.reduce(a)}function E1(e,t){e.squareTo(t),this.reduce(t)}x0.prototype.convert=y1;x0.prototype.revert=b1;x0.prototype.reduce=m1;x0.prototype.mulTo=C1;x0.prototype.sqrTo=E1;function A1(){if(this.t<1)return 0;var e=this.data[0];if(!(e&1))return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function g0(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function S1(e){var t=Re();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(Y.ZERO)>0&&this.m.subTo(t,t),t}function B1(e){var t=Re();return e.copyTo(t),this.reduce(t),t}function _1(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var a=e.data[t]&32767,r=a*this.mpl+((a*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(a=t+this.m.t,e.data[a]+=this.m.am(0,r,e,t,0,this.m.t);e.data[a]>=e.DV;)e.data[a]-=e.DV,e.data[++a]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function I1(e,t){e.squareTo(t),this.reduce(t)}function T1(e,t,a){e.multiplyTo(t,a),this.reduce(a)}g0.prototype.convert=S1;g0.prototype.revert=B1;g0.prototype.reduce=_1;g0.prototype.mulTo=T1;g0.prototype.sqrTo=I1;function w1(){return(this.t>0?this.data[0]&1:this.s)==0}function D1(e,t){if(e>4294967295||e<1)return Y.ONE;var a=Re(),r=Re(),i=t.convert(this),n=fi(e)-1;for(i.copyTo(a);--n>=0;)if(t.sqrTo(a,r),(e&1<<n)>0)t.mulTo(r,i,a);else{var s=a;a=r,r=s}return t.revert(a)}function N1(e,t){var a;return e<256||t.isEven()?a=new x0(t):a=new g0(t),this.exp(e,a)}Y.prototype.copyTo=e1;Y.prototype.fromInt=t1;Y.prototype.fromString=r1;Y.prototype.clamp=a1;Y.prototype.dlShiftTo=c1;Y.prototype.drShiftTo=u1;Y.prototype.lShiftTo=d1;Y.prototype.rShiftTo=l1;Y.prototype.subTo=h1;Y.prototype.multiplyTo=v1;Y.prototype.squareTo=p1;Y.prototype.divRemTo=x1;Y.prototype.invDigit=A1;Y.prototype.isEven=w1;Y.prototype.exp=D1;Y.prototype.toString=i1;Y.prototype.negate=n1;Y.prototype.abs=s1;Y.prototype.compareTo=f1;Y.prototype.bitLength=o1;Y.prototype.mod=g1;Y.prototype.modPowInt=N1;Y.ZERO=qr(0);Y.ONE=qr(1);function R1(){var e=Re();return this.copyTo(e),e}function F1(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function k1(){return this.t==0?this.s:this.data[0]<<24>>24}function M1(){return this.t==0?this.s:this.data[0]<<16>>16}function L1(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function P1(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function U1(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),a=Math.pow(e,t),r=qr(a),i=Re(),n=Re(),s="";for(this.divRemTo(r,i,n);i.signum()>0;)s=(a+n.intValue()).toString(e).substr(1)+s,i.divRemTo(r,i,n);return n.intValue().toString(e)+s}function O1(e,t){this.fromInt(0),t==null&&(t=10);for(var a=this.chunkSize(t),r=Math.pow(t,a),i=!1,n=0,s=0,f=0;f<e.length;++f){var u=Ac(e,f);if(u<0){e.charAt(f)=="-"&&this.signum()==0&&(i=!0);continue}s=t*s+u,++n>=a&&(this.dMultiply(r),this.dAddOffset(s,0),n=0,s=0)}n>0&&(this.dMultiply(Math.pow(t,n)),this.dAddOffset(s,0)),i&&Y.ZERO.subTo(this,this)}function V1(e,t,a){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,a),this.testBit(e-1)||this.bitwiseTo(Y.ONE.shiftLeft(e-1),Ss,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(Y.ONE.shiftLeft(e-1),this);else{var r=new Array,i=e&7;r.length=(e>>3)+1,t.nextBytes(r),i>0?r[0]&=(1<<i)-1:r[0]=0,this.fromString(r,256)}}function K1(){var e=this.t,t=new Array;t[0]=this.s;var a=this.DB-e*this.DB%8,r,i=0;if(e-- >0)for(a<this.DB&&(r=this.data[e]>>a)!=(this.s&this.DM)>>a&&(t[i++]=r|this.s<<this.DB-a);e>=0;)a<8?(r=(this.data[e]&(1<<a)-1)<<8-a,r|=this.data[--e]>>(a+=this.DB-8)):(r=this.data[e]>>(a-=8)&255,a<=0&&(a+=this.DB,--e)),r&128&&(r|=-256),i==0&&(this.s&128)!=(r&128)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t}function q1(e){return this.compareTo(e)==0}function H1(e){return this.compareTo(e)<0?this:e}function z1(e){return this.compareTo(e)>0?this:e}function G1(e,t,a){var r,i,n=Math.min(e.t,this.t);for(r=0;r<n;++r)a.data[r]=t(this.data[r],e.data[r]);if(e.t<this.t){for(i=e.s&this.DM,r=n;r<this.t;++r)a.data[r]=t(this.data[r],i);a.t=this.t}else{for(i=this.s&this.DM,r=n;r<e.t;++r)a.data[r]=t(i,e.data[r]);a.t=e.t}a.s=t(this.s,e.s),a.clamp()}function j1(e,t){return e&t}function $1(e){var t=Re();return this.bitwiseTo(e,j1,t),t}function Ss(e,t){return e|t}function W1(e){var t=Re();return this.bitwiseTo(e,Ss,t),t}function Sc(e,t){return e^t}function Q1(e){var t=Re();return this.bitwiseTo(e,Sc,t),t}function Bc(e,t){return e&~t}function X1(e){var t=Re();return this.bitwiseTo(e,Bc,t),t}function Y1(){for(var e=Re(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function Z1(e){var t=Re();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function J1(e){var t=Re();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function ev(e){if(e==0)return-1;var t=0;return e&65535||(e>>=16,t+=16),e&255||(e>>=8,t+=8),e&15||(e>>=4,t+=4),e&3||(e>>=2,t+=2),e&1||++t,t}function tv(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+ev(this.data[e]);return this.s<0?this.t*this.DB:-1}function rv(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function av(){for(var e=0,t=this.s&this.DM,a=0;a<this.t;++a)e+=rv(this.data[a]^t);return e}function iv(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function nv(e,t){var a=Y.ONE.shiftLeft(e);return this.bitwiseTo(a,t,a),a}function sv(e){return this.changeBit(e,Ss)}function fv(e){return this.changeBit(e,Bc)}function ov(e){return this.changeBit(e,Sc)}function cv(e,t){for(var a=0,r=0,i=Math.min(e.t,this.t);a<i;)r+=this.data[a]+e.data[a],t.data[a++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;a<this.t;)r+=this.data[a],t.data[a++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;a<e.t;)r+=e.data[a],t.data[a++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t.data[a++]=r:r<-1&&(t.data[a++]=this.DV+r),t.t=a,t.clamp()}function uv(e){var t=Re();return this.addTo(e,t),t}function dv(e){var t=Re();return this.subTo(e,t),t}function lv(e){var t=Re();return this.multiplyTo(e,t),t}function hv(e){var t=Re();return this.divRemTo(e,t,null),t}function vv(e){var t=Re();return this.divRemTo(e,null,t),t}function pv(e){var t=Re(),a=Re();return this.divRemTo(e,t,a),new Array(t,a)}function xv(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function gv(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function oa(){}function _c(e){return e}function yv(e,t,a){e.multiplyTo(t,a)}function bv(e,t){e.squareTo(t)}oa.prototype.convert=_c;oa.prototype.revert=_c;oa.prototype.mulTo=yv;oa.prototype.sqrTo=bv;function mv(e){return this.exp(e,new oa)}function Cv(e,t,a){var r=Math.min(this.t+e.t,t);for(a.s=0,a.t=r;r>0;)a.data[--r]=0;var i;for(i=a.t-this.t;r<i;++r)a.data[r+this.t]=this.am(0,e.data[r],a,r,0,this.t);for(i=Math.min(e.t,t);r<i;++r)this.am(0,e.data[r],a,r,0,t-r);a.clamp()}function Ev(e,t,a){--t;var r=a.t=this.t+e.t-t;for(a.s=0;--r>=0;)a.data[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)a.data[this.t+r-t]=this.am(t-r,e.data[r],a,0,0,this.t+r-t);a.clamp(),a.drShiftTo(1,a)}function H0(e){this.r2=Re(),this.q3=Re(),Y.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function Av(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=Re();return e.copyTo(t),this.reduce(t),t}function Sv(e){return e}function Bv(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function _v(e,t){e.squareTo(t),this.reduce(t)}function Iv(e,t,a){e.multiplyTo(t,a),this.reduce(a)}H0.prototype.convert=Av;H0.prototype.revert=Sv;H0.prototype.reduce=Bv;H0.prototype.mulTo=Iv;H0.prototype.sqrTo=_v;function Tv(e,t){var a=e.bitLength(),r,i=qr(1),n;if(a<=0)return i;a<18?r=1:a<48?r=3:a<144?r=4:a<768?r=5:r=6,a<8?n=new x0(t):t.isEven()?n=new H0(t):n=new g0(t);var s=new Array,f=3,u=r-1,o=(1<<r)-1;if(s[1]=n.convert(this),r>1){var c=Re();for(n.sqrTo(s[1],c);f<=o;)s[f]=Re(),n.mulTo(c,s[f-2],s[f]),f+=2}var l=e.t-1,h,g=!0,v=Re(),y;for(a=fi(e.data[l])-1;l>=0;){for(a>=u?h=e.data[l]>>a-u&o:(h=(e.data[l]&(1<<a+1)-1)<<u-a,l>0&&(h|=e.data[l-1]>>this.DB+a-u)),f=r;!(h&1);)h>>=1,--f;if((a-=f)<0&&(a+=this.DB,--l),g)s[h].copyTo(i),g=!1;else{for(;f>1;)n.sqrTo(i,v),n.sqrTo(v,i),f-=2;f>0?n.sqrTo(i,v):(y=i,i=v,v=y),n.mulTo(v,s[h],i)}for(;l>=0&&!(e.data[l]&1<<a);)n.sqrTo(i,v),y=i,i=v,v=y,--a<0&&(a=this.DB-1,--l)}return n.revert(i)}function wv(e){var t=this.s<0?this.negate():this.clone(),a=e.s<0?e.negate():e.clone();if(t.compareTo(a)<0){var r=t;t=a,a=r}var i=t.getLowestSetBit(),n=a.getLowestSetBit();if(n<0)return t;for(i<n&&(n=i),n>0&&(t.rShiftTo(n,t),a.rShiftTo(n,a));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=a.getLowestSetBit())>0&&a.rShiftTo(i,a),t.compareTo(a)>=0?(t.subTo(a,t),t.rShiftTo(1,t)):(a.subTo(t,a),a.rShiftTo(1,a));return n>0&&a.lShiftTo(n,a),a}function Dv(e){if(e<=0)return 0;var t=this.DV%e,a=this.s<0?e-1:0;if(this.t>0)if(t==0)a=this.data[0]%e;else for(var r=this.t-1;r>=0;--r)a=(t*a+this.data[r])%e;return a}function Nv(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return Y.ZERO;for(var a=e.clone(),r=this.clone(),i=qr(1),n=qr(0),s=qr(0),f=qr(1);a.signum()!=0;){for(;a.isEven();)a.rShiftTo(1,a),t?((!i.isEven()||!n.isEven())&&(i.addTo(this,i),n.subTo(e,n)),i.rShiftTo(1,i)):n.isEven()||n.subTo(e,n),n.rShiftTo(1,n);for(;r.isEven();)r.rShiftTo(1,r),t?((!s.isEven()||!f.isEven())&&(s.addTo(this,s),f.subTo(e,f)),s.rShiftTo(1,s)):f.isEven()||f.subTo(e,f),f.rShiftTo(1,f);a.compareTo(r)>=0?(a.subTo(r,a),t&&i.subTo(s,i),n.subTo(f,n)):(r.subTo(a,r),t&&s.subTo(i,s),f.subTo(n,f))}if(r.compareTo(Y.ONE)!=0)return Y.ZERO;if(f.compareTo(e)>=0)return f.subtract(e);if(f.signum()<0)f.addTo(e,f);else return f;return f.signum()<0?f.add(e):f}var rr=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Rv=(1<<26)/rr[rr.length-1];function Fv(e){var t,a=this.abs();if(a.t==1&&a.data[0]<=rr[rr.length-1]){for(t=0;t<rr.length;++t)if(a.data[0]==rr[t])return!0;return!1}if(a.isEven())return!1;for(t=1;t<rr.length;){for(var r=rr[t],i=t+1;i<rr.length&&r<Rv;)r*=rr[i++];for(r=a.modInt(r);t<i;)if(r%rr[t++]==0)return!1}return a.millerRabin(e)}function kv(e){var t=this.subtract(Y.ONE),a=t.getLowestSetBit();if(a<=0)return!1;for(var r=t.shiftRight(a),i=Mv(),n,s=0;s<e;++s){do n=new Y(this.bitLength(),i);while(n.compareTo(Y.ONE)<=0||n.compareTo(t)>=0);var f=n.modPow(r,this);if(f.compareTo(Y.ONE)!=0&&f.compareTo(t)!=0){for(var u=1;u++<a&&f.compareTo(t)!=0;)if(f=f.modPowInt(2,this),f.compareTo(Y.ONE)==0)return!1;if(f.compareTo(t)!=0)return!1}}return!0}function Mv(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}Y.prototype.chunkSize=L1;Y.prototype.toRadix=U1;Y.prototype.fromRadix=O1;Y.prototype.fromNumber=V1;Y.prototype.bitwiseTo=G1;Y.prototype.changeBit=nv;Y.prototype.addTo=cv;Y.prototype.dMultiply=xv;Y.prototype.dAddOffset=gv;Y.prototype.multiplyLowerTo=Cv;Y.prototype.multiplyUpperTo=Ev;Y.prototype.modInt=Dv;Y.prototype.millerRabin=kv;Y.prototype.clone=R1;Y.prototype.intValue=F1;Y.prototype.byteValue=k1;Y.prototype.shortValue=M1;Y.prototype.signum=P1;Y.prototype.toByteArray=K1;Y.prototype.equals=q1;Y.prototype.min=H1;Y.prototype.max=z1;Y.prototype.and=$1;Y.prototype.or=W1;Y.prototype.xor=Q1;Y.prototype.andNot=X1;Y.prototype.not=Y1;Y.prototype.shiftLeft=Z1;Y.prototype.shiftRight=J1;Y.prototype.getLowestSetBit=tv;Y.prototype.bitCount=av;Y.prototype.testBit=iv;Y.prototype.setBit=sv;Y.prototype.clearBit=fv;Y.prototype.flipBit=ov;Y.prototype.add=uv;Y.prototype.subtract=dv;Y.prototype.multiply=lv;Y.prototype.divide=hv;Y.prototype.remainder=vv;Y.prototype.divideAndRemainder=pv;Y.prototype.modPow=Tv;Y.prototype.modInverse=Nv;Y.prototype.pow=mv;Y.prototype.gcd=wv;Y.prototype.isProbablePrime=Fv;var lr=me,Ic=lr.sha1=lr.sha1||{};lr.md.sha1=lr.md.algorithms.sha1=Ic;Ic.create=function(){Tc||Lv();var e=null,t=lr.util.createBuffer(),a=new Array(80),r={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var i=r.messageLengthSize/4,n=0;n<i;++n)r.fullMessageLength.push(0);return t=lr.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},r},r.start(),r.update=function(i,n){n==="utf8"&&(i=lr.util.encodeUtf8(i));var s=i.length;r.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var f=r.fullMessageLength.length-1;f>=0;--f)r.fullMessageLength[f]+=s[1],s[1]=s[0]+(r.fullMessageLength[f]/4294967296>>>0),r.fullMessageLength[f]=r.fullMessageLength[f]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(i),zf(e,a,t),(t.read>2048||t.length()===0)&&t.compact(),r},r.digest=function(){var i=lr.util.createBuffer();i.putBytes(t.bytes());var n=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,s=n&r.blockLength-1;i.putBytes(On.substr(0,r.blockLength-s));for(var f,u,o=r.fullMessageLength[0]*8,c=0;c<r.fullMessageLength.length-1;++c)f=r.fullMessageLength[c+1]*8,u=f/4294967296>>>0,o+=u,i.putInt32(o>>>0),o=f>>>0;i.putInt32(o);var l={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};zf(l,a,i);var h=lr.util.createBuffer();return h.putInt32(l.h0),h.putInt32(l.h1),h.putInt32(l.h2),h.putInt32(l.h3),h.putInt32(l.h4),h},r};var On=null,Tc=!1;function Lv(){On="",On+=lr.util.fillString("\0",64),Tc=!0}function zf(e,t,a){for(var r,i,n,s,f,u,o,c,l=a.length();l>=64;){for(i=e.h0,n=e.h1,s=e.h2,f=e.h3,u=e.h4,c=0;c<16;++c)r=a.getInt32(),t[c]=r,o=f^n&(s^f),r=(i<<5|i>>>27)+o+u+1518500249+r,u=f,f=s,s=(n<<30|n>>>2)>>>0,n=i,i=r;for(;c<20;++c)r=t[c-3]^t[c-8]^t[c-14]^t[c-16],r=r<<1|r>>>31,t[c]=r,o=f^n&(s^f),r=(i<<5|i>>>27)+o+u+1518500249+r,u=f,f=s,s=(n<<30|n>>>2)>>>0,n=i,i=r;for(;c<32;++c)r=t[c-3]^t[c-8]^t[c-14]^t[c-16],r=r<<1|r>>>31,t[c]=r,o=n^s^f,r=(i<<5|i>>>27)+o+u+1859775393+r,u=f,f=s,s=(n<<30|n>>>2)>>>0,n=i,i=r;for(;c<40;++c)r=t[c-6]^t[c-16]^t[c-28]^t[c-32],r=r<<2|r>>>30,t[c]=r,o=n^s^f,r=(i<<5|i>>>27)+o+u+1859775393+r,u=f,f=s,s=(n<<30|n>>>2)>>>0,n=i,i=r;for(;c<60;++c)r=t[c-6]^t[c-16]^t[c-28]^t[c-32],r=r<<2|r>>>30,t[c]=r,o=n&s|f&(n^s),r=(i<<5|i>>>27)+o+u+2400959708+r,u=f,f=s,s=(n<<30|n>>>2)>>>0,n=i,i=r;for(;c<80;++c)r=t[c-6]^t[c-16]^t[c-28]^t[c-32],r=r<<2|r>>>30,t[c]=r,o=n^s^f,r=(i<<5|i>>>27)+o+u+3395469782+r,u=f,f=s,s=(n<<30|n>>>2)>>>0,n=i,i=r;e.h0=e.h0+i|0,e.h1=e.h1+n|0,e.h2=e.h2+s|0,e.h3=e.h3+f|0,e.h4=e.h4+u|0,l-=64}}var hr=me,wc=hr.pkcs1=hr.pkcs1||{};wc.encode_rsa_oaep=function(e,t,a){var r,i,n,s;typeof a=="string"?(r=a,i=arguments[3]||void 0,n=arguments[4]||void 0):a&&(r=a.label||void 0,i=a.seed||void 0,n=a.md||void 0,a.mgf1&&a.mgf1.md&&(s=a.mgf1.md)),n?n.start():n=hr.md.sha1.create(),s||(s=n);var f=Math.ceil(e.n.bitLength()/8),u=f-2*n.digestLength-2;if(t.length>u){var o=new Error("RSAES-OAEP input message length is too long.");throw o.length=t.length,o.maxLength=u,o}r||(r=""),n.update(r,"raw");for(var c=n.digest(),l="",h=u-t.length,g=0;g<h;g++)l+="\0";var v=c.getBytes()+l+""+t;if(!i)i=hr.random.getBytes(n.digestLength);else if(i.length!==n.digestLength){var o=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw o.seedLength=i.length,o.digestLength=n.digestLength,o}var y=Fa(i,f-n.digestLength-1,s),b=hr.util.xorBytes(v,y,v.length),I=Fa(b,n.digestLength,s),A=hr.util.xorBytes(i,I,i.length);return"\0"+A+b};wc.decode_rsa_oaep=function(e,t,a){var r,i,n;typeof a=="string"?(r=a,i=arguments[3]||void 0):a&&(r=a.label||void 0,i=a.md||void 0,a.mgf1&&a.mgf1.md&&(n=a.mgf1.md));var s=Math.ceil(e.n.bitLength()/8);if(t.length!==s){var b=new Error("RSAES-OAEP encoded message length is invalid.");throw b.length=t.length,b.expectedLength=s,b}if(i===void 0?i=hr.md.sha1.create():i.start(),n||(n=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");r||(r=""),i.update(r,"raw");for(var f=i.digest().getBytes(),u=t.charAt(0),o=t.substring(1,i.digestLength+1),c=t.substring(1+i.digestLength),l=Fa(c,i.digestLength,n),h=hr.util.xorBytes(o,l,o.length),g=Fa(h,s-i.digestLength-1,n),v=hr.util.xorBytes(c,g,c.length),y=v.substring(0,i.digestLength),b=u!=="\0",I=0;I<i.digestLength;++I)b|=f.charAt(I)!==y.charAt(I);for(var A=1,w=i.digestLength,N=i.digestLength;N<v.length;N++){var k=v.charCodeAt(N),M=k&1^1,V=A?65534:0;b|=k&V,A=A&M,w+=A}if(b||v.charCodeAt(w)!==1)throw new Error("Invalid RSAES-OAEP padding.");return v.substring(w+1)};function Fa(e,t,a){a||(a=hr.md.sha1.create());for(var r="",i=Math.ceil(t/a.digestLength),n=0;n<i;++n){var s=String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255);a.start(),a.update(e+s),r+=a.digest().getBytes()}return r.substring(0,t)}var Lr=me;(function(){if(Lr.prime){Lr.prime;return}var e=Lr.prime=Lr.prime||{},t=Lr.jsbn.BigInteger,a=[6,4,2,4,2,4,6,2],r=new t(null);r.fromInt(30);var i=function(l,h){return l|h};e.generateProbablePrime=function(l,h,g){typeof h=="function"&&(g=h,h={}),h=h||{};var v=h.algorithm||"PRIMEINC";typeof v=="string"&&(v={name:v}),v.options=v.options||{};var y=h.prng||Lr.random,b={nextBytes:function(I){for(var A=y.getBytesSync(I.length),w=0;w<I.length;++w)I[w]=A.charCodeAt(w)}};if(v.name==="PRIMEINC")return n(l,b,v.options,g);throw new Error("Invalid prime generation algorithm: "+v.name)};function n(l,h,g,v){return"workers"in g?u(l,h,g,v):s(l,h,g,v)}function s(l,h,g,v){var y=o(l,h),b=0,I=c(y.bitLength());"millerRabinTests"in g&&(I=g.millerRabinTests);var A=10;"maxBlockTime"in g&&(A=g.maxBlockTime),f(y,l,h,b,I,A,v)}function f(l,h,g,v,y,b,I){var A=+new Date;do{if(l.bitLength()>h&&(l=o(h,g)),l.isProbablePrime(y))return I(null,l);l.dAddOffset(a[v++%8],0)}while(b<0||+new Date-A<b);Lr.util.setImmediate(function(){f(l,h,g,v,y,b,I)})}function u(l,h,g,v){if(typeof Worker>"u")return s(l,h,g,v);var y=o(l,h),b=g.workers,I=g.workLoad||100,A=I*30/8,w=g.workerScript||"forge/prime.worker.js";if(b===-1)return Lr.util.estimateCores(function(k,M){k&&(M=2),b=M-1,N()});N();function N(){b=Math.max(1,b);for(var k=[],M=0;M<b;++M)k[M]=new Worker(w);for(var M=0;M<b;++M)k[M].addEventListener("message",z);var V=!1;function z(W){if(!V){var U=W.data;if(U.found){for(var C=0;C<k.length;++C)k[C].terminate();return V=!0,v(null,new t(U.prime,16))}y.bitLength()>l&&(y=o(l,h));var d=y.toString(16);W.target.postMessage({hex:d,workLoad:I}),y.dAddOffset(A,0)}}}}function o(l,h){var g=new t(l,h),v=l-1;return g.testBit(v)||g.bitwiseTo(t.ONE.shiftLeft(v),i,g),g.dAddOffset(31-g.mod(r).byteValue(),0),g}function c(l){return l<=100?27:l<=150?18:l<=200?15:l<=250?12:l<=300?9:l<=350?8:l<=400?7:l<=500?6:l<=600?5:l<=800?4:l<=1250?3:2}})();var oe=me;if(typeof Ne>"u")var Ne=oe.jsbn.BigInteger;var Vn=oe.util.isNodejs?k0:null,$=oe.asn1,$t=oe.util;oe.pki=oe.pki||{};oe.pki.rsa=oe.rsa=oe.rsa||{};var xe=oe.pki,Pv=[6,4,2,4,2,4,6,2],Uv={name:"PrivateKeyInfo",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:$.Class.UNIVERSAL,type:$.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:$.Class.UNIVERSAL,type:$.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:$.Class.UNIVERSAL,type:$.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Ov={name:"RSAPrivateKey",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:$.Class.UNIVERSAL,type:$.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:$.Class.UNIVERSAL,type:$.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:$.Class.UNIVERSAL,type:$.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:$.Class.UNIVERSAL,type:$.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:$.Class.UNIVERSAL,type:$.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:$.Class.UNIVERSAL,type:$.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:$.Class.UNIVERSAL,type:$.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:$.Class.UNIVERSAL,type:$.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:$.Class.UNIVERSAL,type:$.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Vv={name:"RSAPublicKey",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:$.Class.UNIVERSAL,type:$.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:$.Class.UNIVERSAL,type:$.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Kv=oe.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:$.Class.UNIVERSAL,type:$.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:$.Class.UNIVERSAL,type:$.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},qv={name:"DigestInfo",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:$.Class.UNIVERSAL,type:$.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:$.Class.UNIVERSAL,type:$.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:$.Class.UNIVERSAL,type:$.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Hv=function(e){var t;if(e.algorithm in xe.oids)t=xe.oids[e.algorithm];else{var a=new Error("Unknown message digest algorithm.");throw a.algorithm=e.algorithm,a}var r=$.oidToDer(t).getBytes(),i=$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[]),n=$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[]);n.value.push($.create($.Class.UNIVERSAL,$.Type.OID,!1,r)),n.value.push($.create($.Class.UNIVERSAL,$.Type.NULL,!1,""));var s=$.create($.Class.UNIVERSAL,$.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(n),i.value.push(s),$.toDer(i).getBytes()},Dc=function(e,t,a){if(a)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(Ne.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(Ne.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var r;do r=new Ne(oe.util.bytesToHex(oe.random.getBytes(t.n.bitLength()/8)),16);while(r.compareTo(t.n)>=0||!r.gcd(t.n).equals(Ne.ONE));e=e.multiply(r.modPow(t.e,t.n)).mod(t.n);for(var i=e.mod(t.p).modPow(t.dP,t.p),n=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(n)<0;)i=i.add(t.p);var s=i.subtract(n).multiply(t.qInv).mod(t.p).multiply(t.q).add(n);return s=s.multiply(r.modInverse(t.n)).mod(t.n),s};xe.rsa.encrypt=function(e,t,a){var r=a,i,n=Math.ceil(t.n.bitLength()/8);a!==!1&&a!==!0?(r=a===2,i=Nc(e,t,a)):(i=oe.util.createBuffer(),i.putBytes(e));for(var s=new Ne(i.toHex(),16),f=Dc(s,t,r),u=f.toString(16),o=oe.util.createBuffer(),c=n-Math.ceil(u.length/2);c>0;)o.putByte(0),--c;return o.putBytes(oe.util.hexToBytes(u)),o.getBytes()};xe.rsa.decrypt=function(e,t,a,r){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var n=new Error("Encrypted message length is invalid.");throw n.length=e.length,n.expected=i,n}var s=new Ne(oe.util.createBuffer(e).toHex(),16);if(s.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var f=Dc(s,t,a),u=f.toString(16),o=oe.util.createBuffer(),c=i-Math.ceil(u.length/2);c>0;)o.putByte(0),--c;return o.putBytes(oe.util.hexToBytes(u)),r!==!1?ka(o.getBytes(),t,a):o.getBytes()};xe.rsa.createKeyPairGenerationState=function(e,t,a){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,a=a||{};var r=a.prng||oe.random,i={nextBytes:function(f){for(var u=r.getBytesSync(f.length),o=0;o<f.length;++o)f[o]=u.charCodeAt(o)}},n=a.algorithm||"PRIMEINC",s;if(n==="PRIMEINC")s={algorithm:n,state:0,bits:e,rng:i,eInt:t||65537,e:new Ne(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+n);return s};xe.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var a=new Ne(null);a.fromInt(30);for(var r=0,i=function(l,h){return l|h},n=+new Date,s,f=0;e.keys===null&&(t<=0||f<t);){if(e.state===0){var u=e.p===null?e.pBits:e.qBits,o=u-1;e.pqState===0?(e.num=new Ne(u,e.rng),e.num.testBit(o)||e.num.bitwiseTo(Ne.ONE.shiftLeft(o),i,e.num),e.num.dAddOffset(31-e.num.mod(a).byteValue(),0),r=0,++e.pqState):e.pqState===1?e.num.bitLength()>u?e.pqState=0:e.num.isProbablePrime(Gv(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(Pv[r++%8],0):e.pqState===2?e.pqState=e.num.subtract(Ne.ONE).gcd(e.e).compareTo(Ne.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(Ne.ONE),e.q1=e.q.subtract(Ne.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(Ne.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var c=e.e.modInverse(e.phi);e.keys={privateKey:xe.rsa.setPrivateKey(e.n,e.e,c,e.p,e.q,c.mod(e.p1),c.mod(e.q1),e.q.modInverse(e.p)),publicKey:xe.rsa.setPublicKey(e.n,e.e)}}s=+new Date,f+=s-n,n=s}return e.keys!==null};xe.rsa.generateKeyPair=function(e,t,a,r){if(arguments.length===1?typeof e=="object"?(a=e,e=void 0):typeof e=="function"&&(r=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(r=t,t=void 0):typeof t!="number"&&(a=t,t=void 0):(a=e,r=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof a=="function"&&(r=a,a=void 0):(r=a,a=t,t=void 0)),a=a||{},e===void 0&&(e=a.bits||2048),t===void 0&&(t=a.e||65537),!oe.options.usePureJavaScript&&!a.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(r){if(Gf("generateKeyPair"))return Vn.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(f,u,o){if(f)return r(f);r(null,{privateKey:xe.privateKeyFromPem(o),publicKey:xe.publicKeyFromPem(u)})});if(jf("generateKey")&&jf("exportKey"))return $t.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:Wf(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(f){return $t.globalScope.crypto.subtle.exportKey("pkcs8",f.privateKey)}).then(void 0,function(f){r(f)}).then(function(f){if(f){var u=xe.privateKeyFromAsn1($.fromDer(oe.util.createBuffer(f)));r(null,{privateKey:u,publicKey:xe.setRsaPublicKey(u.n,u.e)})}});if($f("generateKey")&&$f("exportKey")){var i=$t.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:Wf(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(f){var u=f.target.result,o=$t.globalScope.msCrypto.subtle.exportKey("pkcs8",u.privateKey);o.oncomplete=function(c){var l=c.target.result,h=xe.privateKeyFromAsn1($.fromDer(oe.util.createBuffer(l)));r(null,{privateKey:h,publicKey:xe.setRsaPublicKey(h.n,h.e)})},o.onerror=function(c){r(c)}},i.onerror=function(f){r(f)};return}}else if(Gf("generateKeyPairSync")){var n=Vn.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:xe.privateKeyFromPem(n.privateKey),publicKey:xe.publicKeyFromPem(n.publicKey)}}}var s=xe.rsa.createKeyPairGenerationState(e,t,a);if(!r)return xe.rsa.stepKeyPairGenerationState(s,0),s.keys;zv(s,a,r)};xe.setRsaPublicKey=xe.rsa.setPublicKey=function(e,t){var a={n:e,e:t};return a.encrypt=function(r,i,n){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(f,u,o){return Nc(f,u,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(f,u){return oe.pkcs1.encode_rsa_oaep(u,f,n)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(f){return f}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(r,a,!0);return xe.rsa.encrypt(s,a,!0)},a.verify=function(r,i,n,s){typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),n==="RSASSA-PKCS1-V1_5"?n={verify:function(u,o){o=ka(o,a,!0);var c=$.fromDer(o,{parseAllBytes:s._parseAllDigestBytes}),l={},h=[];if(!$.validate(c,qv,l,h)){var g=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw g.errors=h,g}var v=$.derToOid(l.algorithmIdentifier);if(!(v===oe.oids.md2||v===oe.oids.md5||v===oe.oids.sha1||v===oe.oids.sha224||v===oe.oids.sha256||v===oe.oids.sha384||v===oe.oids.sha512||v===oe.oids["sha512-224"]||v===oe.oids["sha512-256"])){var g=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw g.oid=v,g}if((v===oe.oids.md2||v===oe.oids.md5)&&!("parameters"in l))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return u===l.digest}}:(n==="NONE"||n==="NULL"||n===null)&&(n={verify:function(u,o){return o=ka(o,a,!0),u===o}});var f=xe.rsa.decrypt(i,a,!0,!1);return n.verify(r,f,a.n.bitLength())},a};xe.setRsaPrivateKey=xe.rsa.setPrivateKey=function(e,t,a,r,i,n,s,f){var u={n:e,e:t,d:a,p:r,q:i,dP:n,dQ:s,qInv:f};return u.decrypt=function(o,c,l){typeof c=="string"?c=c.toUpperCase():c===void 0&&(c="RSAES-PKCS1-V1_5");var h=xe.rsa.decrypt(o,u,!1,!1);if(c==="RSAES-PKCS1-V1_5")c={decode:ka};else if(c==="RSA-OAEP"||c==="RSAES-OAEP")c={decode:function(g,v){return oe.pkcs1.decode_rsa_oaep(v,g,l)}};else if(["RAW","NONE","NULL",null].indexOf(c)!==-1)c={decode:function(g){return g}};else throw new Error('Unsupported encryption scheme: "'+c+'".');return c.decode(h,u,!1)},u.sign=function(o,c){var l=!1;typeof c=="string"&&(c=c.toUpperCase()),c===void 0||c==="RSASSA-PKCS1-V1_5"?(c={encode:Hv},l=1):(c==="NONE"||c==="NULL"||c===null)&&(c={encode:function(){return o}},l=1);var h=c.encode(o,u.n.bitLength());return xe.rsa.encrypt(h,u,l)},u};xe.wrapRsaPrivateKey=function(e){return $.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,$.integerToDer(0).getBytes()),$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(xe.oids.rsaEncryption).getBytes()),$.create($.Class.UNIVERSAL,$.Type.NULL,!1,"")]),$.create($.Class.UNIVERSAL,$.Type.OCTETSTRING,!1,$.toDer(e).getBytes())])};xe.privateKeyFromAsn1=function(e){var t={},a=[];if($.validate(e,Uv,t,a)&&(e=$.fromDer(oe.util.createBuffer(t.privateKey))),t={},a=[],!$.validate(e,Ov,t,a)){var r=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw r.errors=a,r}var i,n,s,f,u,o,c,l;return i=oe.util.createBuffer(t.privateKeyModulus).toHex(),n=oe.util.createBuffer(t.privateKeyPublicExponent).toHex(),s=oe.util.createBuffer(t.privateKeyPrivateExponent).toHex(),f=oe.util.createBuffer(t.privateKeyPrime1).toHex(),u=oe.util.createBuffer(t.privateKeyPrime2).toHex(),o=oe.util.createBuffer(t.privateKeyExponent1).toHex(),c=oe.util.createBuffer(t.privateKeyExponent2).toHex(),l=oe.util.createBuffer(t.privateKeyCoefficient).toHex(),xe.setRsaPrivateKey(new Ne(i,16),new Ne(n,16),new Ne(s,16),new Ne(f,16),new Ne(u,16),new Ne(o,16),new Ne(c,16),new Ne(l,16))};xe.privateKeyToAsn1=xe.privateKeyToRSAPrivateKey=function(e){return $.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,$.integerToDer(0).getBytes()),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,fr(e.n)),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,fr(e.e)),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,fr(e.d)),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,fr(e.p)),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,fr(e.q)),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,fr(e.dP)),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,fr(e.dQ)),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,fr(e.qInv))])};xe.publicKeyFromAsn1=function(e){var t={},a=[];if($.validate(e,Kv,t,a)){var r=$.derToOid(t.publicKeyOid);if(r!==xe.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=r,i}e=t.rsaPublicKey}if(a=[],!$.validate(e,Vv,t,a)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=a,i}var n=oe.util.createBuffer(t.publicKeyModulus).toHex(),s=oe.util.createBuffer(t.publicKeyExponent).toHex();return xe.setRsaPublicKey(new Ne(n,16),new Ne(s,16))};xe.publicKeyToAsn1=xe.publicKeyToSubjectPublicKeyInfo=function(e){return $.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(xe.oids.rsaEncryption).getBytes()),$.create($.Class.UNIVERSAL,$.Type.NULL,!1,"")]),$.create($.Class.UNIVERSAL,$.Type.BITSTRING,!1,[xe.publicKeyToRSAPublicKey(e)])])};xe.publicKeyToRSAPublicKey=function(e){return $.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,fr(e.n)),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,fr(e.e))])};function Nc(e,t,a){var r=oe.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var n=new Error("Message is too long for PKCS#1 v1.5 padding.");throw n.length=e.length,n.max=i-11,n}r.putByte(0),r.putByte(a);var s=i-3-e.length,f;if(a===0||a===1){f=a===0?0:255;for(var u=0;u<s;++u)r.putByte(f)}else for(;s>0;){for(var o=0,c=oe.random.getBytes(s),u=0;u<s;++u)f=c.charCodeAt(u),f===0?++o:r.putByte(f);s=o}return r.putByte(0),r.putBytes(e),r}function ka(e,t,a,r){var i=Math.ceil(t.n.bitLength()/8),n=oe.util.createBuffer(e),s=n.getByte(),f=n.getByte();if(s!==0||a&&f!==0&&f!==1||!a&&f!=2||a&&f===0&&typeof r>"u")throw new Error("Encryption block is invalid.");var u=0;if(f===0){u=i-3-r;for(var o=0;o<u;++o)if(n.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(f===1)for(u=0;n.length()>1;){if(n.getByte()!==255){--n.read;break}++u}else if(f===2)for(u=0;n.length()>1;){if(n.getByte()===0){--n.read;break}++u}var c=n.getByte();if(c!==0||u!==i-3-n.length())throw new Error("Encryption block is invalid.");return n.getBytes()}function zv(e,t,a){typeof t=="function"&&(a=t,t={}),t=t||{};var r={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(r.prng=t.prng),i();function i(){n(e.pBits,function(f,u){if(f)return a(f);if(e.p=u,e.q!==null)return s(f,e.q);n(e.qBits,s)})}function n(f,u){oe.prime.generateProbablePrime(f,r,u)}function s(f,u){if(f)return a(f);if(e.q=u,e.p.compareTo(e.q)<0){var o=e.p;e.p=e.q,e.q=o}if(e.p.subtract(Ne.ONE).gcd(e.e).compareTo(Ne.ONE)!==0){e.p=null,i();return}if(e.q.subtract(Ne.ONE).gcd(e.e).compareTo(Ne.ONE)!==0){e.q=null,n(e.qBits,s);return}if(e.p1=e.p.subtract(Ne.ONE),e.q1=e.q.subtract(Ne.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(Ne.ONE)!==0){e.p=e.q=null,i();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,n(e.qBits,s);return}var c=e.e.modInverse(e.phi);e.keys={privateKey:xe.rsa.setPrivateKey(e.n,e.e,c,e.p,e.q,c.mod(e.p1),c.mod(e.q1),e.q.modInverse(e.p)),publicKey:xe.rsa.setPublicKey(e.n,e.e)},a(null,e.keys)}}function fr(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var a=oe.util.hexToBytes(t);return a.length>1&&(a.charCodeAt(0)===0&&!(a.charCodeAt(1)&128)||a.charCodeAt(0)===255&&(a.charCodeAt(1)&128)===128)?a.substr(1):a}function Gv(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function Gf(e){return oe.util.isNodejs&&typeof Vn[e]=="function"}function jf(e){return typeof $t.globalScope<"u"&&typeof $t.globalScope.crypto=="object"&&typeof $t.globalScope.crypto.subtle=="object"&&typeof $t.globalScope.crypto.subtle[e]=="function"}function $f(e){return typeof $t.globalScope<"u"&&typeof $t.globalScope.msCrypto=="object"&&typeof $t.globalScope.msCrypto.subtle=="object"&&typeof $t.globalScope.msCrypto.subtle[e]=="function"}function Wf(e){for(var t=oe.util.hexToBytes(e.toString(16)),a=new Uint8Array(t.length),r=0;r<t.length;++r)a[r]=t.charCodeAt(r);return a}var ne=me;if(typeof jv>"u")var jv=ne.jsbn.BigInteger;var Q=ne.asn1,ye=ne.pki=ne.pki||{};ye.pbe=ne.pbe=ne.pbe||{};var Jr=ye.oids,$v={name:"EncryptedPrivateKeyInfo",tagClass:Q.Class.UNIVERSAL,type:Q.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:Q.Class.UNIVERSAL,type:Q.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Q.Class.UNIVERSAL,type:Q.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:Q.Class.UNIVERSAL,type:Q.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:Q.Class.UNIVERSAL,type:Q.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Wv={name:"PBES2Algorithms",tagClass:Q.Class.UNIVERSAL,type:Q.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:Q.Class.UNIVERSAL,type:Q.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:Q.Class.UNIVERSAL,type:Q.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:Q.Class.UNIVERSAL,type:Q.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:Q.Class.UNIVERSAL,type:Q.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:Q.Class.UNIVERSAL,type:Q.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:Q.Class.UNIVERSAL,type:Q.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:Q.Class.UNIVERSAL,type:Q.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:Q.Class.UNIVERSAL,type:Q.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:Q.Class.UNIVERSAL,type:Q.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:Q.Class.UNIVERSAL,type:Q.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:Q.Class.UNIVERSAL,type:Q.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Qv={name:"pkcs-12PbeParams",tagClass:Q.Class.UNIVERSAL,type:Q.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:Q.Class.UNIVERSAL,type:Q.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:Q.Class.UNIVERSAL,type:Q.Type.INTEGER,constructed:!1,capture:"iterations"}]};ye.encryptPrivateKeyInfo=function(e,t,a){a=a||{},a.saltSize=a.saltSize||8,a.count=a.count||2048,a.algorithm=a.algorithm||"aes128",a.prfAlgorithm=a.prfAlgorithm||"sha1";var r=ne.random.getBytesSync(a.saltSize),i=a.count,n=Q.integerToDer(i),s,f,u;if(a.algorithm.indexOf("aes")===0||a.algorithm==="des"){var o,c,l;switch(a.algorithm){case"aes128":s=16,o=16,c=Jr["aes128-CBC"],l=ne.aes.createEncryptionCipher;break;case"aes192":s=24,o=16,c=Jr["aes192-CBC"],l=ne.aes.createEncryptionCipher;break;case"aes256":s=32,o=16,c=Jr["aes256-CBC"],l=ne.aes.createEncryptionCipher;break;case"des":s=8,o=8,c=Jr.desCBC,l=ne.des.createEncryptionCipher;break;default:var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=a.algorithm,h}var g="hmacWith"+a.prfAlgorithm.toUpperCase(),v=Fc(g),y=ne.pkcs5.pbkdf2(t,r,i,s,v),b=ne.random.getBytesSync(o),I=l(y);I.start(b),I.update(Q.toDer(e)),I.finish(),u=I.output.getBytes();var A=Xv(r,n,s,g);f=Q.create(Q.Class.UNIVERSAL,Q.Type.SEQUENCE,!0,[Q.create(Q.Class.UNIVERSAL,Q.Type.OID,!1,Q.oidToDer(Jr.pkcs5PBES2).getBytes()),Q.create(Q.Class.UNIVERSAL,Q.Type.SEQUENCE,!0,[Q.create(Q.Class.UNIVERSAL,Q.Type.SEQUENCE,!0,[Q.create(Q.Class.UNIVERSAL,Q.Type.OID,!1,Q.oidToDer(Jr.pkcs5PBKDF2).getBytes()),A]),Q.create(Q.Class.UNIVERSAL,Q.Type.SEQUENCE,!0,[Q.create(Q.Class.UNIVERSAL,Q.Type.OID,!1,Q.oidToDer(c).getBytes()),Q.create(Q.Class.UNIVERSAL,Q.Type.OCTETSTRING,!1,b)])])])}else if(a.algorithm==="3des"){s=24;var w=new ne.util.ByteBuffer(r),y=ye.pbe.generatePkcs12Key(t,w,1,i,s),b=ye.pbe.generatePkcs12Key(t,w,2,i,s),I=ne.des.createEncryptionCipher(y);I.start(b),I.update(Q.toDer(e)),I.finish(),u=I.output.getBytes(),f=Q.create(Q.Class.UNIVERSAL,Q.Type.SEQUENCE,!0,[Q.create(Q.Class.UNIVERSAL,Q.Type.OID,!1,Q.oidToDer(Jr["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),Q.create(Q.Class.UNIVERSAL,Q.Type.SEQUENCE,!0,[Q.create(Q.Class.UNIVERSAL,Q.Type.OCTETSTRING,!1,r),Q.create(Q.Class.UNIVERSAL,Q.Type.INTEGER,!1,n.getBytes())])])}else{var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=a.algorithm,h}var N=Q.create(Q.Class.UNIVERSAL,Q.Type.SEQUENCE,!0,[f,Q.create(Q.Class.UNIVERSAL,Q.Type.OCTETSTRING,!1,u)]);return N};ye.decryptPrivateKeyInfo=function(e,t){var a=null,r={},i=[];if(!Q.validate(e,$v,r,i)){var n=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw n.errors=i,n}var s=Q.derToOid(r.encryptionOid),f=ye.pbe.getCipher(s,r.encryptionParams,t),u=ne.util.createBuffer(r.encryptedData);return f.update(u),f.finish()&&(a=Q.fromDer(f.output)),a};ye.encryptedPrivateKeyToPem=function(e,t){var a={type:"ENCRYPTED PRIVATE KEY",body:Q.toDer(e).getBytes()};return ne.pem.encode(a,{maxline:t})};ye.encryptedPrivateKeyFromPem=function(e){var t=ne.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var a=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return Q.fromDer(t.body)};ye.encryptRsaPrivateKey=function(e,t,a){if(a=a||{},!a.legacy){var r=ye.wrapRsaPrivateKey(ye.privateKeyToAsn1(e));return r=ye.encryptPrivateKeyInfo(r,t,a),ye.encryptedPrivateKeyToPem(r)}var i,n,s,f;switch(a.algorithm){case"aes128":i="AES-128-CBC",s=16,n=ne.random.getBytesSync(16),f=ne.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,n=ne.random.getBytesSync(16),f=ne.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,n=ne.random.getBytesSync(16),f=ne.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,n=ne.random.getBytesSync(8),f=ne.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,n=ne.random.getBytesSync(8),f=ne.des.createEncryptionCipher;break;default:var u=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+a.algorithm+'".');throw u.algorithm=a.algorithm,u}var o=ne.pbe.opensslDeriveBytes(t,n.substr(0,8),s),c=f(o);c.start(n),c.update(Q.toDer(ye.privateKeyToAsn1(e))),c.finish();var l={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:ne.util.bytesToHex(n).toUpperCase()},body:c.output.getBytes()};return ne.pem.encode(l)};ye.decryptRsaPrivateKey=function(e,t){var a=null,r=ne.pem.decode(e)[0];if(r.type!=="ENCRYPTED PRIVATE KEY"&&r.type!=="PRIVATE KEY"&&r.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(r.procType&&r.procType.type==="ENCRYPTED"){var n,s;switch(r.dekInfo.algorithm){case"DES-CBC":n=8,s=ne.des.createDecryptionCipher;break;case"DES-EDE3-CBC":n=24,s=ne.des.createDecryptionCipher;break;case"AES-128-CBC":n=16,s=ne.aes.createDecryptionCipher;break;case"AES-192-CBC":n=24,s=ne.aes.createDecryptionCipher;break;case"AES-256-CBC":n=32,s=ne.aes.createDecryptionCipher;break;case"RC2-40-CBC":n=5,s=function(l){return ne.rc2.createDecryptionCipher(l,40)};break;case"RC2-64-CBC":n=8,s=function(l){return ne.rc2.createDecryptionCipher(l,64)};break;case"RC2-128-CBC":n=16,s=function(l){return ne.rc2.createDecryptionCipher(l,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+r.dekInfo.algorithm+'".');throw i.algorithm=r.dekInfo.algorithm,i}var f=ne.util.hexToBytes(r.dekInfo.parameters),u=ne.pbe.opensslDeriveBytes(t,f.substr(0,8),n),o=s(u);if(o.start(f),o.update(ne.util.createBuffer(r.body)),o.finish())a=o.output.getBytes();else return a}else a=r.body;return r.type==="ENCRYPTED PRIVATE KEY"?a=ye.decryptPrivateKeyInfo(Q.fromDer(a),t):a=Q.fromDer(a),a!==null&&(a=ye.privateKeyFromAsn1(a)),a};ye.pbe.generatePkcs12Key=function(e,t,a,r,i,n){var s,f;if(typeof n>"u"||n===null){if(!("sha1"in ne.md))throw new Error('"sha1" hash algorithm unavailable.');n=ne.md.sha1.create()}var u=n.digestLength,o=n.blockLength,c=new ne.util.ByteBuffer,l=new ne.util.ByteBuffer;if(e!=null){for(f=0;f<e.length;f++)l.putInt16(e.charCodeAt(f));l.putInt16(0)}var h=l.length(),g=t.length(),v=new ne.util.ByteBuffer;v.fillWithByte(a,o);var y=o*Math.ceil(g/o),b=new ne.util.ByteBuffer;for(f=0;f<y;f++)b.putByte(t.at(f%g));var I=o*Math.ceil(h/o),A=new ne.util.ByteBuffer;for(f=0;f<I;f++)A.putByte(l.at(f%h));var w=b;w.putBuffer(A);for(var N=Math.ceil(i/u),k=1;k<=N;k++){var M=new ne.util.ByteBuffer;M.putBytes(v.bytes()),M.putBytes(w.bytes());for(var V=0;V<r;V++)n.start(),n.update(M.getBytes()),M=n.digest();var z=new ne.util.ByteBuffer;for(f=0;f<o;f++)z.putByte(M.at(f%u));var W=Math.ceil(g/o)+Math.ceil(h/o),U=new ne.util.ByteBuffer;for(s=0;s<W;s++){var C=new ne.util.ByteBuffer(w.getBytes(o)),d=511;for(f=z.length()-1;f>=0;f--)d=d>>8,d+=z.at(f)+C.at(f),C.setAt(f,d&255);U.putBuffer(C)}w=U,c.putBuffer(M)}return c.truncate(c.length()-i),c};ye.pbe.getCipher=function(e,t,a){switch(e){case ye.oids.pkcs5PBES2:return ye.pbe.getCipherForPBES2(e,t,a);case ye.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case ye.oids["pbewithSHAAnd40BitRC2-CBC"]:return ye.pbe.getCipherForPKCS12PBE(e,t,a);default:var r=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw r.oid=e,r.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],r}};ye.pbe.getCipherForPBES2=function(e,t,a){var r={},i=[];if(!Q.validate(t,Wv,r,i)){var n=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw n.errors=i,n}if(e=Q.derToOid(r.kdfOid),e!==ye.oids.pkcs5PBKDF2){var n=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw n.oid=e,n.supportedOids=["pkcs5PBKDF2"],n}if(e=Q.derToOid(r.encOid),e!==ye.oids["aes128-CBC"]&&e!==ye.oids["aes192-CBC"]&&e!==ye.oids["aes256-CBC"]&&e!==ye.oids["des-EDE3-CBC"]&&e!==ye.oids.desCBC){var n=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw n.oid=e,n.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],n}var s=r.kdfSalt,f=ne.util.createBuffer(r.kdfIterationCount);f=f.getInt(f.length()<<3);var u,o;switch(ye.oids[e]){case"aes128-CBC":u=16,o=ne.aes.createDecryptionCipher;break;case"aes192-CBC":u=24,o=ne.aes.createDecryptionCipher;break;case"aes256-CBC":u=32,o=ne.aes.createDecryptionCipher;break;case"des-EDE3-CBC":u=24,o=ne.des.createDecryptionCipher;break;case"desCBC":u=8,o=ne.des.createDecryptionCipher;break}var c=Rc(r.prfOid),l=ne.pkcs5.pbkdf2(a,s,f,u,c),h=r.encIv,g=o(l);return g.start(h),g};ye.pbe.getCipherForPKCS12PBE=function(e,t,a){var r={},i=[];if(!Q.validate(t,Qv,r,i)){var n=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw n.errors=i,n}var s=ne.util.createBuffer(r.salt),f=ne.util.createBuffer(r.iterations);f=f.getInt(f.length()<<3);var u,o,c;switch(e){case ye.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:u=24,o=8,c=ne.des.startDecrypting;break;case ye.oids["pbewithSHAAnd40BitRC2-CBC"]:u=5,o=8,c=function(y,b){var I=ne.rc2.createDecryptionCipher(y,40);return I.start(b,null),I};break;default:var n=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw n.oid=e,n}var l=Rc(r.prfOid),h=ye.pbe.generatePkcs12Key(a,s,1,f,u,l);l.start();var g=ye.pbe.generatePkcs12Key(a,s,2,f,o,l);return c(h,g)};ye.pbe.opensslDeriveBytes=function(e,t,a,r){if(typeof r>"u"||r===null){if(!("md5"in ne.md))throw new Error('"md5" hash algorithm unavailable.');r=ne.md.md5.create()}t===null&&(t="");for(var i=[Qf(r,e+t)],n=16,s=1;n<a;++s,n+=16)i.push(Qf(r,i[s-1]+e+t));return i.join("").substr(0,a)};function Qf(e,t){return e.start().update(t).digest().getBytes()}function Rc(e){var t;if(!e)t="hmacWithSHA1";else if(t=ye.oids[Q.derToOid(e)],!t){var a=new Error("Unsupported PRF OID.");throw a.oid=e,a.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],a}return Fc(t)}function Fc(e){var t=ne.md;switch(e){case"hmacWithSHA224":t=ne.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var a=new Error("Unsupported PRF algorithm.");throw a.algorithm=e,a.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],a}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function Xv(e,t,a,r){var i=Q.create(Q.Class.UNIVERSAL,Q.Type.SEQUENCE,!0,[Q.create(Q.Class.UNIVERSAL,Q.Type.OCTETSTRING,!1,e),Q.create(Q.Class.UNIVERSAL,Q.Type.INTEGER,!1,t.getBytes())]);return r!=="hmacWithSHA1"&&i.value.push(Q.create(Q.Class.UNIVERSAL,Q.Type.INTEGER,!1,ne.util.hexToBytes(a.toString(16))),Q.create(Q.Class.UNIVERSAL,Q.Type.SEQUENCE,!0,[Q.create(Q.Class.UNIVERSAL,Q.Type.OID,!1,Q.oidToDer(ye.oids[r]).getBytes()),Q.create(Q.Class.UNIVERSAL,Q.Type.NULL,!1,"")])),i}var D0=me,ie=D0.asn1,z0=D0.pkcs7asn1=D0.pkcs7asn1||{};D0.pkcs7=D0.pkcs7||{};D0.pkcs7.asn1=z0;var kc={name:"ContentInfo",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:ie.Class.UNIVERSAL,type:ie.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:ie.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};z0.contentInfoValidator=kc;var Mc={name:"EncryptedContentInfo",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:ie.Class.UNIVERSAL,type:ie.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:ie.Class.UNIVERSAL,type:ie.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:ie.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:ie.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};z0.envelopedDataValidator={name:"EnvelopedData",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(Mc)};z0.encryptedDataValidator={name:"EncryptedData",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"version"}].concat(Mc)};var Yv={name:"SignerInfo",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:ie.Class.UNIVERSAL,type:ie.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:ie.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:ie.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:ie.Class.UNIVERSAL,type:ie.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:ie.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};z0.signedDataValidator={name:"SignedData",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},kc,{name:"SignedData.Certificates",tagClass:ie.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:ie.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SET,capture:"signerInfos",optional:!0,value:[Yv]}]};z0.recipientInfoValidator={name:"RecipientInfo",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:ie.Class.UNIVERSAL,type:ie.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:ie.Class.UNIVERSAL,type:ie.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:ie.Class.UNIVERSAL,type:ie.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:ie.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:ie.Class.UNIVERSAL,type:ie.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]};var c0=me;c0.mgf=c0.mgf||{};var Zv=c0.mgf.mgf1=c0.mgf1=c0.mgf1||{};Zv.create=function(e){var t={generate:function(a,r){for(var i=new c0.util.ByteBuffer,n=Math.ceil(r/e.digestLength),s=0;s<n;s++){var f=new c0.util.ByteBuffer;f.putInt32(s),e.start(),e.update(a+f.getBytes()),i.putBuffer(e.digest())}return i.truncate(i.length()-r),i.getBytes()}};return t};var Ma=me;Ma.mgf=Ma.mgf||{};Ma.mgf.mgf1=Ma.mgf1;var r0=me,Jv=r0.pss=r0.pss||{};Jv.create=function(e){arguments.length===3&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t=e.md,a=e.mgf,r=t.digestLength,i=e.salt||null;typeof i=="string"&&(i=r0.util.createBuffer(i));var n;if("saltLength"in e)n=e.saltLength;else if(i!==null)n=i.length();else throw new Error("Salt length not specified or specific salt not given.");if(i!==null&&i.length()!==n)throw new Error("Given salt length does not match length of given salt.");var s=e.prng||r0.random,f={};return f.encode=function(u,o){var c,l=o-1,h=Math.ceil(l/8),g=u.digest().getBytes();if(h<r+n+2)throw new Error("Message is too long to encrypt.");var v;i===null?v=s.getBytesSync(n):v=i.bytes();var y=new r0.util.ByteBuffer;y.fillWithByte(0,8),y.putBytes(g),y.putBytes(v),t.start(),t.update(y.getBytes());var b=t.digest().getBytes(),I=new r0.util.ByteBuffer;I.fillWithByte(0,h-n-r-2),I.putByte(1),I.putBytes(v);var A=I.getBytes(),w=h-r-1,N=a.generate(b,w),k="";for(c=0;c<w;c++)k+=String.fromCharCode(A.charCodeAt(c)^N.charCodeAt(c));var M=65280>>8*h-l&255;return k=String.fromCharCode(k.charCodeAt(0)&~M)+k.substr(1),k+b+"¼"},f.verify=function(u,o,c){var l,h=c-1,g=Math.ceil(h/8);if(o=o.substr(-g),g<r+n+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(o.charCodeAt(g-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var v=g-r-1,y=o.substr(0,v),b=o.substr(v,r),I=65280>>8*g-h&255;if(y.charCodeAt(0)&I)throw new Error("Bits beyond keysize not zero as expected.");var A=a.generate(b,v),w="";for(l=0;l<v;l++)w+=String.fromCharCode(y.charCodeAt(l)^A.charCodeAt(l));w=String.fromCharCode(w.charCodeAt(0)&~I)+w.substr(1);var N=g-r-n-2;for(l=0;l<N;l++)if(w.charCodeAt(l)!==0)throw new Error("Leftmost octets not zero as expected");if(w.charCodeAt(N)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var k=w.substr(-n),M=new r0.util.ByteBuffer;M.fillWithByte(0,8),M.putBytes(u),M.putBytes(k),t.start(),t.update(M.getBytes());var V=t.digest().getBytes();return b===V},f};var ce=me,B=ce.asn1,J=ce.pki=ce.pki||{},Te=J.oids,vt={};vt.CN=Te.commonName;vt.commonName="CN";vt.C=Te.countryName;vt.countryName="C";vt.L=Te.localityName;vt.localityName="L";vt.ST=Te.stateOrProvinceName;vt.stateOrProvinceName="ST";vt.O=Te.organizationName;vt.organizationName="O";vt.OU=Te.organizationalUnitName;vt.organizationalUnitName="OU";vt.E=Te.emailAddress;vt.emailAddress="E";var Lc=ce.pki.rsa.publicKeyValidator,ep={name:"Certificate",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:B.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:B.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:B.Class.UNIVERSAL,type:B.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:B.Class.UNIVERSAL,type:B.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:B.Class.UNIVERSAL,type:B.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:B.Class.UNIVERSAL,type:B.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},Lc,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:B.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:B.Class.UNIVERSAL,type:B.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:B.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:B.Class.UNIVERSAL,type:B.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:B.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:B.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:B.Class.UNIVERSAL,type:B.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},tp={name:"rsapss",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:B.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:B.Class.UNIVERSAL,type:B.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:B.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:B.Class.UNIVERSAL,type:B.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:B.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:B.Class.UNIVERSAL,type:B.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:B.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:B.Class.UNIVERSAL,type:B.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},rp={name:"CertificationRequestInfo",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},Lc,{name:"CertificationRequestInfo.attributes",tagClass:B.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:B.Class.UNIVERSAL,type:B.Type.SET,constructed:!0}]}]}]},ap={name:"CertificationRequest",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[rp,{name:"CertificationRequest.signatureAlgorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:B.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:B.Class.UNIVERSAL,type:B.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};J.RDNAttributesAsArray=function(e,t){for(var a=[],r,i,n,s=0;s<e.value.length;++s){r=e.value[s];for(var f=0;f<r.value.length;++f)n={},i=r.value[f],n.type=B.derToOid(i.value[0].value),n.value=i.value[1].value,n.valueTagClass=i.value[1].type,n.type in Te&&(n.name=Te[n.type],n.name in vt&&(n.shortName=vt[n.name])),t&&(t.update(n.type),t.update(n.value)),a.push(n)}return a};J.CRIAttributesAsArray=function(e){for(var t=[],a=0;a<e.length;++a)for(var r=e[a],i=B.derToOid(r.value[0].value),n=r.value[1].value,s=0;s<n.length;++s){var f={};if(f.type=i,f.value=n[s].value,f.valueTagClass=n[s].type,f.type in Te&&(f.name=Te[f.type],f.name in vt&&(f.shortName=vt[f.name])),f.type===Te.extensionRequest){f.extensions=[];for(var u=0;u<f.value.length;++u)f.extensions.push(J.certificateExtensionFromAsn1(f.value[u]))}t.push(f)}return t};function $r(e,t){typeof t=="string"&&(t={shortName:t});for(var a=null,r,i=0;a===null&&i<e.attributes.length;++i)r=e.attributes[i],(t.type&&t.type===r.type||t.name&&t.name===r.name||t.shortName&&t.shortName===r.shortName)&&(a=r);return a}var La=function(e,t,a){var r={};if(e!==Te["RSASSA-PSS"])return r;a&&(r={hash:{algorithmOid:Te.sha1},mgf:{algorithmOid:Te.mgf1,hash:{algorithmOid:Te.sha1}},saltLength:20});var i={},n=[];if(!B.validate(t,tp,i,n)){var s=new Error("Cannot read RSASSA-PSS parameter block.");throw s.errors=n,s}return i.hashOid!==void 0&&(r.hash=r.hash||{},r.hash.algorithmOid=B.derToOid(i.hashOid)),i.maskGenOid!==void 0&&(r.mgf=r.mgf||{},r.mgf.algorithmOid=B.derToOid(i.maskGenOid),r.mgf.hash=r.mgf.hash||{},r.mgf.hash.algorithmOid=B.derToOid(i.maskGenHashOid)),i.saltLength!==void 0&&(r.saltLength=i.saltLength.charCodeAt(0)),r},oi=function(e){switch(Te[e.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return ce.md.sha1.create();case"md5WithRSAEncryption":return ce.md.md5.create();case"sha256WithRSAEncryption":return ce.md.sha256.create();case"sha384WithRSAEncryption":return ce.md.sha384.create();case"sha512WithRSAEncryption":return ce.md.sha512.create();case"RSASSA-PSS":return ce.md.sha256.create();default:var t=new Error("Could not compute "+e.type+" digest. Unknown signature OID.");throw t.signatureOid=e.signatureOid,t}},Pc=function(e){var t=e.certificate,a;switch(t.signatureOid){case Te.sha1WithRSAEncryption:case Te.sha1WithRSASignature:break;case Te["RSASSA-PSS"]:var r,i;if(r=Te[t.signatureParameters.mgf.hash.algorithmOid],r===void 0||ce.md[r]===void 0){var n=new Error("Unsupported MGF hash function.");throw n.oid=t.signatureParameters.mgf.hash.algorithmOid,n.name=r,n}if(i=Te[t.signatureParameters.mgf.algorithmOid],i===void 0||ce.mgf[i]===void 0){var n=new Error("Unsupported MGF function.");throw n.oid=t.signatureParameters.mgf.algorithmOid,n.name=i,n}if(i=ce.mgf[i].create(ce.md[r].create()),r=Te[t.signatureParameters.hash.algorithmOid],r===void 0||ce.md[r]===void 0){var n=new Error("Unsupported RSASSA-PSS hash function.");throw n.oid=t.signatureParameters.hash.algorithmOid,n.name=r,n}a=ce.pss.create(ce.md[r].create(),i,t.signatureParameters.saltLength);break}return t.publicKey.verify(e.md.digest().getBytes(),e.signature,a)};J.certificateFromPem=function(e,t,a){var r=ce.pem.decode(e)[0];if(r.type!=="CERTIFICATE"&&r.type!=="X509 CERTIFICATE"&&r.type!=="TRUSTED CERTIFICATE"){var i=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw i.headerType=r.type,i}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var n=B.fromDer(r.body,a);return J.certificateFromAsn1(n,t)};J.certificateToPem=function(e,t){var a={type:"CERTIFICATE",body:B.toDer(J.certificateToAsn1(e)).getBytes()};return ce.pem.encode(a,{maxline:t})};J.publicKeyFromPem=function(e){var t=ce.pem.decode(e)[0];if(t.type!=="PUBLIC KEY"&&t.type!=="RSA PUBLIC KEY"){var a=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var r=B.fromDer(t.body);return J.publicKeyFromAsn1(r)};J.publicKeyToPem=function(e,t){var a={type:"PUBLIC KEY",body:B.toDer(J.publicKeyToAsn1(e)).getBytes()};return ce.pem.encode(a,{maxline:t})};J.publicKeyToRSAPublicKeyPem=function(e,t){var a={type:"RSA PUBLIC KEY",body:B.toDer(J.publicKeyToRSAPublicKey(e)).getBytes()};return ce.pem.encode(a,{maxline:t})};J.getPublicKeyFingerprint=function(e,t){t=t||{};var a=t.md||ce.md.sha1.create(),r=t.type||"RSAPublicKey",i;switch(r){case"RSAPublicKey":i=B.toDer(J.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":i=B.toDer(J.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}a.start(),a.update(i);var n=a.digest();if(t.encoding==="hex"){var s=n.toHex();return t.delimiter?s.match(/.{2}/g).join(t.delimiter):s}else{if(t.encoding==="binary")return n.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".')}return n};J.certificationRequestFromPem=function(e,t,a){var r=ce.pem.decode(e)[0];if(r.type!=="CERTIFICATE REQUEST"){var i=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw i.headerType=r.type,i}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var n=B.fromDer(r.body,a);return J.certificationRequestFromAsn1(n,t)};J.certificationRequestToPem=function(e,t){var a={type:"CERTIFICATE REQUEST",body:B.toDer(J.certificationRequestToAsn1(e)).getBytes()};return ce.pem.encode(a,{maxline:t})};J.createCertificate=function(){var e={};return e.version=2,e.serialNumber="00",e.signatureOid=null,e.signature=null,e.siginfo={},e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return $r(e.issuer,t)},e.issuer.addField=function(t){Wt([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return $r(e.subject,t)},e.subject.addField=function(t){Wt([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,a){Wt(t),e.subject.attributes=t,delete e.subject.uniqueId,a&&(e.subject.uniqueId=a),e.subject.hash=null},e.setIssuer=function(t,a){Wt(t),e.issuer.attributes=t,delete e.issuer.uniqueId,a&&(e.issuer.uniqueId=a),e.issuer.hash=null},e.setExtensions=function(t){for(var a=0;a<t.length;++a)Uc(t[a],{cert:e});e.extensions=t},e.getExtension=function(t){typeof t=="string"&&(t={name:t});for(var a=null,r,i=0;a===null&&i<e.extensions.length;++i)r=e.extensions[i],(t.id&&r.id===t.id||t.name&&r.name===t.name)&&(a=r);return a},e.sign=function(t,a){e.md=a||ce.md.sha1.create();var r=Te[e.md.algorithm+"WithRSAEncryption"];if(!r){var i=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw i.algorithm=e.md.algorithm,i}e.signatureOid=e.siginfo.algorithmOid=r,e.tbsCertificate=J.getTBSCertificate(e);var n=B.toDer(e.tbsCertificate);e.md.update(n.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var a=!1;if(!e.issued(t)){var r=t.issuer,i=e.subject,n=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw n.expectedIssuer=i.attributes,n.actualIssuer=r.attributes,n}var s=t.md;if(s===null){s=oi({signatureOid:t.signatureOid,type:"certificate"});var f=t.tbsCertificate||J.getTBSCertificate(t),u=B.toDer(f);s.update(u.getBytes())}return s!==null&&(a=Pc({certificate:e,md:s,signature:t.signature})),a},e.isIssuer=function(t){var a=!1,r=e.issuer,i=t.subject;if(r.hash&&i.hash)a=r.hash===i.hash;else if(r.attributes.length===i.attributes.length){a=!0;for(var n,s,f=0;a&&f<r.attributes.length;++f)n=r.attributes[f],s=i.attributes[f],(n.type!==s.type||n.value!==s.value)&&(a=!1)}return a},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return J.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=Te.subjectKeyIdentifier,a=0;a<e.extensions.length;++a){var r=e.extensions[a];if(r.id===t){var i=e.generateSubjectKeyIdentifier().getBytes();return ce.util.hexToBytes(r.subjectKeyIdentifier)===i}}return!1},e};J.certificateFromAsn1=function(e,t){var a={},r=[];if(!B.validate(e,ep,a,r)){var i=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw i.errors=r,i}var n=B.derToOid(a.publicKeyOid);if(n!==J.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var s=J.createCertificate();s.version=a.certVersion?a.certVersion.charCodeAt(0):0;var f=ce.util.createBuffer(a.certSerialNumber);s.serialNumber=f.toHex(),s.signatureOid=ce.asn1.derToOid(a.certSignatureOid),s.signatureParameters=La(s.signatureOid,a.certSignatureParams,!0),s.siginfo.algorithmOid=ce.asn1.derToOid(a.certinfoSignatureOid),s.siginfo.parameters=La(s.siginfo.algorithmOid,a.certinfoSignatureParams,!1),s.signature=a.certSignature;var u=[];if(a.certValidity1UTCTime!==void 0&&u.push(B.utcTimeToDate(a.certValidity1UTCTime)),a.certValidity2GeneralizedTime!==void 0&&u.push(B.generalizedTimeToDate(a.certValidity2GeneralizedTime)),a.certValidity3UTCTime!==void 0&&u.push(B.utcTimeToDate(a.certValidity3UTCTime)),a.certValidity4GeneralizedTime!==void 0&&u.push(B.generalizedTimeToDate(a.certValidity4GeneralizedTime)),u.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(u.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(s.validity.notBefore=u[0],s.validity.notAfter=u[1],s.tbsCertificate=a.tbsCertificate,t){s.md=oi({signatureOid:s.signatureOid,type:"certificate"});var o=B.toDer(s.tbsCertificate);s.md.update(o.getBytes())}var c=ce.md.sha1.create(),l=B.toDer(a.certIssuer);c.update(l.getBytes()),s.issuer.getField=function(v){return $r(s.issuer,v)},s.issuer.addField=function(v){Wt([v]),s.issuer.attributes.push(v)},s.issuer.attributes=J.RDNAttributesAsArray(a.certIssuer),a.certIssuerUniqueId&&(s.issuer.uniqueId=a.certIssuerUniqueId),s.issuer.hash=c.digest().toHex();var h=ce.md.sha1.create(),g=B.toDer(a.certSubject);return h.update(g.getBytes()),s.subject.getField=function(v){return $r(s.subject,v)},s.subject.addField=function(v){Wt([v]),s.subject.attributes.push(v)},s.subject.attributes=J.RDNAttributesAsArray(a.certSubject),a.certSubjectUniqueId&&(s.subject.uniqueId=a.certSubjectUniqueId),s.subject.hash=h.digest().toHex(),a.certExtensions?s.extensions=J.certificateExtensionsFromAsn1(a.certExtensions):s.extensions=[],s.publicKey=J.publicKeyFromAsn1(a.subjectPublicKeyInfo),s};J.certificateExtensionsFromAsn1=function(e){for(var t=[],a=0;a<e.value.length;++a)for(var r=e.value[a],i=0;i<r.value.length;++i)t.push(J.certificateExtensionFromAsn1(r.value[i]));return t};J.certificateExtensionFromAsn1=function(e){var t={};if(t.id=B.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===B.Type.BOOLEAN?(t.critical=e.value[1].value.charCodeAt(0)!==0,t.value=e.value[2].value):t.value=e.value[1].value,t.id in Te){if(t.name=Te[t.id],t.name==="keyUsage"){var a=B.fromDer(t.value),r=0,i=0;a.value.length>1&&(r=a.value.charCodeAt(1),i=a.value.length>2?a.value.charCodeAt(2):0),t.digitalSignature=(r&128)===128,t.nonRepudiation=(r&64)===64,t.keyEncipherment=(r&32)===32,t.dataEncipherment=(r&16)===16,t.keyAgreement=(r&8)===8,t.keyCertSign=(r&4)===4,t.cRLSign=(r&2)===2,t.encipherOnly=(r&1)===1,t.decipherOnly=(i&128)===128}else if(t.name==="basicConstraints"){var a=B.fromDer(t.value);a.value.length>0&&a.value[0].type===B.Type.BOOLEAN?t.cA=a.value[0].value.charCodeAt(0)!==0:t.cA=!1;var n=null;a.value.length>0&&a.value[0].type===B.Type.INTEGER?n=a.value[0].value:a.value.length>1&&(n=a.value[1].value),n!==null&&(t.pathLenConstraint=B.derToInteger(n))}else if(t.name==="extKeyUsage")for(var a=B.fromDer(t.value),s=0;s<a.value.length;++s){var f=B.derToOid(a.value[s].value);f in Te?t[Te[f]]=!0:t[f]=!0}else if(t.name==="nsCertType"){var a=B.fromDer(t.value),r=0;a.value.length>1&&(r=a.value.charCodeAt(1)),t.client=(r&128)===128,t.server=(r&64)===64,t.email=(r&32)===32,t.objsign=(r&16)===16,t.reserved=(r&8)===8,t.sslCA=(r&4)===4,t.emailCA=(r&2)===2,t.objCA=(r&1)===1}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.altNames=[];for(var u,a=B.fromDer(t.value),o=0;o<a.value.length;++o){u=a.value[o];var c={type:u.type,value:u.value};switch(t.altNames.push(c),u.type){case 1:case 2:case 6:break;case 7:c.ip=ce.util.bytesToIP(u.value);break;case 8:c.oid=B.derToOid(u.value);break}}}else if(t.name==="subjectKeyIdentifier"){var a=B.fromDer(t.value);t.subjectKeyIdentifier=ce.util.bytesToHex(a.value)}}return t};J.certificationRequestFromAsn1=function(e,t){var a={},r=[];if(!B.validate(e,ap,a,r)){var i=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw i.errors=r,i}var n=B.derToOid(a.publicKeyOid);if(n!==J.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var s=J.createCertificationRequest();if(s.version=a.csrVersion?a.csrVersion.charCodeAt(0):0,s.signatureOid=ce.asn1.derToOid(a.csrSignatureOid),s.signatureParameters=La(s.signatureOid,a.csrSignatureParams,!0),s.siginfo.algorithmOid=ce.asn1.derToOid(a.csrSignatureOid),s.siginfo.parameters=La(s.siginfo.algorithmOid,a.csrSignatureParams,!1),s.signature=a.csrSignature,s.certificationRequestInfo=a.certificationRequestInfo,t){s.md=oi({signatureOid:s.signatureOid,type:"certification request"});var f=B.toDer(s.certificationRequestInfo);s.md.update(f.getBytes())}var u=ce.md.sha1.create();return s.subject.getField=function(o){return $r(s.subject,o)},s.subject.addField=function(o){Wt([o]),s.subject.attributes.push(o)},s.subject.attributes=J.RDNAttributesAsArray(a.certificationRequestInfoSubject,u),s.subject.hash=u.digest().toHex(),s.publicKey=J.publicKeyFromAsn1(a.subjectPublicKeyInfo),s.getAttribute=function(o){return $r(s,o)},s.addAttribute=function(o){Wt([o]),s.attributes.push(o)},s.attributes=J.CRIAttributesAsArray(a.certificationRequestInfoAttributes||[]),s};J.createCertificationRequest=function(){var e={};return e.version=0,e.signatureOid=null,e.signature=null,e.siginfo={},e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return $r(e.subject,t)},e.subject.addField=function(t){Wt([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return $r(e,t)},e.addAttribute=function(t){Wt([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){Wt(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){Wt(t),e.attributes=t},e.sign=function(t,a){e.md=a||ce.md.sha1.create();var r=Te[e.md.algorithm+"WithRSAEncryption"];if(!r){var i=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw i.algorithm=e.md.algorithm,i}e.signatureOid=e.siginfo.algorithmOid=r,e.certificationRequestInfo=J.getCertificationRequestInfo(e);var n=B.toDer(e.certificationRequestInfo);e.md.update(n.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,a=e.md;if(a===null){a=oi({signatureOid:e.signatureOid,type:"certification request"});var r=e.certificationRequestInfo||J.getCertificationRequestInfo(e),i=B.toDer(r);a.update(i.getBytes())}return a!==null&&(t=Pc({certificate:e,md:a,signature:e.signature})),t},e};function N0(e){for(var t=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[]),a,r,i=e.attributes,n=0;n<i.length;++n){a=i[n];var s=a.value,f=B.Type.PRINTABLESTRING;"valueTagClass"in a&&(f=a.valueTagClass,f===B.Type.UTF8&&(s=ce.util.encodeUtf8(s))),r=B.create(B.Class.UNIVERSAL,B.Type.SET,!0,[B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(a.type).getBytes()),B.create(B.Class.UNIVERSAL,f,!1,s)])]),t.value.push(r)}return t}function Wt(e){for(var t,a=0;a<e.length;++a){if(t=e[a],typeof t.name>"u"&&(t.type&&t.type in J.oids?t.name=J.oids[t.type]:t.shortName&&t.shortName in vt&&(t.name=J.oids[vt[t.shortName]])),typeof t.type>"u")if(t.name&&t.name in J.oids)t.type=J.oids[t.name];else{var r=new Error("Attribute type not specified.");throw r.attribute=t,r}if(typeof t.shortName>"u"&&t.name&&t.name in vt&&(t.shortName=vt[t.name]),t.type===Te.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=B.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var i=0;i<t.extensions.length;++i)t.value.push(J.certificateExtensionToAsn1(Uc(t.extensions[i])))}if(typeof t.value>"u"){var r=new Error("Attribute value not specified.");throw r.attribute=t,r}}}function Uc(e,t){if(t=t||{},typeof e.name>"u"&&e.id&&e.id in J.oids&&(e.name=J.oids[e.id]),typeof e.id>"u")if(e.name&&e.name in J.oids)e.id=J.oids[e.name];else{var a=new Error("Extension ID not specified.");throw a.extension=e,a}if(typeof e.value<"u")return e;if(e.name==="keyUsage"){var r=0,i=0,n=0;e.digitalSignature&&(i|=128,r=7),e.nonRepudiation&&(i|=64,r=6),e.keyEncipherment&&(i|=32,r=5),e.dataEncipherment&&(i|=16,r=4),e.keyAgreement&&(i|=8,r=3),e.keyCertSign&&(i|=4,r=2),e.cRLSign&&(i|=2,r=1),e.encipherOnly&&(i|=1,r=0),e.decipherOnly&&(n|=128,r=7);var s=String.fromCharCode(r);n!==0?s+=String.fromCharCode(i)+String.fromCharCode(n):i!==0&&(s+=String.fromCharCode(i)),e.value=B.create(B.Class.UNIVERSAL,B.Type.BITSTRING,!1,s)}else if(e.name==="basicConstraints")e.value=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(B.create(B.Class.UNIVERSAL,B.Type.BOOLEAN,!1,"ÿ")),"pathLenConstraint"in e&&e.value.value.push(B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,B.integerToDer(e.pathLenConstraint).getBytes()));else if(e.name==="extKeyUsage"){e.value=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[]);var f=e.value.value;for(var u in e)e[u]===!0&&(u in Te?f.push(B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(Te[u]).getBytes())):u.indexOf(".")!==-1&&f.push(B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(u).getBytes())))}else if(e.name==="nsCertType"){var r=0,i=0;e.client&&(i|=128,r=7),e.server&&(i|=64,r=6),e.email&&(i|=32,r=5),e.objsign&&(i|=16,r=4),e.reserved&&(i|=8,r=3),e.sslCA&&(i|=4,r=2),e.emailCA&&(i|=2,r=1),e.objCA&&(i|=1,r=0);var s=String.fromCharCode(r);i!==0&&(s+=String.fromCharCode(i)),e.value=B.create(B.Class.UNIVERSAL,B.Type.BITSTRING,!1,s)}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.value=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[]);for(var o,c=0;c<e.altNames.length;++c){o=e.altNames[c];var s=o.value;if(o.type===7&&o.ip){if(s=ce.util.bytesFromIP(o.ip),s===null){var a=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw a.extension=e,a}}else o.type===8&&(o.oid?s=B.oidToDer(B.oidToDer(o.oid)):s=B.oidToDer(s));e.value.value.push(B.create(B.Class.CONTEXT_SPECIFIC,o.type,!1,s))}}else if(e.name==="nsComment"&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=B.create(B.Class.UNIVERSAL,B.Type.IA5STRING,!1,e.comment)}else if(e.name==="subjectKeyIdentifier"&&t.cert){var l=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=l.toHex(),e.value=B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,l.getBytes())}else if(e.name==="authorityKeyIdentifier"&&t.cert){e.value=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[]);var f=e.value.value;if(e.keyIdentifier){var h=e.keyIdentifier===!0?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;f.push(B.create(B.Class.CONTEXT_SPECIFIC,0,!1,h))}if(e.authorityCertIssuer){var g=[B.create(B.Class.CONTEXT_SPECIFIC,4,!0,[N0(e.authorityCertIssuer===!0?t.cert.issuer:e.authorityCertIssuer)])];f.push(B.create(B.Class.CONTEXT_SPECIFIC,1,!0,g))}if(e.serialNumber){var v=ce.util.hexToBytes(e.serialNumber===!0?t.cert.serialNumber:e.serialNumber);f.push(B.create(B.Class.CONTEXT_SPECIFIC,2,!1,v))}}else if(e.name==="cRLDistributionPoints"){e.value=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[]);for(var f=e.value.value,y=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[]),b=B.create(B.Class.CONTEXT_SPECIFIC,0,!0,[]),o,c=0;c<e.altNames.length;++c){o=e.altNames[c];var s=o.value;if(o.type===7&&o.ip){if(s=ce.util.bytesFromIP(o.ip),s===null){var a=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw a.extension=e,a}}else o.type===8&&(o.oid?s=B.oidToDer(B.oidToDer(o.oid)):s=B.oidToDer(s));b.value.push(B.create(B.Class.CONTEXT_SPECIFIC,o.type,!1,s))}y.value.push(B.create(B.Class.CONTEXT_SPECIFIC,0,!0,[b])),f.push(y)}if(typeof e.value>"u"){var a=new Error("Extension value not specified.");throw a.extension=e,a}return e}function Bs(e,t){switch(e){case Te["RSASSA-PSS"]:var a=[];return t.hash.algorithmOid!==void 0&&a.push(B.create(B.Class.CONTEXT_SPECIFIC,0,!0,[B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(t.hash.algorithmOid).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.NULL,!1,"")])])),t.mgf.algorithmOid!==void 0&&a.push(B.create(B.Class.CONTEXT_SPECIFIC,1,!0,[B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(t.mgf.algorithmOid).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(t.mgf.hash.algorithmOid).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.NULL,!1,"")])])])),t.saltLength!==void 0&&a.push(B.create(B.Class.CONTEXT_SPECIFIC,2,!0,[B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,B.integerToDer(t.saltLength).getBytes())])),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,a);default:return B.create(B.Class.UNIVERSAL,B.Type.NULL,!1,"")}}function ip(e){var t=B.create(B.Class.CONTEXT_SPECIFIC,0,!0,[]);if(e.attributes.length===0)return t;for(var a=e.attributes,r=0;r<a.length;++r){var i=a[r],n=i.value,s=B.Type.UTF8;"valueTagClass"in i&&(s=i.valueTagClass),s===B.Type.UTF8&&(n=ce.util.encodeUtf8(n));var f=!1;"valueConstructed"in i&&(f=i.valueConstructed);var u=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(i.type).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SET,!0,[B.create(B.Class.UNIVERSAL,s,f,n)])]);t.value.push(u)}return t}var np=new Date("1950-01-01T00:00:00Z"),sp=new Date("2050-01-01T00:00:00Z");function Xf(e){return e>=np&&e<sp?B.create(B.Class.UNIVERSAL,B.Type.UTCTIME,!1,B.dateToUtcTime(e)):B.create(B.Class.UNIVERSAL,B.Type.GENERALIZEDTIME,!1,B.dateToGeneralizedTime(e))}J.getTBSCertificate=function(e){var t=Xf(e.validity.notBefore),a=Xf(e.validity.notAfter),r=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.CONTEXT_SPECIFIC,0,!0,[B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,B.integerToDer(e.version).getBytes())]),B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,ce.util.hexToBytes(e.serialNumber)),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(e.siginfo.algorithmOid).getBytes()),Bs(e.siginfo.algorithmOid,e.siginfo.parameters)]),N0(e.issuer),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[t,a]),N0(e.subject),J.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&r.value.push(B.create(B.Class.CONTEXT_SPECIFIC,1,!0,[B.create(B.Class.UNIVERSAL,B.Type.BITSTRING,!1,"\0"+e.issuer.uniqueId)])),e.subject.uniqueId&&r.value.push(B.create(B.Class.CONTEXT_SPECIFIC,2,!0,[B.create(B.Class.UNIVERSAL,B.Type.BITSTRING,!1,"\0"+e.subject.uniqueId)])),e.extensions.length>0&&r.value.push(J.certificateExtensionsToAsn1(e.extensions)),r};J.getCertificationRequestInfo=function(e){var t=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,B.integerToDer(e.version).getBytes()),N0(e.subject),J.publicKeyToAsn1(e.publicKey),ip(e)]);return t};J.distinguishedNameToAsn1=function(e){return N0(e)};J.certificateToAsn1=function(e){var t=e.tbsCertificate||J.getTBSCertificate(e);return B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[t,B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(e.signatureOid).getBytes()),Bs(e.signatureOid,e.signatureParameters)]),B.create(B.Class.UNIVERSAL,B.Type.BITSTRING,!1,"\0"+e.signature)])};J.certificateExtensionsToAsn1=function(e){var t=B.create(B.Class.CONTEXT_SPECIFIC,3,!0,[]),a=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[]);t.value.push(a);for(var r=0;r<e.length;++r)a.value.push(J.certificateExtensionToAsn1(e[r]));return t};J.certificateExtensionToAsn1=function(e){var t=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[]);t.value.push(B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(e.id).getBytes())),e.critical&&t.value.push(B.create(B.Class.UNIVERSAL,B.Type.BOOLEAN,!1,"ÿ"));var a=e.value;return typeof e.value!="string"&&(a=B.toDer(a).getBytes()),t.value.push(B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,a)),t};J.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||J.getCertificationRequestInfo(e);return B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[t,B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(e.signatureOid).getBytes()),Bs(e.signatureOid,e.signatureParameters)]),B.create(B.Class.UNIVERSAL,B.Type.BITSTRING,!1,"\0"+e.signature)])};J.createCaStore=function(e){var t={certs:{}};t.getIssuer=function(s){var f=a(s.issuer);return f},t.addCertificate=function(s){if(typeof s=="string"&&(s=ce.pki.certificateFromPem(s)),r(s.subject),!t.hasCertificate(s))if(s.subject.hash in t.certs){var f=t.certs[s.subject.hash];ce.util.isArray(f)||(f=[f]),f.push(s),t.certs[s.subject.hash]=f}else t.certs[s.subject.hash]=s},t.hasCertificate=function(s){typeof s=="string"&&(s=ce.pki.certificateFromPem(s));var f=a(s.subject);if(!f)return!1;ce.util.isArray(f)||(f=[f]);for(var u=B.toDer(J.certificateToAsn1(s)).getBytes(),o=0;o<f.length;++o){var c=B.toDer(J.certificateToAsn1(f[o])).getBytes();if(u===c)return!0}return!1},t.listAllCertificates=function(){var s=[];for(var f in t.certs)if(t.certs.hasOwnProperty(f)){var u=t.certs[f];if(!ce.util.isArray(u))s.push(u);else for(var o=0;o<u.length;++o)s.push(u[o])}return s},t.removeCertificate=function(s){var f;if(typeof s=="string"&&(s=ce.pki.certificateFromPem(s)),r(s.subject),!t.hasCertificate(s))return null;var u=a(s.subject);if(!ce.util.isArray(u))return f=t.certs[s.subject.hash],delete t.certs[s.subject.hash],f;for(var o=B.toDer(J.certificateToAsn1(s)).getBytes(),c=0;c<u.length;++c){var l=B.toDer(J.certificateToAsn1(u[c])).getBytes();o===l&&(f=u[c],u.splice(c,1))}return u.length===0&&delete t.certs[s.subject.hash],f};function a(s){return r(s),t.certs[s.hash]||null}function r(s){if(!s.hash){var f=ce.md.sha1.create();s.attributes=J.RDNAttributesAsArray(N0(s),f),s.hash=f.digest().toHex()}}if(e)for(var i=0;i<e.length;++i){var n=e[i];t.addCertificate(n)}return t};J.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};J.verifyCertificateChain=function(e,t,a){typeof a=="function"&&(a={verify:a}),a=a||{},t=t.slice(0);var r=t.slice(0),i=a.validityCheckDate;typeof i>"u"&&(i=new Date);var n=!0,s=null,f=0;do{var u=t.shift(),o=null,c=!1;if(i&&(i<u.validity.notBefore||i>u.validity.notAfter)&&(s={message:"Certificate is not valid yet or has expired.",error:J.certificateError.certificate_expired,notBefore:u.validity.notBefore,notAfter:u.validity.notAfter,now:i}),s===null){if(o=t[0]||e.getIssuer(u),o===null&&u.isIssuer(u)&&(c=!0,o=u),o){var l=o;ce.util.isArray(l)||(l=[l]);for(var h=!1;!h&&l.length>0;){o=l.shift();try{h=o.verify(u)}catch{}}h||(s={message:"Certificate signature is invalid.",error:J.certificateError.bad_certificate})}s===null&&(!o||c)&&!e.hasCertificate(u)&&(s={message:"Certificate is not trusted.",error:J.certificateError.unknown_ca})}if(s===null&&o&&!u.isIssuer(o)&&(s={message:"Certificate issuer is invalid.",error:J.certificateError.bad_certificate}),s===null)for(var g={keyUsage:!0,basicConstraints:!0},v=0;s===null&&v<u.extensions.length;++v){var y=u.extensions[v];y.critical&&!(y.name in g)&&(s={message:"Certificate has an unsupported critical extension.",error:J.certificateError.unsupported_certificate})}if(s===null&&(!n||t.length===0&&(!o||c))){var b=u.getExtension("basicConstraints"),I=u.getExtension("keyUsage");if(I!==null&&(!I.keyCertSign||b===null)&&(s={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:J.certificateError.bad_certificate}),s===null&&b!==null&&!b.cA&&(s={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:J.certificateError.bad_certificate}),s===null&&I!==null&&"pathLenConstraint"in b){var A=f-1;A>b.pathLenConstraint&&(s={message:"Certificate basicConstraints pathLenConstraint violated.",error:J.certificateError.bad_certificate})}}var w=s===null?!0:s.error,N=a.verify?a.verify(w,f,r):w;if(N===!0)s=null;else throw w===!0&&(s={message:"The application rejected the certificate.",error:J.certificateError.bad_certificate}),(N||N===0)&&(typeof N=="object"&&!ce.util.isArray(N)?(N.message&&(s.message=N.message),N.error&&(s.error=N.error)):typeof N=="string"&&(s.error=N)),s;n=!1,++f}while(t.length>0);return!0};var Ve=me,L=Ve.asn1,Ce=Ve.pki,ia=Ve.pkcs12=Ve.pkcs12||{},Oc={name:"ContentInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:L.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},fp={name:"PFX",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"version"},Oc,{name:"PFX.macData",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:L.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:L.Class.UNIVERSAL,type:L.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:L.Class.UNIVERSAL,type:L.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},op={name:"SafeBag",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:L.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:L.Class.UNIVERSAL,type:L.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},cp={name:"Attribute",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:L.Class.UNIVERSAL,type:L.Type.SET,constructed:!0,capture:"values"}]},up={name:"CertBag",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:L.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:L.Class.UNIVERSAL,type:L.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function X0(e,t,a,r){for(var i=[],n=0;n<e.length;n++)for(var s=0;s<e[n].safeBags.length;s++){var f=e[n].safeBags[s];if(!(r!==void 0&&f.type!==r)){if(t===null){i.push(f);continue}f.attributes[t]!==void 0&&f.attributes[t].indexOf(a)>=0&&i.push(f)}}return i}ia.pkcs12FromAsn1=function(e,t,a){typeof t=="string"?(a=t,t=!0):t===void 0&&(t=!0);var r={},i=[];if(!L.validate(e,fp,r,i)){var n=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw n.errors=n,n}var s={version:r.version.charCodeAt(0),safeContents:[],getBags:function(b){var I={},A;return"localKeyId"in b?A=b.localKeyId:"localKeyIdHex"in b&&(A=Ve.util.hexToBytes(b.localKeyIdHex)),A===void 0&&!("friendlyName"in b)&&"bagType"in b&&(I[b.bagType]=X0(s.safeContents,null,null,b.bagType)),A!==void 0&&(I.localKeyId=X0(s.safeContents,"localKeyId",A,b.bagType)),"friendlyName"in b&&(I.friendlyName=X0(s.safeContents,"friendlyName",b.friendlyName,b.bagType)),I},getBagsByFriendlyName:function(b,I){return X0(s.safeContents,"friendlyName",b,I)},getBagsByLocalKeyId:function(b,I){return X0(s.safeContents,"localKeyId",b,I)}};if(r.version.charCodeAt(0)!==3){var n=new Error("PKCS#12 PFX of version other than 3 not supported.");throw n.version=r.version.charCodeAt(0),n}if(L.derToOid(r.contentType)!==Ce.oids.data){var n=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw n.oid=L.derToOid(r.contentType),n}var f=r.content.value[0];if(f.tagClass!==L.Class.UNIVERSAL||f.type!==L.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(f=_s(f),r.mac){var u=null,o=0,c=L.derToOid(r.macAlgorithm);switch(c){case Ce.oids.sha1:u=Ve.md.sha1.create(),o=20;break;case Ce.oids.sha256:u=Ve.md.sha256.create(),o=32;break;case Ce.oids.sha384:u=Ve.md.sha384.create(),o=48;break;case Ce.oids.sha512:u=Ve.md.sha512.create(),o=64;break;case Ce.oids.md5:u=Ve.md.md5.create(),o=16;break}if(u===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+c);var l=new Ve.util.ByteBuffer(r.macSalt),h="macIterations"in r?parseInt(Ve.util.bytesToHex(r.macIterations),16):1,g=ia.generateKey(a,l,3,h,o,u),v=Ve.hmac.create();v.start(u,g),v.update(f.value);var y=v.getMac();if(y.getBytes()!==r.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return dp(s,f.value,t,a),s};function _s(e){if(e.composed||e.constructed){for(var t=Ve.util.createBuffer(),a=0;a<e.value.length;++a)t.putBytes(e.value[a].value);e.composed=e.constructed=!1,e.value=t.getBytes()}return e}function dp(e,t,a,r){if(t=L.fromDer(t,a),t.tagClass!==L.Class.UNIVERSAL||t.type!==L.Type.SEQUENCE||t.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var i=0;i<t.value.length;i++){var n=t.value[i],s={},f=[];if(!L.validate(n,Oc,s,f)){var u=new Error("Cannot read ContentInfo.");throw u.errors=f,u}var o={encrypted:!1},c=null,l=s.content.value[0];switch(L.derToOid(s.contentType)){case Ce.oids.data:if(l.tagClass!==L.Class.UNIVERSAL||l.type!==L.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");c=_s(l).value;break;case Ce.oids.encryptedData:c=lp(l,r),o.encrypted=!0;break;default:var u=new Error("Unsupported PKCS#12 contentType.");throw u.contentType=L.derToOid(s.contentType),u}o.safeBags=hp(c,a,r),e.safeContents.push(o)}}function lp(e,t){var a={},r=[];if(!L.validate(e,Ve.pkcs7.asn1.encryptedDataValidator,a,r)){var i=new Error("Cannot read EncryptedContentInfo.");throw i.errors=r,i}var n=L.derToOid(a.contentType);if(n!==Ce.oids.data){var i=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw i.oid=n,i}n=L.derToOid(a.encAlgorithm);var s=Ce.pbe.getCipher(n,a.encParameter,t),f=_s(a.encryptedContentAsn1),u=Ve.util.createBuffer(f.value);if(s.update(u),!s.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return s.output.getBytes()}function hp(e,t,a){if(!t&&e.length===0)return[];if(e=L.fromDer(e,t),e.tagClass!==L.Class.UNIVERSAL||e.type!==L.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var r=[],i=0;i<e.value.length;i++){var n=e.value[i],s={},f=[];if(!L.validate(n,op,s,f)){var u=new Error("Cannot read SafeBag.");throw u.errors=f,u}var o={type:L.derToOid(s.bagId),attributes:vp(s.bagAttributes)};r.push(o);var c,l,h=s.bagValue.value[0];switch(o.type){case Ce.oids.pkcs8ShroudedKeyBag:if(h=Ce.decryptPrivateKeyInfo(h,a),h===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case Ce.oids.keyBag:try{o.key=Ce.privateKeyFromAsn1(h)}catch{o.key=null,o.asn1=h}continue;case Ce.oids.certBag:c=up,l=function(){if(L.derToOid(s.certId)!==Ce.oids.x509Certificate){var v=new Error("Unsupported certificate type, only X.509 supported.");throw v.oid=L.derToOid(s.certId),v}var y=L.fromDer(s.cert,t);try{o.cert=Ce.certificateFromAsn1(y,!0)}catch{o.cert=null,o.asn1=y}};break;default:var u=new Error("Unsupported PKCS#12 SafeBag type.");throw u.oid=o.type,u}if(c!==void 0&&!L.validate(h,c,s,f)){var u=new Error("Cannot read PKCS#12 "+c.name);throw u.errors=f,u}l()}return r}function vp(e){var t={};if(e!==void 0)for(var a=0;a<e.length;++a){var r={},i=[];if(!L.validate(e[a],cp,r,i)){var n=new Error("Cannot read PKCS#12 BagAttribute.");throw n.errors=i,n}var s=L.derToOid(r.oid);if(Ce.oids[s]!==void 0){t[Ce.oids[s]]=[];for(var f=0;f<r.values.length;++f)t[Ce.oids[s]].push(r.values[f].value)}}return t}ia.toPkcs12Asn1=function(e,t,a,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||r.encAlgorithm||"aes128","useMac"in r||(r.useMac=!0),"localKeyId"in r||(r.localKeyId=null),"generateLocalKeyId"in r||(r.generateLocalKeyId=!0);var i=r.localKeyId,n;if(i!==null)i=Ve.util.hexToBytes(i);else if(r.generateLocalKeyId)if(t){var s=Ve.util.isArray(t)?t[0]:t;typeof s=="string"&&(s=Ce.certificateFromPem(s));var f=Ve.md.sha1.create();f.update(L.toDer(Ce.certificateToAsn1(s)).getBytes()),i=f.digest().getBytes()}else i=Ve.random.getBytes(20);var u=[];i!==null&&u.push(L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(Ce.oids.localKeyId).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SET,!0,[L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,i)])])),"friendlyName"in r&&u.push(L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(Ce.oids.friendlyName).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SET,!0,[L.create(L.Class.UNIVERSAL,L.Type.BMPSTRING,!1,r.friendlyName)])])),u.length>0&&(n=L.create(L.Class.UNIVERSAL,L.Type.SET,!0,u));var o=[],c=[];t!==null&&(Ve.util.isArray(t)?c=t:c=[t]);for(var l=[],h=0;h<c.length;++h){t=c[h],typeof t=="string"&&(t=Ce.certificateFromPem(t));var g=h===0?n:void 0,v=Ce.certificateToAsn1(t),y=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(Ce.oids.certBag).getBytes()),L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(Ce.oids.x509Certificate).getBytes()),L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,L.toDer(v).getBytes())])])]),g]);l.push(y)}if(l.length>0){var b=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,l),I=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(Ce.oids.data).getBytes()),L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,L.toDer(b).getBytes())])]);o.push(I)}var A=null;if(e!==null){var w=Ce.wrapRsaPrivateKey(Ce.privateKeyToAsn1(e));a===null?A=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(Ce.oids.keyBag).getBytes()),L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[w]),n]):A=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(Ce.oids.pkcs8ShroudedKeyBag).getBytes()),L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[Ce.encryptPrivateKeyInfo(w,a,r)]),n]);var N=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[A]),k=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(Ce.oids.data).getBytes()),L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,L.toDer(N).getBytes())])]);o.push(k)}var M=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,o),V;if(r.useMac){var f=Ve.md.sha1.create(),z=new Ve.util.ByteBuffer(Ve.random.getBytes(r.saltSize)),W=r.count,e=ia.generateKey(a,z,3,W,20),U=Ve.hmac.create();U.start(f,e),U.update(L.toDer(M).getBytes());var C=U.getMac();V=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(Ce.oids.sha1).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,"")]),L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,C.getBytes())]),L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,z.getBytes()),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(W).getBytes())])}return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(3).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(Ce.oids.data).getBytes()),L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,L.toDer(M).getBytes())])]),V])};ia.generateKey=Ve.pbe.generatePkcs12Key;var Wr=me,Is=Wr.asn1,R0=Wr.pki=Wr.pki||{};R0.pemToDer=function(e){var t=Wr.pem.decode(e)[0];if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return Wr.util.createBuffer(t.body)};R0.privateKeyFromPem=function(e){var t=Wr.pem.decode(e)[0];if(t.type!=="PRIVATE KEY"&&t.type!=="RSA PRIVATE KEY"){var a=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var r=Is.fromDer(t.body);return R0.privateKeyFromAsn1(r)};R0.privateKeyToPem=function(e,t){var a={type:"RSA PRIVATE KEY",body:Is.toDer(R0.privateKeyToAsn1(e)).getBytes()};return Wr.pem.encode(a,{maxline:t})};R0.privateKeyInfoToPem=function(e,t){var a={type:"PRIVATE KEY",body:Is.toDer(e).getBytes()};return Wr.pem.encode(a,{maxline:t})};var X=me,ci=function(e,t,a,r){var i=X.util.createBuffer(),n=e.length>>1,s=n+(e.length&1),f=e.substr(0,s),u=e.substr(n,s),o=X.util.createBuffer(),c=X.hmac.create();a=t+a;var l=Math.ceil(r/16),h=Math.ceil(r/20);c.start("MD5",f);var g=X.util.createBuffer();o.putBytes(a);for(var v=0;v<l;++v)c.start(null,null),c.update(o.getBytes()),o.putBuffer(c.digest()),c.start(null,null),c.update(o.bytes()+a),g.putBuffer(c.digest());c.start("SHA1",u);var y=X.util.createBuffer();o.clear(),o.putBytes(a);for(var v=0;v<h;++v)c.start(null,null),c.update(o.getBytes()),o.putBuffer(c.digest()),c.start(null,null),c.update(o.bytes()+a),y.putBuffer(c.digest());return i.putBytes(X.util.xorBytes(g.getBytes(),y.getBytes(),r)),i},pp=function(e,t,a){var r=X.hmac.create();r.start("SHA1",e);var i=X.util.createBuffer();return i.putInt32(t[0]),i.putInt32(t[1]),i.putByte(a.type),i.putByte(a.version.major),i.putByte(a.version.minor),i.putInt16(a.length),i.putBytes(a.fragment.bytes()),r.update(i.getBytes()),r.digest().getBytes()},xp=function(e,t,a){var r=!1;try{var i=e.deflate(t.fragment.getBytes());t.fragment=X.util.createBuffer(i),t.length=i.length,r=!0}catch{}return r},gp=function(e,t,a){var r=!1;try{var i=e.inflate(t.fragment.getBytes());t.fragment=X.util.createBuffer(i),t.length=i.length,r=!0}catch{}return r},qt=function(e,t){var a=0;switch(t){case 1:a=e.getByte();break;case 2:a=e.getInt16();break;case 3:a=e.getInt24();break;case 4:a=e.getInt32();break}return X.util.createBuffer(e.getBytes(a))},Gt=function(e,t,a){e.putInt(a.length(),t<<3),e.putBuffer(a)},T={};T.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};T.SupportedVersions=[T.Versions.TLS_1_1,T.Versions.TLS_1_0];T.Version=T.SupportedVersions[0];T.MaxFragment=15360;T.ConnectionEnd={server:0,client:1};T.PRFAlgorithm={tls_prf_sha256:0};T.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};T.CipherType={stream:0,block:1,aead:2};T.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};T.CompressionMethod={none:0,deflate:1};T.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};T.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};T.Alert={};T.Alert.Level={warning:1,fatal:2};T.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};T.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};T.CipherSuites={};T.getCipherSuite=function(e){var t=null;for(var a in T.CipherSuites){var r=T.CipherSuites[a];if(r.id[0]===e.charCodeAt(0)&&r.id[1]===e.charCodeAt(1)){t=r;break}}return t};T.handleUnexpected=function(e,t){var a=!e.open&&e.entity===T.ConnectionEnd.client;a||e.error(e,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.unexpected_message}})};T.handleHelloRequest=function(e,t,a){!e.handshaking&&e.handshakes>0&&(T.queue(e,T.createAlert(e,{level:T.Alert.Level.warning,description:T.Alert.Description.no_renegotiation})),T.flush(e)),e.process()};T.parseHelloMessage=function(e,t,a){var r=null,i=e.entity===T.ConnectionEnd.client;if(a<38)e.error(e,{message:i?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.illegal_parameter}});else{var n=t.fragment,s=n.length();if(r={version:{major:n.getByte(),minor:n.getByte()},random:X.util.createBuffer(n.getBytes(32)),session_id:qt(n,1),extensions:[]},i?(r.cipher_suite=n.getBytes(2),r.compression_method=n.getByte()):(r.cipher_suites=qt(n,2),r.compression_methods=qt(n,1)),s=a-(s-n.length()),s>0){for(var f=qt(n,2);f.length()>0;)r.extensions.push({type:[f.getByte(),f.getByte()],data:qt(f,2)});if(!i)for(var u=0;u<r.extensions.length;++u){var o=r.extensions[u];if(o.type[0]===0&&o.type[1]===0)for(var c=qt(o.data,2);c.length()>0;){var l=c.getByte();if(l!==0)break;e.session.extensions.server_name.serverNameList.push(qt(c,2).getBytes())}}}if(e.session.version&&(r.version.major!==e.session.version.major||r.version.minor!==e.session.version.minor))return e.error(e,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.protocol_version}});if(i)e.session.cipherSuite=T.getCipherSuite(r.cipher_suite);else for(var h=X.util.createBuffer(r.cipher_suites.bytes());h.length()>0&&(e.session.cipherSuite=T.getCipherSuite(h.getBytes(2)),e.session.cipherSuite===null););if(e.session.cipherSuite===null)return e.error(e,{message:"No cipher suites in common.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.handshake_failure},cipherSuite:X.util.bytesToHex(r.cipher_suite)});i?e.session.compressionMethod=r.compression_method:e.session.compressionMethod=T.CompressionMethod.none}return r};T.createSecurityParameters=function(e,t){var a=e.entity===T.ConnectionEnd.client,r=t.random.bytes(),i=a?e.session.sp.client_random:r,n=a?r:T.createRandom().getBytes();e.session.sp={entity:e.entity,prf_algorithm:T.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:e.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:i,server_random:n}};T.handleServerHello=function(e,t,a){var r=T.parseHelloMessage(e,t,a);if(!e.fail){if(r.version.minor<=e.version.minor)e.version.minor=r.version.minor;else return e.error(e,{message:"Incompatible TLS version.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.protocol_version}});e.session.version=e.version;var i=r.session_id.bytes();i.length>0&&i===e.session.id?(e.expect=Vc,e.session.resuming=!0,e.session.sp.server_random=r.random.bytes()):(e.expect=bp,e.session.resuming=!1,T.createSecurityParameters(e,r)),e.session.id=i,e.process()}};T.handleClientHello=function(e,t,a){var r=T.parseHelloMessage(e,t,a);if(!e.fail){var i=r.session_id.bytes(),n=null;if(e.sessionCache&&(n=e.sessionCache.getSession(i),n===null?i="":(n.version.major!==r.version.major||n.version.minor>r.version.minor)&&(n=null,i="")),i.length===0&&(i=X.random.getBytes(32)),e.session.id=i,e.session.clientHelloVersion=r.version,e.session.sp={},n)e.version=e.session.version=n.version,e.session.sp=n.sp;else{for(var s,f=1;f<T.SupportedVersions.length&&(s=T.SupportedVersions[f],!(s.minor<=r.version.minor));++f);e.version={major:s.major,minor:s.minor},e.session.version=e.version}n!==null?(e.expect=Ts,e.session.resuming=!0,e.session.sp.client_random=r.random.bytes()):(e.expect=e.verifyClient!==!1?_p:Kn,e.session.resuming=!1,T.createSecurityParameters(e,r)),e.open=!0,T.queue(e,T.createRecord(e,{type:T.ContentType.handshake,data:T.createServerHello(e)})),e.session.resuming?(T.queue(e,T.createRecord(e,{type:T.ContentType.change_cipher_spec,data:T.createChangeCipherSpec()})),e.state.pending=T.createConnectionState(e),e.state.current.write=e.state.pending.write,T.queue(e,T.createRecord(e,{type:T.ContentType.handshake,data:T.createFinished(e)}))):(T.queue(e,T.createRecord(e,{type:T.ContentType.handshake,data:T.createCertificate(e)})),e.fail||(T.queue(e,T.createRecord(e,{type:T.ContentType.handshake,data:T.createServerKeyExchange(e)})),e.verifyClient!==!1&&T.queue(e,T.createRecord(e,{type:T.ContentType.handshake,data:T.createCertificateRequest(e)})),T.queue(e,T.createRecord(e,{type:T.ContentType.handshake,data:T.createServerHelloDone(e)})))),T.flush(e),e.process()}};T.handleCertificate=function(e,t,a){if(a<3)return e.error(e,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.illegal_parameter}});var r=t.fragment,i={certificate_list:qt(r,3)},n,s,f=[];try{for(;i.certificate_list.length()>0;)n=qt(i.certificate_list,3),s=X.asn1.fromDer(n),n=X.pki.certificateFromAsn1(s,!0),f.push(n)}catch(o){return e.error(e,{message:"Could not parse certificate list.",cause:o,send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.bad_certificate}})}var u=e.entity===T.ConnectionEnd.client;(u||e.verifyClient===!0)&&f.length===0?e.error(e,{message:u?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.illegal_parameter}}):f.length===0?e.expect=u?Yf:Kn:(u?e.session.serverCertificate=f[0]:e.session.clientCertificate=f[0],T.verifyCertificateChain(e,f)&&(e.expect=u?Yf:Kn)),e.process()};T.handleServerKeyExchange=function(e,t,a){if(a>0)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.unsupported_certificate}});e.expect=mp,e.process()};T.handleClientKeyExchange=function(e,t,a){if(a<48)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.unsupported_certificate}});var r=t.fragment,i={enc_pre_master_secret:qt(r,2).getBytes()},n=null;if(e.getPrivateKey)try{n=e.getPrivateKey(e,e.session.serverCertificate),n=X.pki.privateKeyFromPem(n)}catch(u){e.error(e,{message:"Could not get private key.",cause:u,send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.internal_error}})}if(n===null)return e.error(e,{message:"No private key set.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.internal_error}});try{var s=e.session.sp;s.pre_master_secret=n.decrypt(i.enc_pre_master_secret);var f=e.session.clientHelloVersion;if(f.major!==s.pre_master_secret.charCodeAt(0)||f.minor!==s.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{s.pre_master_secret=X.random.getBytes(48)}e.expect=Ts,e.session.clientCertificate!==null&&(e.expect=Ip),e.process()};T.handleCertificateRequest=function(e,t,a){if(a<3)return e.error(e,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.illegal_parameter}});var r=t.fragment,i={certificate_types:qt(r,1),certificate_authorities:qt(r,2)};e.session.certificateRequest=i,e.expect=Cp,e.process()};T.handleCertificateVerify=function(e,t,a){if(a<2)return e.error(e,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.illegal_parameter}});var r=t.fragment;r.read-=4;var i=r.bytes();r.read+=4;var n={signature:qt(r,2).getBytes()},s=X.util.createBuffer();s.putBuffer(e.session.md5.digest()),s.putBuffer(e.session.sha1.digest()),s=s.getBytes();try{var f=e.session.clientCertificate;if(!f.publicKey.verify(s,n.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");e.session.md5.update(i),e.session.sha1.update(i)}catch{return e.error(e,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.handshake_failure}})}e.expect=Ts,e.process()};T.handleServerHelloDone=function(e,t,a){if(a>0)return e.error(e,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.record_overflow}});if(e.serverCertificate===null){var r={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.insufficient_security}},i=0,n=e.verify(e,r.alert.description,i,[]);if(n!==!0)return(n||n===0)&&(typeof n=="object"&&!X.util.isArray(n)?(n.message&&(r.message=n.message),n.alert&&(r.alert.description=n.alert)):typeof n=="number"&&(r.alert.description=n)),e.error(e,r)}e.session.certificateRequest!==null&&(t=T.createRecord(e,{type:T.ContentType.handshake,data:T.createCertificate(e)}),T.queue(e,t)),t=T.createRecord(e,{type:T.ContentType.handshake,data:T.createClientKeyExchange(e)}),T.queue(e,t),e.expect=Sp;var s=function(f,u){f.session.certificateRequest!==null&&f.session.clientCertificate!==null&&T.queue(f,T.createRecord(f,{type:T.ContentType.handshake,data:T.createCertificateVerify(f,u)})),T.queue(f,T.createRecord(f,{type:T.ContentType.change_cipher_spec,data:T.createChangeCipherSpec()})),f.state.pending=T.createConnectionState(f),f.state.current.write=f.state.pending.write,T.queue(f,T.createRecord(f,{type:T.ContentType.handshake,data:T.createFinished(f)})),f.expect=Vc,T.flush(f),f.process()};if(e.session.certificateRequest===null||e.session.clientCertificate===null)return s(e,null);T.getClientSignature(e,s)};T.handleChangeCipherSpec=function(e,t){if(t.fragment.getByte()!==1)return e.error(e,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.illegal_parameter}});var a=e.entity===T.ConnectionEnd.client;(e.session.resuming&&a||!e.session.resuming&&!a)&&(e.state.pending=T.createConnectionState(e)),e.state.current.read=e.state.pending.read,(!e.session.resuming&&a||e.session.resuming&&!a)&&(e.state.pending=null),e.expect=a?Ep:Tp,e.process()};T.handleFinished=function(e,t,a){var r=t.fragment;r.read-=4;var i=r.bytes();r.read+=4;var n=t.fragment.getBytes();r=X.util.createBuffer(),r.putBuffer(e.session.md5.digest()),r.putBuffer(e.session.sha1.digest());var s=e.entity===T.ConnectionEnd.client,f=s?"server finished":"client finished",u=e.session.sp,o=12,c=ci;if(r=c(u.master_secret,f,r.getBytes(),o),r.getBytes()!==n)return e.error(e,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.decrypt_error}});e.session.md5.update(i),e.session.sha1.update(i),(e.session.resuming&&s||!e.session.resuming&&!s)&&(T.queue(e,T.createRecord(e,{type:T.ContentType.change_cipher_spec,data:T.createChangeCipherSpec()})),e.state.current.write=e.state.pending.write,e.state.pending=null,T.queue(e,T.createRecord(e,{type:T.ContentType.handshake,data:T.createFinished(e)}))),e.expect=s?Ap:wp,e.handshaking=!1,++e.handshakes,e.peerCertificate=s?e.session.serverCertificate:e.session.clientCertificate,T.flush(e),e.isConnected=!0,e.connected(e),e.process()};T.handleAlert=function(e,t){var a=t.fragment,r={level:a.getByte(),description:a.getByte()},i;switch(r.description){case T.Alert.Description.close_notify:i="Connection closed.";break;case T.Alert.Description.unexpected_message:i="Unexpected message.";break;case T.Alert.Description.bad_record_mac:i="Bad record MAC.";break;case T.Alert.Description.decryption_failed:i="Decryption failed.";break;case T.Alert.Description.record_overflow:i="Record overflow.";break;case T.Alert.Description.decompression_failure:i="Decompression failed.";break;case T.Alert.Description.handshake_failure:i="Handshake failure.";break;case T.Alert.Description.bad_certificate:i="Bad certificate.";break;case T.Alert.Description.unsupported_certificate:i="Unsupported certificate.";break;case T.Alert.Description.certificate_revoked:i="Certificate revoked.";break;case T.Alert.Description.certificate_expired:i="Certificate expired.";break;case T.Alert.Description.certificate_unknown:i="Certificate unknown.";break;case T.Alert.Description.illegal_parameter:i="Illegal parameter.";break;case T.Alert.Description.unknown_ca:i="Unknown certificate authority.";break;case T.Alert.Description.access_denied:i="Access denied.";break;case T.Alert.Description.decode_error:i="Decode error.";break;case T.Alert.Description.decrypt_error:i="Decrypt error.";break;case T.Alert.Description.export_restriction:i="Export restriction.";break;case T.Alert.Description.protocol_version:i="Unsupported protocol version.";break;case T.Alert.Description.insufficient_security:i="Insufficient security.";break;case T.Alert.Description.internal_error:i="Internal error.";break;case T.Alert.Description.user_canceled:i="User canceled.";break;case T.Alert.Description.no_renegotiation:i="Renegotiation not supported.";break;default:i="Unknown error.";break}if(r.description===T.Alert.Description.close_notify)return e.close();e.error(e,{message:i,send:!1,origin:e.entity===T.ConnectionEnd.client?"server":"client",alert:r}),e.process()};T.handleHandshake=function(e,t){var a=t.fragment,r=a.getByte(),i=a.getInt24();if(i>a.length())return e.fragmented=t,t.fragment=X.util.createBuffer(),a.read-=4,e.process();e.fragmented=null,a.read-=4;var n=a.bytes(i+4);a.read+=4,r in Pa[e.entity][e.expect]?(e.entity===T.ConnectionEnd.server&&!e.open&&!e.fail&&(e.handshaking=!0,e.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:X.md.md5.create(),sha1:X.md.sha1.create()}),r!==T.HandshakeType.hello_request&&r!==T.HandshakeType.certificate_verify&&r!==T.HandshakeType.finished&&(e.session.md5.update(n),e.session.sha1.update(n)),Pa[e.entity][e.expect][r](e,t,i)):T.handleUnexpected(e,t)};T.handleApplicationData=function(e,t){e.data.putBuffer(t.fragment),e.dataReady(e),e.process()};T.handleHeartbeat=function(e,t){var a=t.fragment,r=a.getByte(),i=a.getInt16(),n=a.getBytes(i);if(r===T.HeartbeatMessageType.heartbeat_request){if(e.handshaking||i>n.length)return e.process();T.queue(e,T.createRecord(e,{type:T.ContentType.heartbeat,data:T.createHeartbeat(T.HeartbeatMessageType.heartbeat_response,n)})),T.flush(e)}else if(r===T.HeartbeatMessageType.heartbeat_response){if(n!==e.expectedHeartbeatPayload)return e.process();e.heartbeatReceived&&e.heartbeatReceived(e,X.util.createBuffer(n))}e.process()};var yp=0,bp=1,Yf=2,mp=3,Cp=4,Vc=5,Ep=6,Ap=7,Sp=8,Bp=0,_p=1,Kn=2,Ip=3,Ts=4,Tp=5,wp=6,_=T.handleUnexpected,Kc=T.handleChangeCipherSpec,Tt=T.handleAlert,Lt=T.handleHandshake,qc=T.handleApplicationData,wt=T.handleHeartbeat,ws=[];ws[T.ConnectionEnd.client]=[[_,Tt,Lt,_,wt],[_,Tt,Lt,_,wt],[_,Tt,Lt,_,wt],[_,Tt,Lt,_,wt],[_,Tt,Lt,_,wt],[Kc,Tt,_,_,wt],[_,Tt,Lt,_,wt],[_,Tt,Lt,qc,wt],[_,Tt,Lt,_,wt]];ws[T.ConnectionEnd.server]=[[_,Tt,Lt,_,wt],[_,Tt,Lt,_,wt],[_,Tt,Lt,_,wt],[_,Tt,Lt,_,wt],[Kc,Tt,_,_,wt],[_,Tt,Lt,_,wt],[_,Tt,Lt,qc,wt],[_,Tt,Lt,_,wt]];var Pr=T.handleHelloRequest,Dp=T.handleServerHello,Hc=T.handleCertificate,Zf=T.handleServerKeyExchange,En=T.handleCertificateRequest,xa=T.handleServerHelloDone,zc=T.handleFinished,Pa=[];Pa[T.ConnectionEnd.client]=[[_,_,Dp,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[Pr,_,_,_,_,_,_,_,_,_,_,Hc,Zf,En,xa,_,_,_,_,_,_],[Pr,_,_,_,_,_,_,_,_,_,_,_,Zf,En,xa,_,_,_,_,_,_],[Pr,_,_,_,_,_,_,_,_,_,_,_,_,En,xa,_,_,_,_,_,_],[Pr,_,_,_,_,_,_,_,_,_,_,_,_,_,xa,_,_,_,_,_,_],[Pr,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[Pr,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,zc],[Pr,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[Pr,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_]];var Np=T.handleClientHello,Rp=T.handleClientKeyExchange,Fp=T.handleCertificateVerify;Pa[T.ConnectionEnd.server]=[[_,Np,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,Hc,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,Rp,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,Fp,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,zc],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_]];T.generateKeys=function(e,t){var a=ci,r=t.client_random+t.server_random;e.session.resuming||(t.master_secret=a(t.pre_master_secret,"master secret",r,48).bytes(),t.pre_master_secret=null),r=t.server_random+t.client_random;var i=2*t.mac_key_length+2*t.enc_key_length,n=e.version.major===T.Versions.TLS_1_0.major&&e.version.minor===T.Versions.TLS_1_0.minor;n&&(i+=2*t.fixed_iv_length);var s=a(t.master_secret,"key expansion",r,i),f={client_write_MAC_key:s.getBytes(t.mac_key_length),server_write_MAC_key:s.getBytes(t.mac_key_length),client_write_key:s.getBytes(t.enc_key_length),server_write_key:s.getBytes(t.enc_key_length)};return n&&(f.client_write_IV=s.getBytes(t.fixed_iv_length),f.server_write_IV=s.getBytes(t.fixed_iv_length)),f};T.createConnectionState=function(e){var t=e.entity===T.ConnectionEnd.client,a=function(){var n={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(s){return!0},compressionState:null,compressFunction:function(s){return!0},updateSequenceNumber:function(){n.sequenceNumber[1]===4294967295?(n.sequenceNumber[1]=0,++n.sequenceNumber[0]):++n.sequenceNumber[1]}};return n},r={read:a(),write:a()};if(r.read.update=function(n,s){return r.read.cipherFunction(s,r.read)?r.read.compressFunction(n,s,r.read)||n.error(n,{message:"Could not decompress record.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.decompression_failure}}):n.error(n,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.bad_record_mac}}),!n.fail},r.write.update=function(n,s){return r.write.compressFunction(n,s,r.write)?r.write.cipherFunction(s,r.write)||n.error(n,{message:"Could not encrypt record.",send:!1,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.internal_error}}):n.error(n,{message:"Could not compress record.",send:!1,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.internal_error}}),!n.fail},e.session){var i=e.session.sp;switch(e.session.cipherSuite.initSecurityParameters(i),i.keys=T.generateKeys(e,i),r.read.macKey=t?i.keys.server_write_MAC_key:i.keys.client_write_MAC_key,r.write.macKey=t?i.keys.client_write_MAC_key:i.keys.server_write_MAC_key,e.session.cipherSuite.initConnectionState(r,e,i),i.compression_algorithm){case T.CompressionMethod.none:break;case T.CompressionMethod.deflate:r.read.compressFunction=gp,r.write.compressFunction=xp;break;default:throw new Error("Unsupported compression algorithm.")}}return r};T.createRandom=function(){var e=new Date,t=+e+e.getTimezoneOffset()*6e4,a=X.util.createBuffer();return a.putInt32(t),a.putBytes(X.random.getBytes(28)),a};T.createRecord=function(e,t){if(!t.data)return null;var a={type:t.type,version:{major:e.version.major,minor:e.version.minor},length:t.data.length(),fragment:t.data};return a};T.createAlert=function(e,t){var a=X.util.createBuffer();return a.putByte(t.level),a.putByte(t.description),T.createRecord(e,{type:T.ContentType.alert,data:a})};T.createClientHello=function(e){e.session.clientHelloVersion={major:e.version.major,minor:e.version.minor};for(var t=X.util.createBuffer(),a=0;a<e.cipherSuites.length;++a){var r=e.cipherSuites[a];t.putByte(r.id[0]),t.putByte(r.id[1])}var i=t.length(),n=X.util.createBuffer();n.putByte(T.CompressionMethod.none);var s=n.length(),f=X.util.createBuffer();if(e.virtualHost){var u=X.util.createBuffer();u.putByte(0),u.putByte(0);var o=X.util.createBuffer();o.putByte(0),Gt(o,2,X.util.createBuffer(e.virtualHost));var c=X.util.createBuffer();Gt(c,2,o),Gt(u,2,c),f.putBuffer(u)}var l=f.length();l>0&&(l+=2);var h=e.session.id,g=h.length+1+2+4+28+2+i+1+s+l,v=X.util.createBuffer();return v.putByte(T.HandshakeType.client_hello),v.putInt24(g),v.putByte(e.version.major),v.putByte(e.version.minor),v.putBytes(e.session.sp.client_random),Gt(v,1,X.util.createBuffer(h)),Gt(v,2,t),Gt(v,1,n),l>0&&Gt(v,2,f),v};T.createServerHello=function(e){var t=e.session.id,a=t.length+1+2+4+28+2+1,r=X.util.createBuffer();return r.putByte(T.HandshakeType.server_hello),r.putInt24(a),r.putByte(e.version.major),r.putByte(e.version.minor),r.putBytes(e.session.sp.server_random),Gt(r,1,X.util.createBuffer(t)),r.putByte(e.session.cipherSuite.id[0]),r.putByte(e.session.cipherSuite.id[1]),r.putByte(e.session.compressionMethod),r};T.createCertificate=function(e){var t=e.entity===T.ConnectionEnd.client,a=null;if(e.getCertificate){var r;t?r=e.session.certificateRequest:r=e.session.extensions.server_name.serverNameList,a=e.getCertificate(e,r)}var i=X.util.createBuffer();if(a!==null)try{X.util.isArray(a)||(a=[a]);for(var n=null,s=0;s<a.length;++s){var f=X.pem.decode(a[s])[0];if(f.type!=="CERTIFICATE"&&f.type!=="X509 CERTIFICATE"&&f.type!=="TRUSTED CERTIFICATE"){var u=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw u.headerType=f.type,u}if(f.procType&&f.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var o=X.util.createBuffer(f.body);n===null&&(n=X.asn1.fromDer(o.bytes(),!1));var c=X.util.createBuffer();Gt(c,3,o),i.putBuffer(c)}a=X.pki.certificateFromAsn1(n),t?e.session.clientCertificate=a:e.session.serverCertificate=a}catch(g){return e.error(e,{message:"Could not send certificate list.",cause:g,send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.bad_certificate}})}var l=3+i.length(),h=X.util.createBuffer();return h.putByte(T.HandshakeType.certificate),h.putInt24(l),Gt(h,3,i),h};T.createClientKeyExchange=function(e){var t=X.util.createBuffer();t.putByte(e.session.clientHelloVersion.major),t.putByte(e.session.clientHelloVersion.minor),t.putBytes(X.random.getBytes(46));var a=e.session.sp;a.pre_master_secret=t.getBytes();var r=e.session.serverCertificate.publicKey;t=r.encrypt(a.pre_master_secret);var i=t.length+2,n=X.util.createBuffer();return n.putByte(T.HandshakeType.client_key_exchange),n.putInt24(i),n.putInt16(t.length),n.putBytes(t),n};T.createServerKeyExchange=function(e){var t=X.util.createBuffer();return t};T.getClientSignature=function(e,t){var a=X.util.createBuffer();a.putBuffer(e.session.md5.digest()),a.putBuffer(e.session.sha1.digest()),a=a.getBytes(),e.getSignature=e.getSignature||function(r,i,n){var s=null;if(r.getPrivateKey)try{s=r.getPrivateKey(r,r.session.clientCertificate),s=X.pki.privateKeyFromPem(s)}catch(f){r.error(r,{message:"Could not get private key.",cause:f,send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.internal_error}})}s===null?r.error(r,{message:"No private key set.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.internal_error}}):i=s.sign(i,null),n(r,i)},e.getSignature(e,a,t)};T.createCertificateVerify=function(e,t){var a=t.length+2,r=X.util.createBuffer();return r.putByte(T.HandshakeType.certificate_verify),r.putInt24(a),r.putInt16(t.length),r.putBytes(t),r};T.createCertificateRequest=function(e){var t=X.util.createBuffer();t.putByte(1);var a=X.util.createBuffer();for(var r in e.caStore.certs){var i=e.caStore.certs[r],n=X.pki.distinguishedNameToAsn1(i.subject),s=X.asn1.toDer(n);a.putInt16(s.length()),a.putBuffer(s)}var f=1+t.length()+2+a.length(),u=X.util.createBuffer();return u.putByte(T.HandshakeType.certificate_request),u.putInt24(f),Gt(u,1,t),Gt(u,2,a),u};T.createServerHelloDone=function(e){var t=X.util.createBuffer();return t.putByte(T.HandshakeType.server_hello_done),t.putInt24(0),t};T.createChangeCipherSpec=function(){var e=X.util.createBuffer();return e.putByte(1),e};T.createFinished=function(e){var t=X.util.createBuffer();t.putBuffer(e.session.md5.digest()),t.putBuffer(e.session.sha1.digest());var a=e.entity===T.ConnectionEnd.client,r=e.session.sp,i=12,n=ci,s=a?"client finished":"server finished";t=n(r.master_secret,s,t.getBytes(),i);var f=X.util.createBuffer();return f.putByte(T.HandshakeType.finished),f.putInt24(t.length()),f.putBuffer(t),f};T.createHeartbeat=function(e,t,a){typeof a>"u"&&(a=t.length);var r=X.util.createBuffer();r.putByte(e),r.putInt16(a),r.putBytes(t);var i=r.length(),n=Math.max(16,i-a-3);return r.putBytes(X.random.getBytes(n)),r};T.queue=function(e,t){if(t&&!(t.fragment.length()===0&&(t.type===T.ContentType.handshake||t.type===T.ContentType.alert||t.type===T.ContentType.change_cipher_spec))){if(t.type===T.ContentType.handshake){var a=t.fragment.bytes();e.session.md5.update(a),e.session.sha1.update(a),a=null}var r;if(t.fragment.length()<=T.MaxFragment)r=[t];else{r=[];for(var i=t.fragment.bytes();i.length>T.MaxFragment;)r.push(T.createRecord(e,{type:t.type,data:X.util.createBuffer(i.slice(0,T.MaxFragment))})),i=i.slice(T.MaxFragment);i.length>0&&r.push(T.createRecord(e,{type:t.type,data:X.util.createBuffer(i)}))}for(var n=0;n<r.length&&!e.fail;++n){var s=r[n],f=e.state.current.write;f.update(e,s)&&e.records.push(s)}}};T.flush=function(e){for(var t=0;t<e.records.length;++t){var a=e.records[t];e.tlsData.putByte(a.type),e.tlsData.putByte(a.version.major),e.tlsData.putByte(a.version.minor),e.tlsData.putInt16(a.fragment.length()),e.tlsData.putBuffer(e.records[t].fragment)}return e.records=[],e.tlsDataReady(e)};var An=function(e){switch(e){case!0:return!0;case X.pki.certificateError.bad_certificate:return T.Alert.Description.bad_certificate;case X.pki.certificateError.unsupported_certificate:return T.Alert.Description.unsupported_certificate;case X.pki.certificateError.certificate_revoked:return T.Alert.Description.certificate_revoked;case X.pki.certificateError.certificate_expired:return T.Alert.Description.certificate_expired;case X.pki.certificateError.certificate_unknown:return T.Alert.Description.certificate_unknown;case X.pki.certificateError.unknown_ca:return T.Alert.Description.unknown_ca;default:return T.Alert.Description.bad_certificate}},kp=function(e){switch(e){case!0:return!0;case T.Alert.Description.bad_certificate:return X.pki.certificateError.bad_certificate;case T.Alert.Description.unsupported_certificate:return X.pki.certificateError.unsupported_certificate;case T.Alert.Description.certificate_revoked:return X.pki.certificateError.certificate_revoked;case T.Alert.Description.certificate_expired:return X.pki.certificateError.certificate_expired;case T.Alert.Description.certificate_unknown:return X.pki.certificateError.certificate_unknown;case T.Alert.Description.unknown_ca:return X.pki.certificateError.unknown_ca;default:return X.pki.certificateError.bad_certificate}};T.verifyCertificateChain=function(e,t){try{var a={};for(var r in e.verifyOptions)a[r]=e.verifyOptions[r];a.verify=function(n,s,f){var u=An(n),o=e.verify(e,n,s,f);if(o!==!0){if(typeof o=="object"&&!X.util.isArray(o)){var c=new Error("The application rejected the certificate.");throw c.send=!0,c.alert={level:T.Alert.Level.fatal,description:T.Alert.Description.bad_certificate},o.message&&(c.message=o.message),o.alert&&(c.alert.description=o.alert),c}o!==n&&(o=kp(o))}return o},X.pki.verifyCertificateChain(e.caStore,t,a)}catch(n){var i=n;(typeof i!="object"||X.util.isArray(i))&&(i={send:!0,alert:{level:T.Alert.Level.fatal,description:An(n)}}),"send"in i||(i.send=!0),"alert"in i||(i.alert={level:T.Alert.Level.fatal,description:An(i.error)}),e.error(e,i)}return!e.fail};T.createSessionCache=function(e,t){var a=null;if(e&&e.getSession&&e.setSession&&e.order)a=e;else{a={},a.cache=e||{},a.capacity=Math.max(t||100,1),a.order=[];for(var r in e)a.order.length<=t?a.order.push(r):delete e[r];a.getSession=function(i){var n=null,s=null;if(i?s=X.util.bytesToHex(i):a.order.length>0&&(s=a.order[0]),s!==null&&s in a.cache){n=a.cache[s],delete a.cache[s];for(var f in a.order)if(a.order[f]===s){a.order.splice(f,1);break}}return n},a.setSession=function(i,n){if(a.order.length===a.capacity){var s=a.order.shift();delete a.cache[s]}var s=X.util.bytesToHex(i);a.order.push(s),a.cache[s]=n}}return a};T.createConnection=function(e){var t=null;e.caStore?X.util.isArray(e.caStore)?t=X.pki.createCaStore(e.caStore):t=e.caStore:t=X.pki.createCaStore();var a=e.cipherSuites||null;if(a===null){a=[];for(var r in T.CipherSuites)a.push(T.CipherSuites[r])}var i=e.server?T.ConnectionEnd.server:T.ConnectionEnd.client,n=e.sessionCache?T.createSessionCache(e.sessionCache):null,s={version:{major:T.Version.major,minor:T.Version.minor},entity:i,sessionId:e.sessionId,caStore:t,sessionCache:n,cipherSuites:a,connected:e.connected,virtualHost:e.virtualHost||null,verifyClient:e.verifyClient||!1,verify:e.verify||function(c,l,h,g){return l},verifyOptions:e.verifyOptions||{},getCertificate:e.getCertificate||null,getPrivateKey:e.getPrivateKey||null,getSignature:e.getSignature||null,input:X.util.createBuffer(),tlsData:X.util.createBuffer(),data:X.util.createBuffer(),tlsDataReady:e.tlsDataReady,dataReady:e.dataReady,heartbeatReceived:e.heartbeatReceived,closed:e.closed,error:function(c,l){l.origin=l.origin||(c.entity===T.ConnectionEnd.client?"client":"server"),l.send&&(T.queue(c,T.createAlert(c,l.alert)),T.flush(c));var h=l.fatal!==!1;h&&(c.fail=!0),e.error(c,l),h&&c.close(!1)},deflate:e.deflate||null,inflate:e.inflate||null};s.reset=function(c){s.version={major:T.Version.major,minor:T.Version.minor},s.record=null,s.session=null,s.peerCertificate=null,s.state={pending:null,current:null},s.expect=s.entity===T.ConnectionEnd.client?yp:Bp,s.fragmented=null,s.records=[],s.open=!1,s.handshakes=0,s.handshaking=!1,s.isConnected=!1,s.fail=!(c||typeof c>"u"),s.input.clear(),s.tlsData.clear(),s.data.clear(),s.state.current=T.createConnectionState(s)},s.reset();var f=function(c,l){var h=l.type-T.ContentType.change_cipher_spec,g=ws[c.entity][c.expect];h in g?g[h](c,l):T.handleUnexpected(c,l)},u=function(c){var l=0,h=c.input,g=h.length();if(g<5)l=5-g;else{c.record={type:h.getByte(),version:{major:h.getByte(),minor:h.getByte()},length:h.getInt16(),fragment:X.util.createBuffer(),ready:!1};var v=c.record.version.major===c.version.major;v&&c.session&&c.session.version&&(v=c.record.version.minor===c.version.minor),v||c.error(c,{message:"Incompatible TLS version.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.protocol_version}})}return l},o=function(c){var l=0,h=c.input,g=h.length();if(g<c.record.length)l=c.record.length-g;else{c.record.fragment.putBytes(h.getBytes(c.record.length)),h.compact();var v=c.state.current.read;v.update(c,c.record)&&(c.fragmented!==null&&(c.fragmented.type===c.record.type?(c.fragmented.fragment.putBuffer(c.record.fragment),c.record=c.fragmented):c.error(c,{message:"Invalid fragmented record.",send:!0,alert:{level:T.Alert.Level.fatal,description:T.Alert.Description.unexpected_message}})),c.record.ready=!0)}return l};return s.handshake=function(c){if(s.entity!==T.ConnectionEnd.client)s.error(s,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(s.handshaking)s.error(s,{message:"Handshake already in progress.",fatal:!1});else{s.fail&&!s.open&&s.handshakes===0&&(s.fail=!1),s.handshaking=!0,c=c||"";var l=null;c.length>0&&(s.sessionCache&&(l=s.sessionCache.getSession(c)),l===null&&(c="")),c.length===0&&s.sessionCache&&(l=s.sessionCache.getSession(),l!==null&&(c=l.id)),s.session={id:c,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:X.md.md5.create(),sha1:X.md.sha1.create()},l&&(s.version=l.version,s.session.sp=l.sp),s.session.sp.client_random=T.createRandom().getBytes(),s.open=!0,T.queue(s,T.createRecord(s,{type:T.ContentType.handshake,data:T.createClientHello(s)})),T.flush(s)}},s.process=function(c){var l=0;return c&&s.input.putBytes(c),s.fail||(s.record!==null&&s.record.ready&&s.record.fragment.isEmpty()&&(s.record=null),s.record===null&&(l=u(s)),!s.fail&&s.record!==null&&!s.record.ready&&(l=o(s)),!s.fail&&s.record!==null&&s.record.ready&&f(s,s.record)),l},s.prepare=function(c){return T.queue(s,T.createRecord(s,{type:T.ContentType.application_data,data:X.util.createBuffer(c)})),T.flush(s)},s.prepareHeartbeatRequest=function(c,l){return c instanceof X.util.ByteBuffer&&(c=c.bytes()),typeof l>"u"&&(l=c.length),s.expectedHeartbeatPayload=c,T.queue(s,T.createRecord(s,{type:T.ContentType.heartbeat,data:T.createHeartbeat(T.HeartbeatMessageType.heartbeat_request,c,l)})),T.flush(s)},s.close=function(c){if(!s.fail&&s.sessionCache&&s.session){var l={id:s.session.id,version:s.session.version,sp:s.session.sp};l.sp.keys=null,s.sessionCache.setSession(l.id,l)}s.open&&(s.open=!1,s.input.clear(),(s.isConnected||s.handshaking)&&(s.isConnected=s.handshaking=!1,T.queue(s,T.createAlert(s,{level:T.Alert.Level.warning,description:T.Alert.Description.close_notify})),T.flush(s)),s.closed(s)),s.reset(c)},s};X.tls=X.tls||{};for(var Sn in T)typeof T[Sn]!="function"&&(X.tls[Sn]=T[Sn]);X.tls.prf_tls1=ci;X.tls.hmac_sha1=pp;X.tls.createSessionCache=T.createSessionCache;X.tls.createConnection=T.createConnection;var Gr=me,Qt=Gr.tls;Qt.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=Qt.BulkCipherAlgorithm.aes,e.cipher_type=Qt.CipherType.block,e.enc_key_length=16,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=Qt.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:Gc};Qt.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=Qt.BulkCipherAlgorithm.aes,e.cipher_type=Qt.CipherType.block,e.enc_key_length=32,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=Qt.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:Gc};function Gc(e,t,a){var r=t.entity===Gr.tls.ConnectionEnd.client;e.read.cipherState={init:!1,cipher:Gr.cipher.createDecipher("AES-CBC",r?a.keys.server_write_key:a.keys.client_write_key),iv:r?a.keys.server_write_IV:a.keys.client_write_IV},e.write.cipherState={init:!1,cipher:Gr.cipher.createCipher("AES-CBC",r?a.keys.client_write_key:a.keys.server_write_key),iv:r?a.keys.client_write_IV:a.keys.server_write_IV},e.read.cipherFunction=Up,e.write.cipherFunction=Mp,e.read.macLength=e.write.macLength=a.mac_length,e.read.macFunction=e.write.macFunction=Qt.hmac_sha1}function Mp(e,t){var a=!1,r=t.macFunction(t.macKey,t.sequenceNumber,e);e.fragment.putBytes(r),t.updateSequenceNumber();var i;e.version.minor===Qt.Versions.TLS_1_0.minor?i=t.cipherState.init?null:t.cipherState.iv:i=Gr.random.getBytesSync(16),t.cipherState.init=!0;var n=t.cipherState.cipher;return n.start({iv:i}),e.version.minor>=Qt.Versions.TLS_1_1.minor&&n.output.putBytes(i),n.update(e.fragment),n.finish(Lp)&&(e.fragment=n.output,e.length=e.fragment.length(),a=!0),a}function Lp(e,t,a){if(!a){var r=e-t.length()%e;t.fillWithByte(r-1,r)}return!0}function Pp(e,t,a){var r=!0;if(a){for(var i=t.length(),n=t.last(),s=i-1-n;s<i-1;++s)r=r&&t.at(s)==n;r&&t.truncate(n+1)}return r}function Up(e,t){var a=!1,r;e.version.minor===Qt.Versions.TLS_1_0.minor?r=t.cipherState.init?null:t.cipherState.iv:r=e.fragment.getBytes(16),t.cipherState.init=!0;var i=t.cipherState.cipher;i.start({iv:r}),i.update(e.fragment),a=i.finish(Pp);var n=t.macLength,s=Gr.random.getBytesSync(n),f=i.output.length();f>=n?(e.fragment=i.output.getBytes(f-n),s=i.output.getBytes(n)):e.fragment=i.output.getBytes(),e.fragment=Gr.util.createBuffer(e.fragment),e.length=e.fragment.length();var u=t.macFunction(t.macKey,t.sequenceNumber,e);return t.updateSequenceNumber(),a=Op(t.macKey,s,u)&&a,a}function Op(e,t,a){var r=Gr.hmac.create();return r.start("SHA1",e),r.update(t),t=r.digest().getBytes(),r.start(null,null),r.update(a),a=r.digest().getBytes(),t===a}var Ge=me,ca=Ge.sha512=Ge.sha512||{};Ge.md.sha512=Ge.md.algorithms.sha512=ca;var jc=Ge.sha384=Ge.sha512.sha384=Ge.sha512.sha384||{};jc.create=function(){return ca.create("SHA-384")};Ge.md.sha384=Ge.md.algorithms.sha384=jc;Ge.sha512.sha256=Ge.sha512.sha256||{create:function(){return ca.create("SHA-512/256")}};Ge.md["sha512/256"]=Ge.md.algorithms["sha512/256"]=Ge.sha512.sha256;Ge.sha512.sha224=Ge.sha512.sha224||{create:function(){return ca.create("SHA-512/224")}};Ge.md["sha512/224"]=Ge.md.algorithms["sha512/224"]=Ge.sha512.sha224;ca.create=function(e){if($c||Vp(),typeof e>"u"&&(e="SHA-512"),!(e in a0))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=a0[e],a=null,r=Ge.util.createBuffer(),i=new Array(80),n=0;n<80;++n)i[n]=new Array(2);var s=64;switch(e){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var f={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return f.start=function(){f.messageLength=0,f.fullMessageLength=f.messageLength128=[];for(var u=f.messageLengthSize/4,o=0;o<u;++o)f.fullMessageLength.push(0);r=Ge.util.createBuffer(),a=new Array(t.length);for(var o=0;o<t.length;++o)a[o]=t[o].slice(0);return f},f.start(),f.update=function(u,o){o==="utf8"&&(u=Ge.util.encodeUtf8(u));var c=u.length;f.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var l=f.fullMessageLength.length-1;l>=0;--l)f.fullMessageLength[l]+=c[1],c[1]=c[0]+(f.fullMessageLength[l]/4294967296>>>0),f.fullMessageLength[l]=f.fullMessageLength[l]>>>0,c[0]=c[1]/4294967296>>>0;return r.putBytes(u),Jf(a,i,r),(r.read>2048||r.length()===0)&&r.compact(),f},f.digest=function(){var u=Ge.util.createBuffer();u.putBytes(r.bytes());var o=f.fullMessageLength[f.fullMessageLength.length-1]+f.messageLengthSize,c=o&f.blockLength-1;u.putBytes(qn.substr(0,f.blockLength-c));for(var l,h,g=f.fullMessageLength[0]*8,v=0;v<f.fullMessageLength.length-1;++v)l=f.fullMessageLength[v+1]*8,h=l/4294967296>>>0,g+=h,u.putInt32(g>>>0),g=l>>>0;u.putInt32(g);for(var y=new Array(a.length),v=0;v<a.length;++v)y[v]=a[v].slice(0);Jf(y,i,u);var b=Ge.util.createBuffer(),I;e==="SHA-512"?I=y.length:e==="SHA-384"?I=y.length-2:I=y.length-4;for(var v=0;v<I;++v)b.putInt32(y[v][0]),(v!==I-1||e!=="SHA-512/224")&&b.putInt32(y[v][1]);return b},f};var qn=null,$c=!1,Hn=null,a0=null;function Vp(){qn="",qn+=Ge.util.fillString("\0",128),Hn=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],a0={},a0["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],a0["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],a0["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],a0["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],$c=!0}function Jf(e,t,a){for(var r,i,n,s,f,u,o,c,l,h,g,v,y,b,I,A,w,N,k,M,V,z,W,U,C,d,x,m,S,D,F,P,R,p,E,q=a.length();q>=128;){for(S=0;S<16;++S)t[S][0]=a.getInt32()>>>0,t[S][1]=a.getInt32()>>>0;for(;S<80;++S)P=t[S-2],D=P[0],F=P[1],r=((D>>>19|F<<13)^(F>>>29|D<<3)^D>>>6)>>>0,i=((D<<13|F>>>19)^(F<<3|D>>>29)^(D<<26|F>>>6))>>>0,p=t[S-15],D=p[0],F=p[1],n=((D>>>1|F<<31)^(D>>>8|F<<24)^D>>>7)>>>0,s=((D<<31|F>>>1)^(D<<24|F>>>8)^(D<<25|F>>>7))>>>0,R=t[S-7],E=t[S-16],F=i+R[1]+s+E[1],t[S][0]=r+R[0]+n+E[0]+(F/4294967296>>>0)>>>0,t[S][1]=F>>>0;for(y=e[0][0],b=e[0][1],I=e[1][0],A=e[1][1],w=e[2][0],N=e[2][1],k=e[3][0],M=e[3][1],V=e[4][0],z=e[4][1],W=e[5][0],U=e[5][1],C=e[6][0],d=e[6][1],x=e[7][0],m=e[7][1],S=0;S<80;++S)o=((V>>>14|z<<18)^(V>>>18|z<<14)^(z>>>9|V<<23))>>>0,c=((V<<18|z>>>14)^(V<<14|z>>>18)^(z<<23|V>>>9))>>>0,l=(C^V&(W^C))>>>0,h=(d^z&(U^d))>>>0,f=((y>>>28|b<<4)^(b>>>2|y<<30)^(b>>>7|y<<25))>>>0,u=((y<<4|b>>>28)^(b<<30|y>>>2)^(b<<25|y>>>7))>>>0,g=(y&I|w&(y^I))>>>0,v=(b&A|N&(b^A))>>>0,F=m+c+h+Hn[S][1]+t[S][1],r=x+o+l+Hn[S][0]+t[S][0]+(F/4294967296>>>0)>>>0,i=F>>>0,F=u+v,n=f+g+(F/4294967296>>>0)>>>0,s=F>>>0,x=C,m=d,C=W,d=U,W=V,U=z,F=M+i,V=k+r+(F/4294967296>>>0)>>>0,z=F>>>0,k=w,M=N,w=I,N=A,I=y,A=b,F=i+s,y=r+n+(F/4294967296>>>0)>>>0,b=F>>>0;F=e[0][1]+b,e[0][0]=e[0][0]+y+(F/4294967296>>>0)>>>0,e[0][1]=F>>>0,F=e[1][1]+A,e[1][0]=e[1][0]+I+(F/4294967296>>>0)>>>0,e[1][1]=F>>>0,F=e[2][1]+N,e[2][0]=e[2][0]+w+(F/4294967296>>>0)>>>0,e[2][1]=F>>>0,F=e[3][1]+M,e[3][0]=e[3][0]+k+(F/4294967296>>>0)>>>0,e[3][1]=F>>>0,F=e[4][1]+z,e[4][0]=e[4][0]+V+(F/4294967296>>>0)>>>0,e[4][1]=F>>>0,F=e[5][1]+U,e[5][0]=e[5][0]+W+(F/4294967296>>>0)>>>0,e[5][1]=F>>>0,F=e[6][1]+d,e[6][0]=e[6][0]+C+(F/4294967296>>>0)>>>0,e[6][1]=F>>>0,F=e[7][1]+m,e[7][0]=e[7][0]+x+(F/4294967296>>>0)>>>0,e[7][1]=F>>>0,q-=128}}var Ds={},Kp=me,Ct=Kp.asn1;Ds.privateKeyValidator={name:"PrivateKeyInfo",tagClass:Ct.Class.UNIVERSAL,type:Ct.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:Ct.Class.UNIVERSAL,type:Ct.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:Ct.Class.UNIVERSAL,type:Ct.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Ct.Class.UNIVERSAL,type:Ct.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:Ct.Class.UNIVERSAL,type:Ct.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};Ds.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:Ct.Class.UNIVERSAL,type:Ct.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:Ct.Class.UNIVERSAL,type:Ct.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Ct.Class.UNIVERSAL,type:Ct.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:Ct.Class.UNIVERSAL,type:Ct.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]};var Dt=me,Wc=Ds,qp=Wc.publicKeyValidator,Hp=Wc.privateKeyValidator;if(typeof zp>"u")var zp=Dt.jsbn.BigInteger;var zn=Dt.util.ByteBuffer,Kt=typeof Buffer>"u"?Uint8Array:Buffer;Dt.pki=Dt.pki||{};Dt.pki.ed25519=Dt.ed25519=Dt.ed25519||{};var Ee=Dt.ed25519;Ee.constants={};Ee.constants.PUBLIC_KEY_BYTE_LENGTH=32;Ee.constants.PRIVATE_KEY_BYTE_LENGTH=64;Ee.constants.SEED_BYTE_LENGTH=32;Ee.constants.SIGN_BYTE_LENGTH=64;Ee.constants.HASH_BYTE_LENGTH=64;Ee.generateKeyPair=function(e){e=e||{};var t=e.seed;if(t===void 0)t=Dt.random.getBytesSync(Ee.constants.SEED_BYTE_LENGTH);else if(typeof t=="string"){if(t.length!==Ee.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+Ee.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');t=wr({message:t,encoding:"binary"});for(var a=new Kt(Ee.constants.PUBLIC_KEY_BYTE_LENGTH),r=new Kt(Ee.constants.PRIVATE_KEY_BYTE_LENGTH),i=0;i<32;++i)r[i]=t[i];return Wp(a,r),{publicKey:a,privateKey:r}};Ee.privateKeyFromAsn1=function(e){var t={},a=[],r=Dt.asn1.validate(e,Hp,t,a);if(!r){var i=new Error("Invalid Key.");throw i.errors=a,i}var n=Dt.asn1.derToOid(t.privateKeyOid),s=Dt.oids.EdDSA25519;if(n!==s)throw new Error('Invalid OID "'+n+'"; OID must be "'+s+'".');var f=t.privateKey,u=wr({message:Dt.asn1.fromDer(f).value,encoding:"binary"});return{privateKeyBytes:u}};Ee.publicKeyFromAsn1=function(e){var t={},a=[],r=Dt.asn1.validate(e,qp,t,a);if(!r){var i=new Error("Invalid Key.");throw i.errors=a,i}var n=Dt.asn1.derToOid(t.publicKeyOid),s=Dt.oids.EdDSA25519;if(n!==s)throw new Error('Invalid OID "'+n+'"; OID must be "'+s+'".');var f=t.ed25519PublicKey;if(f.length!==Ee.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return wr({message:f,encoding:"binary"})};Ee.publicKeyFromPrivateKey=function(e){e=e||{};var t=wr({message:e.privateKey,encoding:"binary"});if(t.length!==Ee.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+Ee.constants.PRIVATE_KEY_BYTE_LENGTH);for(var a=new Kt(Ee.constants.PUBLIC_KEY_BYTE_LENGTH),r=0;r<a.length;++r)a[r]=t[32+r];return a};Ee.sign=function(e){e=e||{};var t=wr(e),a=wr({message:e.privateKey,encoding:"binary"});if(a.length===Ee.constants.SEED_BYTE_LENGTH){var r=Ee.generateKeyPair({seed:a});a=r.privateKey}else if(a.length!==Ee.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+Ee.constants.SEED_BYTE_LENGTH+" or "+Ee.constants.PRIVATE_KEY_BYTE_LENGTH);var i=new Kt(Ee.constants.SIGN_BYTE_LENGTH+t.length);Qp(i,t,t.length,a);for(var n=new Kt(Ee.constants.SIGN_BYTE_LENGTH),s=0;s<n.length;++s)n[s]=i[s];return n};Ee.verify=function(e){e=e||{};var t=wr(e);if(e.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var a=wr({message:e.signature,encoding:"binary"});if(a.length!==Ee.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+Ee.constants.SIGN_BYTE_LENGTH);var r=wr({message:e.publicKey,encoding:"binary"});if(r.length!==Ee.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+Ee.constants.PUBLIC_KEY_BYTE_LENGTH);var i=new Kt(Ee.constants.SIGN_BYTE_LENGTH+t.length),n=new Kt(Ee.constants.SIGN_BYTE_LENGTH+t.length),s;for(s=0;s<Ee.constants.SIGN_BYTE_LENGTH;++s)i[s]=a[s];for(s=0;s<t.length;++s)i[s+Ee.constants.SIGN_BYTE_LENGTH]=t[s];return Xp(n,i,i.length,r)>=0};function wr(e){var t=e.message;if(t instanceof Uint8Array||t instanceof Kt)return t;var a=e.encoding;if(t===void 0)if(e.md)t=e.md.digest().getBytes(),a="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof t=="string"&&!a)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof t=="string"){if(typeof Buffer<"u")return Buffer.from(t,a);t=new zn(t,a)}else if(!(t instanceof zn))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var r=new Kt(t.length()),i=0;i<r.length;++i)r[i]=t.at(i);return r}var Gn=ue(),Ua=ue([1]),Gp=ue([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),jp=ue([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),eo=ue([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),to=ue([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),Bn=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),$p=ue([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function ra(e,t){var a=Dt.md.sha512.create(),r=new zn(e);a.update(r.getBytes(t),"binary");var i=a.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(i,"binary");for(var n=new Kt(Ee.constants.HASH_BYTE_LENGTH),s=0;s<64;++s)n[s]=i.charCodeAt(s);return n}function Wp(e,t){var a=[ue(),ue(),ue(),ue()],r,i=ra(t,32);for(i[0]&=248,i[31]&=127,i[31]|=64,Rs(a,i),Ns(e,a),r=0;r<32;++r)t[r+32]=e[r];return 0}function Qp(e,t,a,r){var i,n,s=new Float64Array(64),f=[ue(),ue(),ue(),ue()],u=ra(r,32);u[0]&=248,u[31]&=127,u[31]|=64;var o=a+64;for(i=0;i<a;++i)e[64+i]=t[i];for(i=0;i<32;++i)e[32+i]=u[32+i];var c=ra(e.subarray(32),a+32);for(jn(c),Rs(f,c),Ns(e,f),i=32;i<64;++i)e[i]=r[i];var l=ra(e,a+64);for(jn(l),i=32;i<64;++i)s[i]=0;for(i=0;i<32;++i)s[i]=c[i];for(i=0;i<32;++i)for(n=0;n<32;n++)s[i+n]+=l[i]*u[n];return Qc(e.subarray(32),s),o}function Xp(e,t,a,r){var i,n,s=new Kt(32),f=[ue(),ue(),ue(),ue()],u=[ue(),ue(),ue(),ue()];if(n=-1,a<64||Yp(u,r))return-1;for(i=0;i<a;++i)e[i]=t[i];for(i=0;i<32;++i)e[i+32]=r[i];var o=ra(e,a);if(jn(o),Zc(f,u,o),Rs(u,t.subarray(32)),$n(f,u),Ns(s,f),a-=64,Xc(t,0,s,0)){for(i=0;i<a;++i)e[i]=0;return-1}for(i=0;i<a;++i)e[i]=t[i+64];return n=a,n}function Qc(e,t){var a,r,i,n;for(r=63;r>=32;--r){for(a=0,i=r-32,n=r-12;i<n;++i)t[i]+=a-16*t[r]*Bn[i-(r-32)],a=t[i]+128>>8,t[i]-=a*256;t[i]+=a,t[r]=0}for(a=0,i=0;i<32;++i)t[i]+=a-(t[31]>>4)*Bn[i],a=t[i]>>8,t[i]&=255;for(i=0;i<32;++i)t[i]-=a*Bn[i];for(r=0;r<32;++r)t[r+1]+=t[r]>>8,e[r]=t[r]&255}function jn(e){for(var t=new Float64Array(64),a=0;a<64;++a)t[a]=e[a],e[a]=0;Qc(e,t)}function $n(e,t){var a=ue(),r=ue(),i=ue(),n=ue(),s=ue(),f=ue(),u=ue(),o=ue(),c=ue();S0(a,e[1],e[0]),S0(c,t[1],t[0]),Le(a,a,c),C0(r,e[0],e[1]),C0(c,t[0],t[1]),Le(r,r,c),Le(i,e[3],t[3]),Le(i,i,jp),Le(n,e[2],t[2]),C0(n,n,n),S0(s,r,a),S0(f,n,i),C0(u,n,i),C0(o,r,a),Le(e[0],s,f),Le(e[1],o,u),Le(e[2],u,f),Le(e[3],s,o)}function ro(e,t,a){for(var r=0;r<4;++r)Jc(e[r],t[r],a)}function Ns(e,t){var a=ue(),r=ue(),i=ue();t2(i,t[2]),Le(a,t[0],i),Le(r,t[1],i),Oa(e,r),e[31]^=Yc(a)<<7}function Oa(e,t){var a,r,i,n=ue(),s=ue();for(a=0;a<16;++a)s[a]=t[a];for(_n(s),_n(s),_n(s),r=0;r<2;++r){for(n[0]=s[0]-65517,a=1;a<15;++a)n[a]=s[a]-65535-(n[a-1]>>16&1),n[a-1]&=65535;n[15]=s[15]-32767-(n[14]>>16&1),i=n[15]>>16&1,n[14]&=65535,Jc(s,n,1-i)}for(a=0;a<16;a++)e[2*a]=s[a]&255,e[2*a+1]=s[a]>>8}function Yp(e,t){var a=ue(),r=ue(),i=ue(),n=ue(),s=ue(),f=ue(),u=ue();return Hr(e[2],Ua),Zp(e[1],t),i0(i,e[1]),Le(n,i,Gp),S0(i,i,e[2]),C0(n,e[2],n),i0(s,n),i0(f,s),Le(u,f,s),Le(a,u,i),Le(a,a,n),Jp(a,a),Le(a,a,i),Le(a,a,n),Le(a,a,n),Le(e[0],a,n),i0(r,e[0]),Le(r,r,n),ao(r,i)&&Le(e[0],e[0],$p),i0(r,e[0]),Le(r,r,n),ao(r,i)?-1:(Yc(e[0])===t[31]>>7&&S0(e[0],Gn,e[0]),Le(e[3],e[0],e[1]),0)}function Zp(e,t){var a;for(a=0;a<16;++a)e[a]=t[2*a]+(t[2*a+1]<<8);e[15]&=32767}function Jp(e,t){var a=ue(),r;for(r=0;r<16;++r)a[r]=t[r];for(r=250;r>=0;--r)i0(a,a),r!==1&&Le(a,a,t);for(r=0;r<16;++r)e[r]=a[r]}function ao(e,t){var a=new Kt(32),r=new Kt(32);return Oa(a,e),Oa(r,t),Xc(a,0,r,0)}function Xc(e,t,a,r){return e2(e,t,a,r,32)}function e2(e,t,a,r,i){var n,s=0;for(n=0;n<i;++n)s|=e[t+n]^a[r+n];return(1&s-1>>>8)-1}function Yc(e){var t=new Kt(32);return Oa(t,e),t[0]&1}function Zc(e,t,a){var r,i;for(Hr(e[0],Gn),Hr(e[1],Ua),Hr(e[2],Ua),Hr(e[3],Gn),i=255;i>=0;--i)r=a[i/8|0]>>(i&7)&1,ro(e,t,r),$n(t,e),$n(e,e),ro(e,t,r)}function Rs(e,t){var a=[ue(),ue(),ue(),ue()];Hr(a[0],eo),Hr(a[1],to),Hr(a[2],Ua),Le(a[3],eo,to),Zc(e,a,t)}function Hr(e,t){var a;for(a=0;a<16;a++)e[a]=t[a]|0}function t2(e,t){var a=ue(),r;for(r=0;r<16;++r)a[r]=t[r];for(r=253;r>=0;--r)i0(a,a),r!==2&&r!==4&&Le(a,a,t);for(r=0;r<16;++r)e[r]=a[r]}function _n(e){var t,a,r=1;for(t=0;t<16;++t)a=e[t]+r+65535,r=Math.floor(a/65536),e[t]=a-r*65536;e[0]+=r-1+37*(r-1)}function Jc(e,t,a){for(var r,i=~(a-1),n=0;n<16;++n)r=i&(e[n]^t[n]),e[n]^=r,t[n]^=r}function ue(e){var t,a=new Float64Array(16);if(e)for(t=0;t<e.length;++t)a[t]=e[t];return a}function C0(e,t,a){for(var r=0;r<16;++r)e[r]=t[r]+a[r]}function S0(e,t,a){for(var r=0;r<16;++r)e[r]=t[r]-a[r]}function i0(e,t){Le(e,t,t)}function Le(e,t,a){var r,i,n=0,s=0,f=0,u=0,o=0,c=0,l=0,h=0,g=0,v=0,y=0,b=0,I=0,A=0,w=0,N=0,k=0,M=0,V=0,z=0,W=0,U=0,C=0,d=0,x=0,m=0,S=0,D=0,F=0,P=0,R=0,p=a[0],E=a[1],q=a[2],j=a[3],G=a[4],ee=a[5],re=a[6],fe=a[7],se=a[8],le=a[9],ve=a[10],We=a[11],pe=a[12],he=a[13],we=a[14],ge=a[15];r=t[0],n+=r*p,s+=r*E,f+=r*q,u+=r*j,o+=r*G,c+=r*ee,l+=r*re,h+=r*fe,g+=r*se,v+=r*le,y+=r*ve,b+=r*We,I+=r*pe,A+=r*he,w+=r*we,N+=r*ge,r=t[1],s+=r*p,f+=r*E,u+=r*q,o+=r*j,c+=r*G,l+=r*ee,h+=r*re,g+=r*fe,v+=r*se,y+=r*le,b+=r*ve,I+=r*We,A+=r*pe,w+=r*he,N+=r*we,k+=r*ge,r=t[2],f+=r*p,u+=r*E,o+=r*q,c+=r*j,l+=r*G,h+=r*ee,g+=r*re,v+=r*fe,y+=r*se,b+=r*le,I+=r*ve,A+=r*We,w+=r*pe,N+=r*he,k+=r*we,M+=r*ge,r=t[3],u+=r*p,o+=r*E,c+=r*q,l+=r*j,h+=r*G,g+=r*ee,v+=r*re,y+=r*fe,b+=r*se,I+=r*le,A+=r*ve,w+=r*We,N+=r*pe,k+=r*he,M+=r*we,V+=r*ge,r=t[4],o+=r*p,c+=r*E,l+=r*q,h+=r*j,g+=r*G,v+=r*ee,y+=r*re,b+=r*fe,I+=r*se,A+=r*le,w+=r*ve,N+=r*We,k+=r*pe,M+=r*he,V+=r*we,z+=r*ge,r=t[5],c+=r*p,l+=r*E,h+=r*q,g+=r*j,v+=r*G,y+=r*ee,b+=r*re,I+=r*fe,A+=r*se,w+=r*le,N+=r*ve,k+=r*We,M+=r*pe,V+=r*he,z+=r*we,W+=r*ge,r=t[6],l+=r*p,h+=r*E,g+=r*q,v+=r*j,y+=r*G,b+=r*ee,I+=r*re,A+=r*fe,w+=r*se,N+=r*le,k+=r*ve,M+=r*We,V+=r*pe,z+=r*he,W+=r*we,U+=r*ge,r=t[7],h+=r*p,g+=r*E,v+=r*q,y+=r*j,b+=r*G,I+=r*ee,A+=r*re,w+=r*fe,N+=r*se,k+=r*le,M+=r*ve,V+=r*We,z+=r*pe,W+=r*he,U+=r*we,C+=r*ge,r=t[8],g+=r*p,v+=r*E,y+=r*q,b+=r*j,I+=r*G,A+=r*ee,w+=r*re,N+=r*fe,k+=r*se,M+=r*le,V+=r*ve,z+=r*We,W+=r*pe,U+=r*he,C+=r*we,d+=r*ge,r=t[9],v+=r*p,y+=r*E,b+=r*q,I+=r*j,A+=r*G,w+=r*ee,N+=r*re,k+=r*fe,M+=r*se,V+=r*le,z+=r*ve,W+=r*We,U+=r*pe,C+=r*he,d+=r*we,x+=r*ge,r=t[10],y+=r*p,b+=r*E,I+=r*q,A+=r*j,w+=r*G,N+=r*ee,k+=r*re,M+=r*fe,V+=r*se,z+=r*le,W+=r*ve,U+=r*We,C+=r*pe,d+=r*he,x+=r*we,m+=r*ge,r=t[11],b+=r*p,I+=r*E,A+=r*q,w+=r*j,N+=r*G,k+=r*ee,M+=r*re,V+=r*fe,z+=r*se,W+=r*le,U+=r*ve,C+=r*We,d+=r*pe,x+=r*he,m+=r*we,S+=r*ge,r=t[12],I+=r*p,A+=r*E,w+=r*q,N+=r*j,k+=r*G,M+=r*ee,V+=r*re,z+=r*fe,W+=r*se,U+=r*le,C+=r*ve,d+=r*We,x+=r*pe,m+=r*he,S+=r*we,D+=r*ge,r=t[13],A+=r*p,w+=r*E,N+=r*q,k+=r*j,M+=r*G,V+=r*ee,z+=r*re,W+=r*fe,U+=r*se,C+=r*le,d+=r*ve,x+=r*We,m+=r*pe,S+=r*he,D+=r*we,F+=r*ge,r=t[14],w+=r*p,N+=r*E,k+=r*q,M+=r*j,V+=r*G,z+=r*ee,W+=r*re,U+=r*fe,C+=r*se,d+=r*le,x+=r*ve,m+=r*We,S+=r*pe,D+=r*he,F+=r*we,P+=r*ge,r=t[15],N+=r*p,k+=r*E,M+=r*q,V+=r*j,z+=r*G,W+=r*ee,U+=r*re,C+=r*fe,d+=r*se,x+=r*le,m+=r*ve,S+=r*We,D+=r*pe,F+=r*he,P+=r*we,R+=r*ge,n+=38*k,s+=38*M,f+=38*V,u+=38*z,o+=38*W,c+=38*U,l+=38*C,h+=38*d,g+=38*x,v+=38*m,y+=38*S,b+=38*D,I+=38*F,A+=38*P,w+=38*R,i=1,r=n+i+65535,i=Math.floor(r/65536),n=r-i*65536,r=s+i+65535,i=Math.floor(r/65536),s=r-i*65536,r=f+i+65535,i=Math.floor(r/65536),f=r-i*65536,r=u+i+65535,i=Math.floor(r/65536),u=r-i*65536,r=o+i+65535,i=Math.floor(r/65536),o=r-i*65536,r=c+i+65535,i=Math.floor(r/65536),c=r-i*65536,r=l+i+65535,i=Math.floor(r/65536),l=r-i*65536,r=h+i+65535,i=Math.floor(r/65536),h=r-i*65536,r=g+i+65535,i=Math.floor(r/65536),g=r-i*65536,r=v+i+65535,i=Math.floor(r/65536),v=r-i*65536,r=y+i+65535,i=Math.floor(r/65536),y=r-i*65536,r=b+i+65535,i=Math.floor(r/65536),b=r-i*65536,r=I+i+65535,i=Math.floor(r/65536),I=r-i*65536,r=A+i+65535,i=Math.floor(r/65536),A=r-i*65536,r=w+i+65535,i=Math.floor(r/65536),w=r-i*65536,r=N+i+65535,i=Math.floor(r/65536),N=r-i*65536,n+=i-1+37*(i-1),i=1,r=n+i+65535,i=Math.floor(r/65536),n=r-i*65536,r=s+i+65535,i=Math.floor(r/65536),s=r-i*65536,r=f+i+65535,i=Math.floor(r/65536),f=r-i*65536,r=u+i+65535,i=Math.floor(r/65536),u=r-i*65536,r=o+i+65535,i=Math.floor(r/65536),o=r-i*65536,r=c+i+65535,i=Math.floor(r/65536),c=r-i*65536,r=l+i+65535,i=Math.floor(r/65536),l=r-i*65536,r=h+i+65535,i=Math.floor(r/65536),h=r-i*65536,r=g+i+65535,i=Math.floor(r/65536),g=r-i*65536,r=v+i+65535,i=Math.floor(r/65536),v=r-i*65536,r=y+i+65535,i=Math.floor(r/65536),y=r-i*65536,r=b+i+65535,i=Math.floor(r/65536),b=r-i*65536,r=I+i+65535,i=Math.floor(r/65536),I=r-i*65536,r=A+i+65535,i=Math.floor(r/65536),A=r-i*65536,r=w+i+65535,i=Math.floor(r/65536),w=r-i*65536,r=N+i+65535,i=Math.floor(r/65536),N=r-i*65536,n+=i-1+37*(i-1),e[0]=n,e[1]=s,e[2]=f,e[3]=u,e[4]=o,e[5]=c,e[6]=l,e[7]=h,e[8]=g,e[9]=v,e[10]=y,e[11]=b,e[12]=I,e[13]=A,e[14]=w,e[15]=N}var Ht=me;Ht.kem=Ht.kem||{};var io=Ht.jsbn.BigInteger;Ht.kem.rsa={};Ht.kem.rsa.create=function(e,t){t=t||{};var a=t.prng||Ht.random,r={};return r.encrypt=function(i,n){var s=Math.ceil(i.n.bitLength()/8),f;do f=new io(Ht.util.bytesToHex(a.getBytesSync(s)),16).mod(i.n);while(f.compareTo(io.ONE)<=0);f=Ht.util.hexToBytes(f.toString(16));var u=s-f.length;u>0&&(f=Ht.util.fillString("\0",u)+f);var o=i.encrypt(f,"NONE"),c=e.generate(f,n);return{encapsulation:o,key:c}},r.decrypt=function(i,n,s){var f=i.decrypt(n,"NONE");return e.generate(f,s)},r};Ht.kem.kdf1=function(e,t){eu(this,e,0,t||e.digestLength)};Ht.kem.kdf2=function(e,t){eu(this,e,1,t||e.digestLength)};function eu(e,t,a,r){e.generate=function(i,n){for(var s=new Ht.util.ByteBuffer,f=Math.ceil(n/r)+a,u=new Ht.util.ByteBuffer,o=a;o<f;++o){u.putInt32(o),t.start(),t.update(i+u.getBytes());var c=t.digest();s.putBytes(c.getBytes(r))}return s.truncate(s.length()-n),s.getBytes()}}var Se=me;Se.log=Se.log||{};Se.log.levels=["none","error","warning","info","debug","verbose","max"];var Va={},Wn=[],aa=null;Se.log.LEVEL_LOCKED=2;Se.log.NO_LEVEL_CHECK=4;Se.log.INTERPOLATE=8;for(var zr=0;zr<Se.log.levels.length;++zr){var no=Se.log.levels[zr];Va[no]={index:zr,name:no.toUpperCase()}}Se.log.logMessage=function(e){for(var t=Va[e.level].index,a=0;a<Wn.length;++a){var r=Wn[a];if(r.flags&Se.log.NO_LEVEL_CHECK)r.f(e);else{var i=Va[r.level].index;t<=i&&r.f(r,e)}}};Se.log.prepareStandard=function(e){"standard"in e||(e.standard=Va[e.level].name+" ["+e.category+"] "+e.message)};Se.log.prepareFull=function(e){if(!("full"in e)){var t=[e.message];t=t.concat([]),e.full=Se.util.format.apply(this,t)}};Se.log.prepareStandardFull=function(e){"standardFull"in e||(Se.log.prepareStandard(e),e.standardFull=e.standard)};for(var so=["error","warning","info","debug","verbose"],zr=0;zr<so.length;++zr)(function(t){Se.log[t]=function(a,r){var i=Array.prototype.slice.call(arguments).slice(2),n={timestamp:new Date,level:t,category:a,message:r,arguments:i};Se.log.logMessage(n)}})(so[zr]);Se.log.makeLogger=function(e){var t={flags:0,f:e};return Se.log.setLevel(t,"none"),t};Se.log.setLevel=function(e,t){var a=!1;if(e&&!(e.flags&Se.log.LEVEL_LOCKED))for(var r=0;r<Se.log.levels.length;++r){var i=Se.log.levels[r];if(t==i){e.level=t,a=!0;break}}return a};Se.log.lock=function(e,t){typeof t>"u"||t?e.flags|=Se.log.LEVEL_LOCKED:e.flags&=~Se.log.LEVEL_LOCKED};Se.log.addLogger=function(e){Wn.push(e)};if(typeof console<"u"&&"log"in console){var Y0;if(console.error&&console.warn&&console.info&&console.debug){var r2={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},Fs=function(e,t){Se.log.prepareStandard(t);var a=r2[t.level],r=[t.standard];r=r.concat(t.arguments.slice()),a.apply(console,r)};Y0=Se.log.makeLogger(Fs)}else{var Fs=function(t,a){Se.log.prepareStandardFull(a),console.log(a.standardFull)};Y0=Se.log.makeLogger(Fs)}Se.log.setLevel(Y0,"debug"),Se.log.addLogger(Y0),aa=Y0}else console={log:function(){}};if(aa!==null&&typeof window<"u"&&window.location){var ga=new URL(window.location.href).searchParams;if(ga.has("console.level")&&Se.log.setLevel(aa,ga.get("console.level").slice(-1)[0]),ga.has("console.lock")){var a2=ga.get("console.lock").slice(-1)[0];a2=="true"&&Se.log.lock(aa)}}Se.log.consoleLogger=aa;var te=me,O=te.asn1,Pt=te.pkcs7=te.pkcs7||{};Pt.messageFromPem=function(e){var t=te.pem.decode(e)[0];if(t.type!=="PKCS7"){var a=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var r=O.fromDer(t.body);return Pt.messageFromAsn1(r)};Pt.messageToPem=function(e,t){var a={type:"PKCS7",body:O.toDer(e.toAsn1()).getBytes()};return te.pem.encode(a,{maxline:t})};Pt.messageFromAsn1=function(e){var t={},a=[];if(!O.validate(e,Pt.asn1.contentInfoValidator,t,a)){var r=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw r.errors=a,r}var i=O.derToOid(t.contentType),n;switch(i){case te.pki.oids.envelopedData:n=Pt.createEnvelopedData();break;case te.pki.oids.encryptedData:n=Pt.createEncryptedData();break;case te.pki.oids.signedData:n=Pt.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+i+" is not (yet) supported.")}return n.fromAsn1(t.content.value[0]),n};Pt.createSignedData=function(){var e=null;return e={type:te.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(r){if(ks(e,r,Pt.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var i=e.rawCapture.certificates.value,n=0;n<i.length;++n)e.certificates.push(te.pki.certificateFromAsn1(i[n]))},toAsn1:function(){e.contentInfo||e.sign();for(var r=[],i=0;i<e.certificates.length;++i)r.push(te.pki.certificateToAsn1(e.certificates[i]));var n=[],s=O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(e.version).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return r.length>0&&s.value[0].value.push(O.create(O.Class.CONTEXT_SPECIFIC,0,!0,r)),n.length>0&&s.value[0].value.push(O.create(O.Class.CONTEXT_SPECIFIC,1,!0,n)),s.value[0].value.push(O.create(O.Class.UNIVERSAL,O.Type.SET,!0,e.signerInfos)),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.type).getBytes()),s])},addSigner:function(r){var i=r.issuer,n=r.serialNumber;if(r.certificate){var s=r.certificate;typeof s=="string"&&(s=te.pki.certificateFromPem(s)),i=s.issuer.attributes,n=s.serialNumber}var f=r.key;if(!f)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof f=="string"&&(f=te.pki.privateKeyFromPem(f));var u=r.digestAlgorithm||te.pki.oids.sha1;switch(u){case te.pki.oids.sha1:case te.pki.oids.sha256:case te.pki.oids.sha384:case te.pki.oids.sha512:case te.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+u)}var o=r.authenticatedAttributes||[];if(o.length>0){for(var c=!1,l=!1,h=0;h<o.length;++h){var g=o[h];if(!c&&g.type===te.pki.oids.contentType){if(c=!0,l)break;continue}if(!l&&g.type===te.pki.oids.messageDigest){if(l=!0,c)break;continue}}if(!c||!l)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:f,version:1,issuer:i,serialNumber:n,digestAlgorithm:u,signatureAlgorithm:te.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:o,unauthenticatedAttributes:[]})},sign:function(r){if(r=r||{},(typeof e.content!="object"||e.contentInfo===null)&&(e.contentInfo=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(te.pki.oids.data).getBytes())]),"content"in e)){var i;e.content instanceof te.util.ByteBuffer?i=e.content.bytes():typeof e.content=="string"&&(i=te.util.encodeUtf8(e.content)),r.detached?e.detachedContent=O.create(O.Class.UNIVERSAL,O.Type.OCTETSTRING,!1,i):e.contentInfo.value.push(O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[O.create(O.Class.UNIVERSAL,O.Type.OCTETSTRING,!1,i)]))}if(e.signers.length!==0){var n=t();a(n)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(r){typeof r=="string"&&(r=te.pki.certificateFromPem(r)),e.certificates.push(r)},addCertificateRevokationList:function(r){throw new Error("PKCS#7 CRL support not yet implemented.")}},e;function t(){for(var r={},i=0;i<e.signers.length;++i){var n=e.signers[i],s=n.digestAlgorithm;s in r||(r[s]=te.md[te.pki.oids[s]].create()),n.authenticatedAttributes.length===0?n.md=r[s]:n.md=te.md[te.pki.oids[s]].create()}e.digestAlgorithmIdentifiers=[];for(var s in r)e.digestAlgorithmIdentifiers.push(O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(s).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")]));return r}function a(r){var i;if(e.detachedContent?i=e.detachedContent:(i=e.contentInfo.value[1],i=i.value[0]),!i)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var n=O.derToOid(e.contentInfo.value[0].value),s=O.toDer(i);s.getByte(),O.getBerValueLength(s),s=s.getBytes();for(var f in r)r[f].start().update(s);for(var u=new Date,o=0;o<e.signers.length;++o){var c=e.signers[o];if(c.authenticatedAttributes.length===0){if(n!==te.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{c.authenticatedAttributesAsn1=O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var l=O.create(O.Class.UNIVERSAL,O.Type.SET,!0,[]),h=0;h<c.authenticatedAttributes.length;++h){var g=c.authenticatedAttributes[h];g.type===te.pki.oids.messageDigest?g.value=r[c.digestAlgorithm].digest():g.type===te.pki.oids.signingTime&&(g.value||(g.value=u)),l.value.push(Qn(g)),c.authenticatedAttributesAsn1.value.push(Qn(g))}s=O.toDer(l).getBytes(),c.md.start().update(s)}c.signature=c.key.sign(c.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=c2(e.signers)}};Pt.createEncryptedData=function(){var e=null;return e={type:te.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:te.pki.oids["aes256-CBC"]},fromAsn1:function(t){ks(e,t,Pt.asn1.encryptedDataValidator)},decrypt:function(t){t!==void 0&&(e.encryptedContent.key=t),tu(e)}},e};Pt.createEnvelopedData=function(){var e=null;return e={type:te.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:te.pki.oids["aes256-CBC"]},fromAsn1:function(t){var a=ks(e,t,Pt.asn1.envelopedDataValidator);e.recipients=s2(a.recipientInfos.value)},toAsn1:function(){return O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.type).getBytes()),O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(e.version).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.SET,!0,f2(e.recipients)),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,u2(e.encryptedContent))])])])},findRecipient:function(t){for(var a=t.issuer.attributes,r=0;r<e.recipients.length;++r){var i=e.recipients[r],n=i.issuer;if(i.serialNumber===t.serialNumber&&n.length===a.length){for(var s=!0,f=0;f<a.length;++f)if(n[f].type!==a[f].type||n[f].value!==a[f].value){s=!1;break}if(s)return i}}return null},decrypt:function(t,a){if(e.encryptedContent.key===void 0&&t!==void 0&&a!==void 0)switch(t.encryptedContent.algorithm){case te.pki.oids.rsaEncryption:case te.pki.oids.desCBC:var r=a.decrypt(t.encryptedContent.content);e.encryptedContent.key=te.util.createBuffer(r);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}tu(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:te.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,a){if(e.encryptedContent.content===void 0){a=a||e.encryptedContent.algorithm,t=t||e.encryptedContent.key;var r,i,n;switch(a){case te.pki.oids["aes128-CBC"]:r=16,i=16,n=te.aes.createEncryptionCipher;break;case te.pki.oids["aes192-CBC"]:r=24,i=16,n=te.aes.createEncryptionCipher;break;case te.pki.oids["aes256-CBC"]:r=32,i=16,n=te.aes.createEncryptionCipher;break;case te.pki.oids["des-EDE3-CBC"]:r=24,i=8,n=te.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+a)}if(t===void 0)t=te.util.createBuffer(te.random.getBytes(r));else if(t.length()!=r)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+r+".");e.encryptedContent.algorithm=a,e.encryptedContent.key=t,e.encryptedContent.parameter=te.util.createBuffer(te.random.getBytes(i));var s=n(t);if(s.start(e.encryptedContent.parameter.copy()),s.update(e.content),!s.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=s.output}for(var f=0;f<e.recipients.length;++f){var u=e.recipients[f];if(u.encryptedContent.content===void 0)switch(u.encryptedContent.algorithm){case te.pki.oids.rsaEncryption:u.encryptedContent.content=u.encryptedContent.key.encrypt(e.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+u.encryptedContent.algorithm)}}}},e};function i2(e){var t={},a=[];if(!O.validate(e,Pt.asn1.recipientInfoValidator,t,a)){var r=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw r.errors=a,r}return{version:t.version.charCodeAt(0),issuer:te.pki.RDNAttributesAsArray(t.issuer),serialNumber:te.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:O.derToOid(t.encAlgorithm),parameter:t.encParameter?t.encParameter.value:void 0,content:t.encKey}}}function n2(e){return O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(e.version).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[te.pki.distinguishedNameToAsn1({attributes:e.issuer}),O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,te.util.hexToBytes(e.serialNumber))]),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.encryptedContent.algorithm).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")]),O.create(O.Class.UNIVERSAL,O.Type.OCTETSTRING,!1,e.encryptedContent.content)])}function s2(e){for(var t=[],a=0;a<e.length;++a)t.push(i2(e[a]));return t}function f2(e){for(var t=[],a=0;a<e.length;++a)t.push(n2(e[a]));return t}function o2(e){var t=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(e.version).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[te.pki.distinguishedNameToAsn1({attributes:e.issuer}),O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,te.util.hexToBytes(e.serialNumber))]),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.digestAlgorithm).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.signatureAlgorithm).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")])),t.value.push(O.create(O.Class.UNIVERSAL,O.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var a=O.create(O.Class.CONTEXT_SPECIFIC,1,!0,[]),r=0;r<e.unauthenticatedAttributes.length;++r){var i=e.unauthenticatedAttributes[r];a.values.push(Qn(i))}t.value.push(a)}return t}function c2(e){for(var t=[],a=0;a<e.length;++a)t.push(o2(e[a]));return t}function Qn(e){var t;if(e.type===te.pki.oids.contentType)t=O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.value).getBytes());else if(e.type===te.pki.oids.messageDigest)t=O.create(O.Class.UNIVERSAL,O.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===te.pki.oids.signingTime){var a=new Date("1950-01-01T00:00:00Z"),r=new Date("2050-01-01T00:00:00Z"),i=e.value;if(typeof i=="string"){var n=Date.parse(i);isNaN(n)?i.length===13?i=O.utcTimeToDate(i):i=O.generalizedTimeToDate(i):i=new Date(n)}i>=a&&i<r?t=O.create(O.Class.UNIVERSAL,O.Type.UTCTIME,!1,O.dateToUtcTime(i)):t=O.create(O.Class.UNIVERSAL,O.Type.GENERALIZEDTIME,!1,O.dateToGeneralizedTime(i))}return O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.type).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.SET,!0,[t])])}function u2(e){return[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(te.pki.oids.data).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.algorithm).getBytes()),e.parameter?O.create(O.Class.UNIVERSAL,O.Type.OCTETSTRING,!1,e.parameter.getBytes()):void 0]),O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[O.create(O.Class.UNIVERSAL,O.Type.OCTETSTRING,!1,e.content.getBytes())])]}function ks(e,t,a){var r={},i=[];if(!O.validate(t,a,r,i)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw n.errors=n,n}var s=O.derToOid(r.contentType);if(s!==te.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(r.encryptedContent){var f="";if(te.util.isArray(r.encryptedContent))for(var u=0;u<r.encryptedContent.length;++u){if(r.encryptedContent[u].type!==O.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");f+=r.encryptedContent[u].value}else f=r.encryptedContent;e.encryptedContent={algorithm:O.derToOid(r.encAlgorithm),parameter:te.util.createBuffer(r.encParameter.value),content:te.util.createBuffer(f)}}if(r.content){var f="";if(te.util.isArray(r.content))for(var u=0;u<r.content.length;++u){if(r.content[u].type!==O.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");f+=r.content[u].value}else f=r.content;e.content=te.util.createBuffer(f)}return e.version=r.version.charCodeAt(0),e.rawCapture=r,r}function tu(e){if(e.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(e.content===void 0){var t;switch(e.encryptedContent.algorithm){case te.pki.oids["aes128-CBC"]:case te.pki.oids["aes192-CBC"]:case te.pki.oids["aes256-CBC"]:t=te.aes.createDecryptionCipher(e.encryptedContent.key);break;case te.pki.oids.desCBC:case te.pki.oids["des-EDE3-CBC"]:t=te.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}var bt=me,ui=bt.ssh=bt.ssh||{};ui.privateKeyToPutty=function(e,t,a){a=a||"",t=t||"";var r="ssh-rsa",i=t===""?"none":"aes256-cbc",n="PuTTY-User-Key-File-2: "+r+`\r
`;n+="Encryption: "+i+`\r
`,n+="Comment: "+a+`\r
`;var s=bt.util.createBuffer();B0(s,r),cr(s,e.e),cr(s,e.n);var f=bt.util.encode64(s.bytes(),64),u=Math.floor(f.length/66)+1;n+="Public-Lines: "+u+`\r
`,n+=f;var o=bt.util.createBuffer();cr(o,e.d),cr(o,e.p),cr(o,e.q),cr(o,e.qInv);var c;if(!t)c=bt.util.encode64(o.bytes(),64);else{var l=o.length()+16-1;l-=l%16;var h=ya(o.bytes());h.truncate(h.length()-l+o.length()),o.putBuffer(h);var g=bt.util.createBuffer();g.putBuffer(ya("\0\0\0\0",t)),g.putBuffer(ya("\0\0\0",t));var v=bt.aes.createEncryptionCipher(g.truncate(8),"CBC");v.start(bt.util.createBuffer().fillWithByte(0,16)),v.update(o.copy()),v.finish();var y=v.output;y.truncate(16),c=bt.util.encode64(y.bytes(),64)}u=Math.floor(c.length/66)+1,n+=`\r
Private-Lines: `+u+`\r
`,n+=c;var b=ya("putty-private-key-file-mac-key",t),I=bt.util.createBuffer();B0(I,r),B0(I,i),B0(I,a),I.putInt32(s.length()),I.putBuffer(s),I.putInt32(o.length()),I.putBuffer(o);var A=bt.hmac.create();return A.start("sha1",b),A.update(I.bytes()),n+=`\r
Private-MAC: `+A.digest().toHex()+`\r
`,n};ui.publicKeyToOpenSSH=function(e,t){var a="ssh-rsa";t=t||"";var r=bt.util.createBuffer();return B0(r,a),cr(r,e.e),cr(r,e.n),a+" "+bt.util.encode64(r.bytes())+" "+t};ui.privateKeyToOpenSSH=function(e,t){return t?bt.pki.encryptRsaPrivateKey(e,t,{legacy:!0,algorithm:"aes128"}):bt.pki.privateKeyToPem(e)};ui.getPublicKeyFingerprint=function(e,t){t=t||{};var a=t.md||bt.md.md5.create(),r="ssh-rsa",i=bt.util.createBuffer();B0(i,r),cr(i,e.e),cr(i,e.n),a.start(),a.update(i.getBytes());var n=a.digest();if(t.encoding==="hex"){var s=n.toHex();return t.delimiter?s.match(/.{2}/g).join(t.delimiter):s}else{if(t.encoding==="binary")return n.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".')}return n};function cr(e,t){var a=t.toString(16);a[0]>="8"&&(a="00"+a);var r=bt.util.hexToBytes(a);e.putInt32(r.length),e.putBytes(r)}function B0(e,t){e.putInt32(t.length),e.putString(t)}function ya(){for(var e=bt.md.sha1.create(),t=arguments.length,a=0;a<t;++a)e.update(arguments[a]);return e.digest()}var d2=me;const In=co(d2),l2=e=>{if(!e||typeof e!="string")throw new Error("Input must be a non-empty string");return Sh.SHA384(e).toString()},h2=e=>{try{const t=atob(e),a=JSON.parse(t);return{signature:a.signature,publicKey:a.publicKey,algorithm:a.algorithm,keySize:a.keySize,hashAlgorithm:a.hashAlgorithm}}catch(t){return console.error("Failed to decode signature:",t),null}},v2=async(e,t,a)=>{try{if(!crypto||!crypto.subtle)return console.warn("Web Crypto API not available, falling back to simplified verification"),fo(e,t,a);const r=a.replace(/-----BEGIN PUBLIC KEY-----/g,"").replace(/-----END PUBLIC KEY-----/g,"").replace(/\s/g,""),i=Uint8Array.from(atob(r),o=>o.charCodeAt(0)),n=await crypto.subtle.importKey("spki",i,{name:"RSASSA-PKCS1-v1_5",hash:"SHA-384"},!1,["verify"]),s=await crypto.subtle.digest("SHA-384",new TextEncoder().encode(e)),f=Uint8Array.from(atob(t),o=>o.charCodeAt(0));return await crypto.subtle.verify("RSASSA-PKCS1-v1_5",n,f,s)}catch(r){return console.error("RSA signature verification failed:",r),fo(e,t,a)}},fo=(e,t,a)=>{try{console.log("Using node-forge RSA verification (matching backend)");const r=In.pki.publicKeyFromPem(a),i=In.util.decode64(t);console.log("Signature decoded successfully, bytes length:",i.length);let n=!1;try{const s=l2(e),f=In.md.sha384.create();f.update(s,"utf8"),n=r.verify(f.digest().bytes(),i)}catch(s){console.log("Method 2 failed:",s.message)}return n}catch(r){return console.error("Node-forge RSA verification failed:",r),!1}},p2=async(e,t)=>{try{return await v2(e,t.signature,t.publicKey)}catch(a){return console.error("Failed to verify decoded signature:",a),!1}},x2=({user:e,open:t,onOpenChange:a})=>{const r=Ka(),[i,n]=de.useState({email:"",role:"user",status:"active"}),[s,f]=de.useState(!1),[u,o]=de.useState({});de.useEffect(()=>{e&&n({email:e.email,role:e.role,status:e.status})},[e]);const c=async h=>{h.preventDefault(),f(!0);try{const g=await r(lu({id:e.id,userData:i}));g.type.endsWith("/fulfilled")&&g.payload?(o({}),a({open:!1,user:g.payload}),Tr({title:"User updated successfully",description:"User updated successfully",variant:"success"})):g.type.endsWith("/rejected")&&(a({open:!0,user:null}),o({email:"Email already exists"}),Tr({title:"Update failed",description:"Email already exists",variant:"destructive"}))}catch{o({general:"An unexpected error occurred"}),Tr({title:"Update failed",description:"An unexpected error occurred",variant:"destructive"})}finally{f(!1)}},l=(h,g)=>{n(v=>({...v,[h]:g})),u[h]&&o(v=>({...v,[h]:""}))};return H.jsx(Fo,{open:t,onOpenChange:()=>a({open:!1,user:e}),children:H.jsxs(rs,{className:"sm:max-w-[425px]",children:[H.jsxs(as,{children:[H.jsx(ns,{children:"Edit User"}),H.jsx(ss,{children:"Make changes to the user information. Click save when you're done."})]}),H.jsxs("form",{onSubmit:c,className:"space-y-4",children:[u.general&&H.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:H.jsx("p",{className:"text-sm text-red-600",children:u.general})}),H.jsxs("div",{className:"space-y-2",children:[H.jsx(f0,{htmlFor:"edit-email",children:"Email"}),H.jsx(fs,{id:"edit-email",type:"email",value:i.email,onChange:h=>l("email",h.target.value),placeholder:"user@example.com",required:!0,className:u.email?"border-red-500":""}),u.email&&H.jsx("p",{className:"text-sm text-red-500",children:u.email})]}),H.jsxs("div",{className:"space-y-2",children:[H.jsx(f0,{htmlFor:"edit-role",children:"Role"}),H.jsxs(Aa,{value:i.role,onValueChange:h=>l("role",h),children:[H.jsx(Sa,{children:H.jsx(Ba,{placeholder:"Select role"})}),H.jsxs(_a,{children:[H.jsx(Ur,{value:"user",children:"User"}),H.jsx(Ur,{value:"admin",children:"Admin"})]})]})]}),H.jsxs("div",{className:"space-y-2",children:[H.jsx(f0,{htmlFor:"edit-status",children:"Status"}),H.jsxs(Aa,{value:i.status,onValueChange:h=>l("status",h),children:[H.jsx(Sa,{children:H.jsx(Ba,{placeholder:"Select status"})}),H.jsxs(_a,{children:[H.jsx(Ur,{value:"active",children:"Active"}),H.jsx(Ur,{value:"inactive",children:"Inactive"})]})]})]}),H.jsxs(is,{children:[H.jsx(n0,{type:"button",variant:"outline",onClick:()=>a({open:!1,user:e}),children:"Cancel"}),H.jsx(n0,{type:"submit",disabled:s,children:s?"Saving...":"Save Changes"})]})]})]})})},C2=()=>{const e=Ka(),{users:t,loading:a,error:r}=bu(o=>o.users),[i,n]=de.useState(null),[s,f]=de.useState([]);de.useEffect(()=>{u()},[]);const u=async()=>{try{const o=await hu.exportUsers(),c=await mu(o);let l=[];const h=c;for(const g of h)if(g.signature)try{const v=h2(g.signature);if(!v)continue;const y=await p2(g.email,v);y&&l.push({...g,isValid:y,isEditable:!0})}catch{}f(l),e({type:"users/setUsers",payload:l})}catch{try{Tr({title:"Using standard user data",description:"Export endpoint unavailable, loading from regular endpoint",variant:"default"})}catch{Tr({title:"Failed to load users",description:"Unable to load users from any endpoint",variant:"destructive"})}}};return a?H.jsx(vu,{size:"lg"}):r&&!s.length&&!t.length?H.jsxs("div",{className:"text-center text-destructive",children:[H.jsxs("p",{children:["Error loading users: ",r]}),H.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Please check your connection and try again."})]}):H.jsxs("div",{className:"space-y-6",children:[H.jsx("div",{className:"flex items-center justify-between",children:H.jsxs("div",{children:[H.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Users"}),H.jsx("p",{className:"text-muted-foreground",children:"Manage and monitor user accounts from Protobuf export"}),H.jsxs("div",{className:"text-xs text-muted-foreground",children:[H.jsx("p",{children:"• Signatures are stored as Base64-encoded JSON with embedded public keys"}),H.jsx("p",{children:"• Each signature contains public key for email verification"}),H.jsx("p",{children:"• Email hashing uses SHA-384 algorithm"})]}),H.jsxs("div",{className:"flex items-center space-x-2 text-blue-600",children:[H.jsx(Eu,{className:"h-4 w-4"}),H.jsx("span",{className:"text-sm",children:"Verification uses the embedded public key from each signature"})]})]})}),H.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[H.jsx("div",{className:"lg:col-span-2 space-y-6",children:H.jsxs(Ps,{children:[H.jsxs(Us,{children:[H.jsx(Os,{children:"User Management"}),H.jsx(Vs,{className:" text-green-600 font-medium",children:"View and manage all user accounts from Protobuf export and verified users"})]}),H.jsx(Ks,{children:H.jsx(Ku,{users:s.length>0?s:t,onUserUpdated:u,setEditingUser:n})})]})}),i&&H.jsx(x2,{user:i,open:!!i,onOpenChange:async o=>{if(o.user){n(null);const c=s.length>0?s:t,l=c.findIndex(h=>h.id===o.user.id);if(l!==-1){const h=[...c];h[l]=o.user,s.length>0&&f(h),e({type:"users/setUsers",payload:h})}}}}),H.jsx("div",{className:"space-y-6",children:H.jsxs(Ps,{children:[H.jsxs(Us,{children:[H.jsx(Os,{children:"Add New User"}),H.jsx(Vs,{children:"Create a new user account"})]}),H.jsx(Ks,{children:H.jsx(zu,{onRefreshChange:o=>{o&&u()}})})]})})]})]})};export{C2 as default};
